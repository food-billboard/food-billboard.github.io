<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SVGå­¦ä¹ </title>
    <link href="/2022/09/19/SVG%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/19/SVG%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="SVGå­¦ä¹ "><a href="#SVGå­¦ä¹ " class="headerlink" title="SVGå­¦ä¹ "></a>SVGå­¦ä¹ </h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><blockquote><p>SVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ (Scalable Vector Graphics)<br>SVG ç”¨æ¥å®šä¹‰ç”¨äºç½‘ç»œçš„åŸºäºçŸ¢é‡çš„å›¾å½¢<br>SVG ä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢<br>SVG å›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æ‰€æŸå¤±<br>SVG æ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡†<br>SVG ä¸è¯¸å¦‚ DOM å’Œ XSL ä¹‹ç±»çš„ W3C æ ‡å‡†æ˜¯ä¸€ä¸ªæ•´ä½“</p></blockquote><p>å­¦ä¹ <code>svg</code>çš„ç›®çš„ï¼Œæ˜¯ä¸ºäº†èƒ½åœ¨å‰ç«¯é¡µé¢å®ç°æ›´å¤šæœ‰æ„æ€çš„æ•ˆæœã€‚<br>ä»¥ä¸‹å°±æ˜¯æœ¬äººçš„å­¦ä¹ ç¬”è®°ã€‚  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="svg"><a href="#svg" class="headerlink" title="svg"></a>svg</h3><p><code>svg</code>æ ‡ç­¾çš„å±æ€§  </p><ul><li>width &amp; height  </li><li>version ç‰ˆæœ¬  </li><li>xmlns å‘½åç©ºé—´  </li><li>viewbox å¯è§†åŒºåŸŸ<br>æ­¤å±æ€§è¡¨ç¤ºè£å‰ªä¸€ä¸ªçŸ©å½¢åŒºåŸŸä½œä¸ºæœ€ç»ˆçš„å¯è§†åŒºåŸŸï¼ˆleft top width heightï¼‰<br>æ¯”å¦‚<code>20 20 100 100</code>è¡¨ç¤ºèƒ½çœ‹åˆ°å·¦ä¸Šè§’(20, 20)ä¸ºèµ·ç‚¹çš„å®½é«˜å‡ä¸º100çš„çŸ©å½¢åŒºåŸŸã€‚   </li></ul><h3 id="ä¸€äº›å¸¸ç”¨çš„å±æ€§"><a href="#ä¸€äº›å¸¸ç”¨çš„å±æ€§" class="headerlink" title="ä¸€äº›å¸¸ç”¨çš„å±æ€§"></a>ä¸€äº›å¸¸ç”¨çš„å±æ€§</h3><p>åŸºæœ¬ä¸Šè¿™äº›å±æ€§éƒ½å’Œ<code>css</code>é€šç”¨ã€‚  </p><h4 id="width-amp-height-amp-x-amp-y"><a href="#width-amp-height-amp-x-amp-y" class="headerlink" title="width &amp; height &amp; x &amp; y"></a>width &amp; height &amp; x &amp; y</h4><p>å…ƒç´ çš„å®½é«˜ä½ç½®ã€‚  </p><h4 id="fill"><a href="#fill" class="headerlink" title="fill"></a>fill</h4><p>é¢œè‰²å¡«å……  </p><svg width="100" height="100">  <rect fill="red" width="50" height="50"></rect></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;rect fill=&quot;red&quot; width=&quot;50&quot; height=&quot;50&quot;&gt;&lt;/rect&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke"><a href="#stroke" class="headerlink" title="stroke"></a>stroke</h4><p>æè¾¹  </p><svg width="100" height="100">  <rect x="10" y="10" fill="none" stroke="#f00" width="50" height="50"></rect></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;rect x=&quot;10&quot; y=&quot;10&quot; fill=&quot;none&quot; stroke=&quot;#f00&quot; width=&quot;50&quot; height=&quot;50&quot;&gt;&lt;/rect&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke-width"><a href="#stroke-width" class="headerlink" title="stroke-width"></a>stroke-width</h4><p>æè¾¹çš„çº¿æ¡å°ºå¯¸  </p><svg width="100" height="100">  <rect x="10" y="10" fill="none" stroke="#f00" stroke-width="10" width="50" height="50"></rect></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;rect x=&quot;10&quot; y=&quot;10&quot; fill=&quot;none&quot; stroke=&quot;#f00&quot; stroke-width=&quot;10&quot; width=&quot;50&quot; height=&quot;50&quot;&gt;&lt;/rect&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke-dashoffset"><a href="#stroke-dashoffset" class="headerlink" title="stroke-dashoffset"></a>stroke-dashoffset</h4><p>è®¾ç½®è™šçº¿çš„åç§»é‡</p><svg width="200" height="100">  <polyline points="20 20 150 20" stroke-dasharray="50 10" stroke="red" stroke-width="5"></polyline>  <polyline points="20 50 150 50" stroke-dasharray="50 10" stroke="blue" stroke-width="5" stroke-dashoffset="20"></polyline></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;200&quot; height=&quot;100&quot;&gt;<br>  &lt;polyline points=&quot;20 20 150 20&quot; stroke-dasharray=&quot;50 10&quot; stroke=&quot;red&quot; stroke-width=&quot;5&quot;&gt;&lt;/polyline&gt;<br>  &lt;polyline points=&quot;20 50 150 50&quot; stroke-dasharray=&quot;50 10&quot; stroke=&quot;blue&quot; stroke-width=&quot;5&quot; stroke-dashoffset=&quot;20&quot;&gt;&lt;/polyline&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke-linejoin"><a href="#stroke-linejoin" class="headerlink" title="stroke-linejoin"></a>stroke-linejoin</h4><p>è½¬æŠ˜ç‚¹çš„æ ·å¼</p><svg width="200" height="200">  <polyline stroke-linejoin="miter" points="0 0 0 50 50 50" stroke="red" stroke-width="20" fill="none"></polyline>  <polyline stroke-linejoin="round" points="50 50 50 100 100 100" stroke="blue" stroke-width="20" fill="none"></polyline>  <polyline stroke-linejoin="bevel" points="100 100 100 150 150 150" stroke="blue" stroke-width="20" fill="none"></polyline></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;200&quot; height=&quot;100&quot;&gt;<br>  &lt;polyline stroke-linejoin=&quot;miter&quot; points=&quot;20 20 40 50 60 70&quot; stroke=&quot;red&quot; stroke-width=&quot;5&quot;&gt;&lt;/polyline&gt;<br>  &lt;polyline stroke-linejoin=&quot;round&quot; points=&quot;20 20 40 50 60 70&quot; stroke=&quot;blue&quot; stroke-width=&quot;5&quot;&gt;&lt;/polyline&gt;<br>  &lt;polyline stroke-linejoin=&quot;bevel&quot; points=&quot;20 20 40 50 60 70&quot; stroke=&quot;blue&quot; stroke-width=&quot;5&quot;&gt;&lt;/polyline&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke-opacity"><a href="#stroke-opacity" class="headerlink" title="stroke-opacity"></a>stroke-opacity</h4><p>æè¾¹çº¿æ¡çš„é€æ˜åº¦  </p><h4 id="stroke-linecap"><a href="#stroke-linecap" class="headerlink" title="stroke-linecap"></a>stroke-linecap</h4><p>æè¾¹çš„æœ«ç«¯å½¢çŠ¶</p><svg width="100" height="100">  <g fill="none" stroke="black" stroke-width="6">    <path stroke-linecap="butt" d="M5 20 l65 0" />    <path stroke-linecap="round" d="M5 40 l65 0" />    <path stroke-linecap="square" d="M5 60 l65 0" />  </g></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;g fill=&quot;none&quot; stroke=&quot;black&quot; stroke-width=&quot;6&quot;&gt;<br>    &lt;path stroke-linecap=&quot;butt&quot; d=&quot;M5 20 l65 0&quot; /&gt;<br>    &lt;path stroke-linecap=&quot;round&quot; d=&quot;M5 40 l65 0&quot; /&gt;<br>    &lt;path stroke-linecap=&quot;square&quot; d=&quot;M5 60 l65 0&quot; /&gt;<br>  &lt;/g&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="stroke-dasharray"><a href="#stroke-dasharray" class="headerlink" title="stroke-dasharray"></a>stroke-dasharray</h4><p>ç»˜åˆ¶è™šçº¿  </p><p>æ ¼å¼ä¸º<code>length margin, length margin, ...</code>  </p><ul><li>length è™šçº¿é•¿åº¦  </li><li>margin è™šçº¿é—´è·  </li></ul><svg width="100" height="100">  <g fill="none" stroke="black" stroke-width="4">    <path stroke-dasharray="5,5" d="M5 20 l215 0" />    <path stroke-dasharray="10,10" d="M5 40 l215 0" />    <path stroke-dasharray="20,10,5,5,5,10" d="M5 60 l215 0" />  </g></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;g fill=&quot;none&quot; stroke=&quot;black&quot; stroke-width=&quot;4&quot;&gt;<br>    &lt;path stroke-dasharray=&quot;5,5&quot; d=&quot;M5 20 l215 0&quot; /&gt;<br>    &lt;path stroke-dasharray=&quot;10,10&quot; d=&quot;M5 40 l215 0&quot; /&gt;<br>    &lt;path stroke-dasharray=&quot;20,10,5,5,5,10&quot; d=&quot;M5 60 l215 0&quot; /&gt;<br>  &lt;/g&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="rx-amp-ry"><a href="#rx-amp-ry" class="headerlink" title="rx &amp; ry"></a>rx &amp; ry</h4><p><strong>çŸ©å½¢</strong>çš„åœ†è§’<br><strong>æ¤­åœ†</strong>çš„æ°´å¹³å’Œå‚ç›´å°ºå¯¸  </p><h4 id="cx-amp-cy"><a href="#cx-amp-cy" class="headerlink" title="cx &amp; cy"></a>cx &amp; cy</h4><p><strong>åœ†å½¢</strong>çš„åœ†å¿ƒ  </p><h4 id="r"><a href="#r" class="headerlink" title="r"></a>r</h4><p><strong>åœ†å½¢</strong>çš„åŠå¾„   </p><h3 id="shapes-å½¢çŠ¶å’Œæ–‡å­—"><a href="#shapes-å½¢çŠ¶å’Œæ–‡å­—" class="headerlink" title="shapes å½¢çŠ¶å’Œæ–‡å­—"></a>shapes å½¢çŠ¶å’Œæ–‡å­—</h3><h4 id="rectï¼ˆçŸ©å½¢ï¼‰"><a href="#rectï¼ˆçŸ©å½¢ï¼‰" class="headerlink" title="rectï¼ˆçŸ©å½¢ï¼‰"></a>rectï¼ˆçŸ©å½¢ï¼‰</h4><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100">  <rect width="50" height="50" fill="red" stroke-width="1" stroke="rgb(0,0,0)"/></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot; &gt;<br>  &lt;rect width=&quot;50&quot; height=&quot;50&quot; fill=&quot;red&quot; stroke-width=&quot;1&quot; stroke=&quot;rgb(0,0,0)&quot;/&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="circleï¼ˆåœ†å½¢ï¼‰"><a href="#circleï¼ˆåœ†å½¢ï¼‰" class="headerlink" title="circleï¼ˆåœ†å½¢ï¼‰"></a>circleï¼ˆåœ†å½¢ï¼‰</h4><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100">  <circle cx="30" cy="30" r="10" fill="red" stroke-width="1" stroke="rgb(0,0,0)"/></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;circle cx=&quot;30&quot; cy=&quot;30&quot; r=&quot;10&quot; fill=&quot;red&quot; stroke-width=&quot;1&quot; stroke=&quot;rgb(0,0,0)&quot;/&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="ellipseï¼ˆæ¤­åœ†ï¼‰"><a href="#ellipseï¼ˆæ¤­åœ†ï¼‰" class="headerlink" title="ellipseï¼ˆæ¤­åœ†ï¼‰"></a>ellipseï¼ˆæ¤­åœ†ï¼‰</h4><p>ç±»ä¼¼äº<strong>åœ†å½¢</strong>ï¼Œåªæ˜¯æŠŠ<code>r</code>å˜æˆäº†<code>rx</code>å’Œ<code>ry</code>ã€‚  </p><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100">  <ellipse cx="30" cy="30" rx="10" ry="5" fill="red" stroke-width="1" stroke="rgb(0,0,0)"/></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;ellipse cx=&quot;30&quot; cy=&quot;30&quot; rx=&quot;10&quot; ry=&quot;5&quot; fill=&quot;red&quot; stroke-width=&quot;1&quot; stroke=&quot;rgb(0,0,0)&quot;/&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="lineï¼ˆç›´çº¿ï¼‰"><a href="#lineï¼ˆç›´çº¿ï¼‰" class="headerlink" title="lineï¼ˆç›´çº¿ï¼‰"></a>lineï¼ˆç›´çº¿ï¼‰</h4><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100">  <line x1='0' y1='0' x2='100' y2='100' stroke-width="1" stroke="rgb(0,0,0)"/></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;line x1=&#x27;0&#x27; y1=&#x27;0&#x27; x2=&#x27;100&#x27; y2=&#x27;100&#x27; stroke-width=&quot;1&quot; stroke=&quot;rgb(0,0,0)&quot;/&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="polylineï¼ˆå¤šçº¿æ®µï¼‰"><a href="#polylineï¼ˆå¤šçº¿æ®µï¼‰" class="headerlink" title="polylineï¼ˆå¤šçº¿æ®µï¼‰"></a>polylineï¼ˆå¤šçº¿æ®µï¼‰</h4><p><code>points</code>ä¸ºç‚¹çš„é›†åˆï¼Œæ ¼å¼ä¸º<code>x1 y1, x2 y2, ...</code>  </p><svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100" height="100">  <polyline points="0 0, 100 0, 0 100, 0 0" stroke-width="1" stroke="rgb(0,0,0)" fill="none" /></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;polyline points=&quot;0 0, 100 0, 0 100, 0 0&quot; stroke-width=&quot;1&quot; stroke=&quot;rgb(0,0,0)&quot; fill=&quot;none&quot; /&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="polygonï¼ˆå¤šè¾¹å½¢ï¼‰"><a href="#polygonï¼ˆå¤šè¾¹å½¢ï¼‰" class="headerlink" title="polygonï¼ˆå¤šè¾¹å½¢ï¼‰"></a>polygonï¼ˆå¤šè¾¹å½¢ï¼‰</h4><p>å’Œ<code>polyline</code>ç›¸åŒï¼Œä½¿ç”¨<code>points</code>è®¾ç½®ç‚¹  </p><svg height="210" width="500">  <polygon points="100 10, 40 198, 190 78, 10 78, 160 198" fill="lime" stroke="purple" stroke-width="5" fill-rule="nonzero" /></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; version=&quot;1.1&quot; width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;polygon points=&quot;100 10, 40 198, 190 78, 10 78, 160 198&quot; fill=&quot;lime&quot; stroke=&quot;purple&quot; stroke-width=&quot;5&quot; fill-rule=&quot;nonzero&quot; /&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="pathï¼ˆè·¯å¾„ï¼‰"><a href="#pathï¼ˆè·¯å¾„ï¼‰" class="headerlink" title="pathï¼ˆè·¯å¾„ï¼‰"></a>pathï¼ˆè·¯å¾„ï¼‰</h4><p>é‡ç‚¹æ¥äº†ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¹³å¸¸ç”¨åˆ°çš„æœ€å¤šçš„ä¸€ä¸ªä¸œè¥¿ã€‚  </p><p>å…³é”®çš„å±æ€§åœ¨<code>d</code>ä¸Šï¼Œæè¿°äº†å…ƒç´ çš„æ•´ä½“è·¯å¾„çš„å½¢çŠ¶ã€‚<br>ä»¥ä¸‹æ˜¯ç›¸å…³çš„è¯­æ³•ã€‚  </p><blockquote><p>M = moveto ç§»åŠ¨åˆ°æŸä¸ªä½ç½®<br>L = lineto ä»å½“å‰ç‚¹è¿çº¿åˆ°æŒ‡å®šç‚¹<br>H = horizontal lineto ä»å½“å‰ç‚¹æ°´å¹³è¿æ¥æŒ‡å®šç‚¹<br>V = vertical lineto ä»å½“å‰ç‚¹å‚ç›´è¿æ¥æŒ‡å®šç‚¹<br>C = curveto ä¸‰æ¬¡è´å¡å°”æ›²çº¿<br>S = smooth curveto ä¸‰æ¬¡å¹³æ»‘è´å¡å°”æ›²çº¿<br>Q = quadratic BÃ©zier curve äºŒæ¬¡è´å¡å°”æ›²çº¿<br>T = smooth quadratic BÃ©zier curveto å¹³æ»‘äºŒæ¬¡è´å¡å°”æ›²çº¿<br>A = elliptical Arc åœ†å¼§ï¼ˆxè½´åŠå¾„ï¼Œyè½´åŠå¾„ï¼Œæ—‹è½¬è§’åº¦ï¼Œæ˜¯å¦é€‰æ‹©å¼§é•¿è¾ƒé•¿çš„ä¸€æ®µ0çŸ­è¾¹|1é•¿è¾¹ï¼Œé¡ºæ—¶é’ˆç»˜åˆ¶1|é€†æ—¶é’ˆ0ï¼Œç»ˆç‚¹xè½´åæ ‡ï¼Œç»ˆç‚¹yè½´åæ ‡ï¼‰<br>Z = closepath  é—­åˆè·¯å¾„  </p></blockquote><p>ä»¥ä¸Šçš„å­—æ¯ï¼Œå¤§å°è¡¨ç¤ºç»å¯¹ä½ç½®ï¼Œå°å†™è¡¨ç¤ºç›¸å¯¹ä½ç½®ã€‚  </p><p><code>d</code>ä»¥<code>M</code>å¼€å¤´ï¼Œ  </p><svg width="200" height="200">  <path d="M10 10 L120 50 H140 V100" fill="none" stroke="red" stroke-width="2"></path></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;200&quot; height=&quot;200&quot;&gt;<br>  &lt;path d=&quot;M10 10 L120 50 H140 V100&quot; fill=&quot;none&quot; stroke=&quot;red&quot; stroke-width=&quot;2&quot;&gt;&lt;/path&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h5 id="A"><a href="#A" class="headerlink" title="A"></a>A</h5><p>ä»ç‚¹(10, 10)å¼€å§‹ï¼Œç»˜åˆ¶xè½´åŠå¾„ä¸º50ï¼Œyè½´åŠå¾„æ˜¯20ï¼Œæ—‹è½¬100åº¦ï¼Œä»¥å°å¼§åº¦ï¼Œé€†æ—¶é’ˆåˆ°ç‚¹ï¼ˆ100ï¼Œ 100ï¼‰å¤„ã€‚  </p><svg width="200" height="200">  <path d="M10 10 A50 20 100 0 0 100 100" fill="none" stroke="red" stroke-width="2"></path></svg><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs arduino">&lt;svg width=<span class="hljs-string">&quot;200&quot;</span> height=<span class="hljs-string">&quot;200&quot;</span>&gt;<br>  &lt;path d=<span class="hljs-string">&quot;M10 10 A50 20 180 1 0 100 100&quot;</span> fill=<span class="hljs-string">&quot;none&quot;</span> stroke=<span class="hljs-string">&quot;red&quot;</span> stroke-width=<span class="hljs-string">&quot;2&quot;</span>&gt;&lt;/path&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h4 id="textï¼ˆæ–‡æœ¬ï¼‰"><a href="#textï¼ˆæ–‡æœ¬ï¼‰" class="headerlink" title="textï¼ˆæ–‡æœ¬ï¼‰"></a>textï¼ˆæ–‡æœ¬ï¼‰</h4><svg height="210" width="500">  <text x="50" y="50" fill="lime">I am Daniel</text></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg height=&quot;210&quot; width=&quot;500&quot;&gt;<br>  &lt;text x=&quot;50&quot; y=&quot;50&quot; fill=&quot;lime&quot;&gt;I am Daniel&lt;/text&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><h4 id="defs"><a href="#defs" class="headerlink" title="defs"></a>defs</h4><p>å°†ä¸€äº›ç‰¹æ®Šçš„é…ç½®æ”¾åœ¨<code>defs</code>æ ‡ç­¾ä¸­ï¼Œæ¯”å¦‚<strong>æ»¤é•œ</strong>ã€<strong>æ¸å˜</strong>ã€<strong>é˜´å½±</strong>ç­‰ã€‚  </p><svg width="100" height="100">  <defs>    <filter id="f1">      <feGaussianBlur in="SourceGraphic" stdDeviation="15" />    </filter>  </defs>  <rect width="90" height="90" stroke="green" stroke-width="3" fill="yellow" filter="url(#f1)" /></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;defs&gt;<br>    &lt;filter id=&quot;f1&quot;&gt;<br>      &lt;feGaussianBlur in=&quot;SourceGraphic&quot; stdDeviation=&quot;15&quot; /&gt;<br>    &lt;/filter&gt;<br>  &lt;/defs&gt;<br>  &lt;rect width=&quot;90&quot; height=&quot;90&quot; stroke=&quot;green&quot; stroke-width=&quot;3&quot; fill=&quot;yellow&quot; filter=&quot;url(#f1)&quot; /&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><h5 id="filterï¼ˆæ»¤é•œï¼‰"><a href="#filterï¼ˆæ»¤é•œï¼‰" class="headerlink" title="filterï¼ˆæ»¤é•œï¼‰"></a>filterï¼ˆæ»¤é•œï¼‰</h5><p>æœ‰å¦‚ä¸‹æ»¤é•œï¼š</p><blockquote><p>feBlend - ä¸å›¾åƒç›¸ç»“åˆçš„æ»¤é•œ<br>feColorMatrix - ç”¨äºå½©è‰²æ»¤å…‰ç‰‡è½¬æ¢<br>feComponentTransfer<br>feComposite<br>feConvolveMatrix<br>feDiffuseLighting<br>feDisplacementMap<br>feFlood<br>feGaussianBlur<br>feImage<br>feMerge<br>feMorphology<br>feOffset - è¿‡æ»¤é˜´å½±<br>feSpecularLighting<br>feTile<br>feTurbulence<br>feDistantLight - ç”¨äºç…§æ˜è¿‡æ»¤<br>fePointLight - ç”¨äºç…§æ˜è¿‡æ»¤<br>feSpotLight - ç”¨äºç…§æ˜è¿‡æ»¤</p></blockquote><p>ç­‰ç­‰ã€‚  </p><h5 id="æ¸å˜"><a href="#æ¸å˜" class="headerlink" title="æ¸å˜"></a>æ¸å˜</h5><ul><li>çº¿æ€§æ¸å˜  </li></ul><svg width="100" height="100">  <defs>    <linearGradient id="linear" x1="0%" y1="0%" x2="100%" y2="100%">      <stop offset="0%" stop-color="red" stop-opacity="1"></stop>      <stop offset="100%" stop-color="yellow" stop-opacity="1"></stop>    </linearGradient>  </defs>  <rect width="50" height="50" fill="url(#linear)"></rect></svg><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs svg">&lt;svg width=&quot;100&quot; height=&quot;100&quot;&gt;<br>  &lt;defs&gt;<br>    &lt;linearGradient id=&quot;linear&quot; x1=&quot;0%&quot; y1=&quot;0%&quot; x2=&quot;100%&quot; y2=&quot;100%&quot;&gt;<br>      &lt;stop offset=&quot;0%&quot; stop-color=&quot;red&quot; stop-opacity=&quot;1&quot;&gt;&lt;/stop&gt;<br>      &lt;stop offset=&quot;100%&quot; stop-color=&quot;yellow&quot; stop-opacity=&quot;1&quot;&gt;&lt;/stop&gt;<br>    &lt;/linearGradient&gt;<br>  &lt;/defs&gt;<br>  &lt;rect width=&quot;50&quot; height=&quot;50&quot; fill=&quot;url(#linear)&quot;&gt;&lt;/rect&gt;<br>&lt;/svg&gt;<br></code></pre></td></tr></table></figure><ul><li>x1ã€y1ã€x2ã€y2è¡¨ç¤ºçº¿æ€§æ¸å˜çš„æ–¹å‘  </li><li>id è¡¨ç¤ºæ¸å˜çš„åç§°  </li><li>stop è¡¨ç¤ºå†…éƒ¨é¢œè‰²çš„å˜åŒ–æ­¥éª¤  <ul><li>offset è¡¨ç¤ºçº¿æ€§çš„ä½ç½®  </li><li>stop-color è¡¨ç¤ºé¢œè‰²  </li><li>stop-opacity è¡¨ç¤ºé€æ˜åº¦  </li></ul></li></ul><ul><li>å¾„å‘æ¸å˜</li></ul><svg width="100" height="100">  <defs>    <radialGradient id="radial" r="100%" cx="100%" cy="50%" fx="50%" fy="50%">      <stop offset="0%" stop-color="red" stop-opacity="1"></stop>      <stop offset="100%" stop-color="yellow" stop-opacity="1"></stop>    </radialGradient>  </defs>  <circle r="50" cx="50" cy="50" fill="url(#radial)"></rect></svg><p>  ä¸çº¿æ€§æ¸å˜ç±»ä¼¼  </p><ul><li>r è¡¨ç¤ºæ¸å˜çš„åœ†å½¢å¤§å°  </li><li>fxã€fy è¡¨ç¤ºæ¸å˜çš„ç„¦ç‚¹ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯ä¸€ä¸ªç¯å…‰æ•ˆæœï¼Œæˆ–è€…è¯´æ¸å˜<code>åœ†å¿ƒ</code>åœ¨å›¾å½¢ä¸Šçš„ä½ç½®ã€‚    </li><li>fr è¡¨ç¤ºç„¦ç‚¹çš„å¤§å°  </li><li>cxã€cy è¡¨ç¤ºæ¸å˜ç»“æŸçš„åœ†å¿ƒä½ç½®  </li></ul><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>ä»¥ä¸Šå°±æ˜¯æœ¬äººç›¸å…³çš„ç¬”è®°ã€‚<br>ä¸‹é¢ç»™åˆ°ä¸€äº›é“¾æ¥ï¼š<br><a href="https://c.runoob.com/more/svgeditor/">ç¼–è¾‘å™¨</a><br><a href="https://www.runoob.com/svg/svg-reference.html">APIå‚è€ƒ</a>  </p><h2 id="é™„å¢"><a href="#é™„å¢" class="headerlink" title="é™„å¢"></a>é™„å¢</h2><p>è¿™é‡Œä¿å­˜ä¸€äº›å¹³å¸¸çœ‹åˆ°çš„æœ‰æ„æ€çš„<code>svg</code>æ•ˆæœğŸ‘ã€‚    </p>]]></content>
    
    
    <categories>
      
      <category>svg</category>
      
      <category>css</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>css svg</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€åˆ›èšå®½å­¦ä¹ </title>
    <link href="/2022/09/12/%E4%B8%80%E5%88%9B%E8%81%9A%E5%AE%BD%E5%AD%A6%E4%B9%A0/"/>
    <url>/2022/09/12/%E4%B8%80%E5%88%9B%E8%81%9A%E5%AE%BD%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€åˆ›èšå®½å­¦ä¹ "><a href="#ä¸€åˆ›èšå®½å­¦ä¹ " class="headerlink" title="ä¸€åˆ›èšå®½å­¦ä¹ "></a>ä¸€åˆ›èšå®½å­¦ä¹ </h2><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä½œä¸ºä¸€ä¸ªğŸŒ¶ğŸ”æŠ€æœ¯äººï¼Œæ¯å¤©æƒ³çš„éƒ½æ˜¯å¦‚ä½•æğŸ’°ï¼Œæ¯å¤©ç›¯ç€ğŸ”ğŸ’°æ¶¨æ¶¨è·Œè·Œï¼Œä¸€å¤œå›åˆ°è§£æ”¾å‰ï¼Œå—å¤Ÿäº†ã€‚æ˜¯æ—¶å€™é€šè¿‡çŸ¥è¯†åˆ›é€ è´¢å¯Œäº†ã€‚<br>å­¦ä¹ é‡åŒ–äº¤æ˜“ï¼Œå¦‚æœé€šè¿‡è‡ªåŠ¨åŒ–æ¥è¿›è¡Œäº¤æ˜“ï¼Œå®ç°è´¢å¯Œè‡ªç”±ğŸ‘ã€‚  </p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p><a href="https://ycjq.95358.com/">ä¸€åˆ›èšå®½</a>æ˜¯å›½å†…æ¯”è¾ƒæœ‰åçš„è‚¡ç¥¨é‡åŒ–äº¤æ˜“å¹³å°ï¼Œå®ƒå¸®åŠ©å¼€å‘è€…å°è£…äº†å¾ˆå¤šå®ç”¨çš„å‡½æ•°ï¼Œå¹¶æä¾›äº†å®ç›˜æ•°æ®ï¼Œä»¥åŠå®ç›˜æ¥å…¥å¸®åŠ©ã€‚å¤§å¤§ç®€åŒ–äº†å¼€å‘è€…çš„å¼€å‘è¿‡ç¨‹ã€‚æœ¬æ–‡å°±ç®€å•çš„è®°å½•ä¸€ä¸‹è‡ªå·±çš„å­¦ä¹ ç¬”è®°ğŸ“ã€‚  </p><h3 id="æ€»ä½“ç»“æ„"><a href="#æ€»ä½“ç»“æ„" class="headerlink" title="æ€»ä½“ç»“æ„"></a>æ€»ä½“ç»“æ„</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span>(<span class="hljs-params">context</span>):</span><br>  run_daily(period, time=<span class="hljs-string">&#x27;every_bar&#x27;</span>)<br>  g.security = <span class="hljs-string">&#x27;000001.XSHE&#x27;</span><br><br><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">period</span>(<span class="hljs-params">context</span>):</span><br>  order(g.security, <span class="hljs-number">100</span>) <br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„ç»“æ„ã€‚  </p><ul><li><code>initialize</code>è¡¨ç¤ºåˆå§‹åŒ–ã€‚  </li><li><code>run_daily</code>è¡¨ç¤ºå¾ªç¯æ‰§è¡Œçš„å‡½æ•°ã€‚<br><a href="https://ycjq.95358.com/help/api/help?name=api#run_daily">ä¼ é€é—¨</a>  </li><li><code>order</code>è¡¨ç¤ºä¹°å…¥å–å‡ºçš„å‡½æ•°ã€‚<br><a href="https://ycjq.95358.com/help/api/help?name=api#%E4%BA%A4%E6%98%93%E5%87%BD%E6%95%B0%E2%99%A0">ä¼ é€é—¨</a>  </li><li><code>g</code>æ˜¯ä¸€ä¸ªå…¨å±€çš„å˜é‡ï¼Œå¯ä»¥æŠŠè‡ªå®šä¹‰çš„ä¸€äº›å˜é‡èµ‹å€¼åˆ°å®ƒä¸‹é¢  </li><li><code>context</code>ä¹Ÿæ˜¯ä¸ªç±»ä¼¼<code>g</code>çš„å˜é‡ï¼Œå½“ä¸­å­˜å‚¨äº†å¾ˆå¤šæœ‰ç”¨çš„ä¿¡æ¯ã€‚  <img src="/images/ä¸€åˆ›èšå®½å­¦ä¹ /context.png" /></li></ul><h3 id="ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å’Œå±æ€§"><a href="#ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å’Œå±æ€§" class="headerlink" title="ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å’Œå±æ€§"></a>ä¸€äº›å¸¸ç”¨çš„å‡½æ•°å’Œå±æ€§</h3><h4 id="SecurityUnitData"><a href="#SecurityUnitData" class="headerlink" title="SecurityUnitData"></a>SecurityUnitData</h4><p>è‚¡ç¥¨è¡Œæƒ…æ•°æ®æ ¼å¼  </p><blockquote><p>open: æ—¶é—´æ®µå¼€å§‹æ—¶ä»·æ ¼<br>close: æ—¶é—´æ®µç»“æŸæ—¶ä»·æ ¼<br>low: æœ€ä½ä»·<br>high: æœ€é«˜ä»·<br>volume: æˆäº¤çš„è‚¡ç¥¨æ•°é‡<br>money: æˆäº¤çš„é‡‘é¢<br>factor: å‰å¤æƒå› å­<br>avg: è¿™æ®µæ—¶é—´çš„å¹³å‡ä»·<br>pre_close: å‰ä¸€ä¸ªå•ä½æ—¶é—´ç»“æŸæ—¶çš„ä»·æ ¼<br>paused: è¿™åªè‚¡ç¥¨æ˜¯å¦åœç‰Œï¼Œæ˜¯åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0  </p></blockquote><h4 id="get-index-stocks"><a href="#get-index-stocks" class="headerlink" title="get_index_stocks"></a>get_index_stocks</h4><p>è·å–æŒ‡æ•°æˆåˆ†è‚¡<br><code>get_index_stocks(&quot;000300.XSHG&quot;, &#39;2022-01-01&#39;)</code><br>è·å–<code>2022-01-01</code>æ—¶çš„æ²ªæ·±300çš„è‚¡ç¥¨é›†åˆ  </p><h4 id="history"><a href="#history" class="headerlink" title="history"></a>history</h4><p>è‚¡ç¥¨å†å²è¡Œæƒ…æ•°æ®  </p><ul><li>count: ç»“æœé›†çš„è¡Œæ•°  </li><li>unit: æ—¶é—´é•¿åº¦ <code>1d</code> || <code>1m</code>   </li><li>field æ•°æ®ç±»å‹ <code>SecurityUnitData</code>  </li><li>security_list è‚¡ç¥¨åˆ—è¡¨  </li><li>df  </li><li>skip_paused æ˜¯å¦è·³è¿‡ä¸äº¤æ˜“æ—¥æœŸï¼ˆåŒ…æ‹¬åœç‰Œ, æœªä¸Šå¸‚æˆ–è€…é€€å¸‚åçš„æ—¥æœŸï¼‰ï¼Œæš‚æ—¶æ²¡æœ‰å¤ªç†è§£ï¼Œåé¢ç”¨åˆ°äº†å†çœ‹ã€‚  </li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">history(field=<span class="hljs-string">&#x27;close&#x27;</span>, count=<span class="hljs-number">3</span>, security_list=[<span class="hljs-string">&#x27;000001.XSHE&#x27;</span>,<span class="hljs-string">&#x27;000002.XSHE&#x27;</span>])<br><span class="hljs-comment"># æ•°æ®æ ¼å¼ï¼š</span><br><span class="hljs-comment"># ä¸¤æ”¯è‚¡ç¥¨çš„æ”¶ç›˜ä»·</span><br><span class="hljs-comment">#                      </span><br><span class="hljs-comment"># 2016-08-29  11.05  9.31</span><br><span class="hljs-comment"># 2016-08-30  11.1  9.33</span><br><span class="hljs-comment"># 2016-08-31  12.33  9.36</span><br></code></pre></td></tr></table></figure><h4 id="attribute-history"><a href="#attribute-history" class="headerlink" title="attribute_history"></a>attribute_history</h4><p>ç±»ä¼¼äºä¸Šé¢çš„<code>history</code><br>ä½†æ˜¯åªèƒ½è·å–ä¸€æ”¯è‚¡ç¥¨ï¼Œå¹¶ä¸”èƒ½è·å¾—å¤šä¸ªå­—æ®µ  </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">attribute_history(field=[<span class="hljs-string">&#x27;money&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>], count=<span class="hljs-number">3</span>, security=<span class="hljs-string">&#x27;000001.XSHE&#x27;</span>)<br><span class="hljs-comment"># ç»“æœå¦‚ä¸‹ï¼š</span><br><span class="hljs-comment">#                    money  high</span><br><span class="hljs-comment"># 2016-08-29  5.322954e+08  9.31</span><br><span class="hljs-comment"># 2016-08-30  5.618541e+08  9.33</span><br><span class="hljs-comment"># 2016-08-31  4.638758e+08  9.36</span><br></code></pre></td></tr></table></figure><h4 id="get-fundamentals"><a href="#get-fundamentals" class="headerlink" title="get_fundamentals"></a>get_fundamentals</h4><p>è·å–å…¬å¸<strong>è´¢åŠ¡æ•°æ®</strong>  </p><ul><li>query<br>æ•°æ®æŸ¥è¯¢ï¼Œç±»ä¼¼äº<code>mysql</code>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¿«é€Ÿä¸Šæ‰‹æ¨¡æ¿</span><br><span class="hljs-comment"># query(è¡¨.å­—æ®µ).filter(ç­›é€‰æ¡ä»¶).order_by(æ’åºæ–¹æ³•).limit(æ•°é‡ä¸Šé™)</span><br><span class="hljs-comment">#æ¯”è¾ƒé•¿çš„è¯å¯ä»¥åˆ†è¡Œå†™</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h3><h4 id="å¸‚ä»·å•å’Œé™ä»·å•"><a href="#å¸‚ä»·å•å’Œé™ä»·å•" class="headerlink" title="å¸‚ä»·å•å’Œé™ä»·å•"></a>å¸‚ä»·å•å’Œé™ä»·å•</h4><ul><li>å¸‚ä»·å•æ˜¯æŒ‡æŠ•èµ„è€…åœ¨äº¤æ˜“ä¸ªè‚¡æ—¶ï¼Œä»¥å¸‚åœºçš„ä»·æ ¼æˆäº¤ï¼Œè€Œé™ä»·å•ä¸€èˆ¬æ˜¯æŒ‡ä¸ªè‚¡çš„å¸‚åœºä»·æ ¼ï¼Œè¾¾åˆ°æŠ•èµ„è€…æŒ‡å®šçš„ä»·æ ¼æ—¶æ‰æˆäº¤ã€‚  </li><li>å¸‚ä»·å•é€šå¸¸å¯ä»¥å¾ˆå¿«åœ°æˆäº¤ï¼Œè€Œé™ä»·å•çš„ä¼˜åŠ¿åœ¨äºä»¥ç†æƒ³çš„ä»·æ ¼æˆäº¤ï¼Œè¿™ä¸¤ç§å•é€‚åˆä¸åŒçš„è¡Œæƒ…ã€‚  </li><li>æŠ•èµ„è€…ä»¥å¸‚ä»·å§”æ‰˜äº¤æ˜“çš„ä¼˜ç‚¹æ˜¯åœ¨ä¸Šæ¶¨è¡Œæƒ…ä¸‹èƒ½åŠæ—¶ä¹°è¿›ï¼Œåœ¨ä¸‹è·Œè¡Œæƒ…ä¸‹èƒ½åŠæ—¶å–å‡ºï¼Œè€Œä»¥é™ä»·å§”æ‰˜äº¤æ˜“çš„ä¼˜ç‚¹æ˜¯åˆ©äºæŠ•èµ„è€…æ§åˆ¶äº¤æ˜“æˆæœ¬ã€‚<br><a href="https://www.51credit.com/wenda/925559.html">åŸæ–‡</a>  </li></ul><h4 id="æŒ‡æ ‡"><a href="#æŒ‡æ ‡" class="headerlink" title="æŒ‡æ ‡"></a>æŒ‡æ ‡</h4><p>äº¤æ˜“æ¬¡æ•°ã€ç­–ç•¥æ”¶ç›Šã€åŸºå‡†æ”¶ç›Šã€å¹´åŒ–æ”¶ç›Šç‡ã€æœ€å¤§å›æ’¤ç‡ã€Alphaã€Betaã€å¤æ™®æ¯”ç‡ã€‚  </p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>å†…å®¹å¤§æ¦‚å°±è¿™äº›ï¼Œå…³äºä¸€äº›é«˜æ·±çš„ç”¨æ³•ï¼Œä»¥åŠä¸€äº›<code>API</code>çš„ä½¿ç”¨ï¼Œç­‰åé¢å®é™…ä½¿ç”¨æ—¶ï¼Œå†æ…¢æ…¢è¡¥å……å§ğŸ‘ã€‚  </p>]]></content>
    
    
    <categories>
      
      <category>é‡åŒ–äº¤æ˜“</category>
      
    </categories>
    
    
    <tags>
      
      <tag>trade</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>parallaxä½¿ç”¨</title>
    <link href="/2022/07/08/parallax%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/07/08/parallax%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æœ€è¿‘æƒ³ç»™è‡ªå·±çš„é¡¹ç›®è®¾è®¡ä¸€ä¸ªæ¯”è¾ƒç‚«é…·çš„é¦–é¡µï¼Œå‘ç°äº†è¿™ä¸ªå·¥å…·â€“<a href="http://matthew.wagerfield.com/parallax/">parallax</a>ï¼Œæ•…åœ¨è¿™é‡Œåšä¸€ä¸ªç®€å•çš„ä»‹ç»ğŸ‘ ã€‚</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p><code>parallax</code>é¡¾åæ€ä¹‰ï¼Œè§†å·®ã€‚<br>ç™¾åº¦è¿™æ ·è§£é‡Šï¼š</p><blockquote><p>è§†å·®å°±æ˜¯ä»æœ‰ä¸€å®šè·ç¦»çš„ä¸¤ä¸ªç‚¹ä¸Šè§‚å¯ŸåŒä¸€ä¸ªç›®æ ‡æ‰€äº§ç”Ÿçš„æ–¹å‘å·®å¼‚ã€‚ä»ç›®æ ‡çœ‹ä¸¤ä¸ªç‚¹ä¹‹é—´çš„å¤¹è§’ï¼Œå«åšè¿™ä¸¤ä¸ªç‚¹çš„è§†å·®ï¼Œä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ç§°ä½œåŸºçº¿ã€‚åªè¦çŸ¥é“è§†å·®è§’åº¦å’ŒåŸºçº¿é•¿åº¦ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºç›®æ ‡å’Œè§‚æµ‹è€…ä¹‹é—´çš„è·ç¦»ã€‚  </p></blockquote><p><code>parallax</code>å¸®åŠ©ä½ å®Œæˆäº†ç›¸å…³å·¥ä½œï¼Œä½ åªéœ€è¦å†™å¥½ç›¸å…³çš„<code>html</code>ç»“æ„ï¼Œå†é€šè¿‡ç®€å•çš„é…ç½®å³å¯å®Œæˆéå¸¸ç‚«é…·çš„è§†å·®åŠ¨ç”»ã€‚  </p><h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><p>ä¸‹é¢æ˜¯å¯¹å…¶é…ç½®åšçš„ä¸€ä¸ªç®€å•çš„ä»‹ç»ã€‚  </p><h4 id="relativeInput"><a href="#relativeInput" class="headerlink" title="relativeInput"></a>relativeInput</h4><p>å¯¹åœºæ™¯è¿›è¡Œå…¨æ–¹ä½çš„æ§åˆ¶ã€‚<br>å¼€å¯æ—¶ï¼Œå®¹å™¨å†…çš„å…ƒç´ çš„è§†å·®æ•ˆæœè¡¨ç°ä¸ºæ•´ä¸ªé¡µé¢ã€‚  </p><h4 id="hoverOnly"><a href="#hoverOnly" class="headerlink" title="hoverOnly"></a>hoverOnly</h4><p>æ˜¯å¦åªåœ¨é¼ æ ‡åœ¨åœºæ™¯å†…è§¦å‘æ•ˆæœã€‚<br>å½“å…³é—­è¯¥åŠŸèƒ½æ—¶ï¼Œåªæœ‰é¼ æ ‡åœ¨å®¹å™¨å…ƒç´ å†…æ—¶ï¼Œæ‰ä¼šæœ‰è§†å·®çš„åŠ¨ç”»æ•ˆæœã€‚  </p><h4 id="clipRelativeInput"><a href="#clipRelativeInput" class="headerlink" title="clipRelativeInput"></a>clipRelativeInput</h4><p>æ§åˆ¶è§†å·®æ•ˆæœçš„è¾¹ç•Œã€‚<br>å¼€å¯æ—¶ï¼Œå½“æ•ˆæœè§¦ç¢°åˆ°å®¹å™¨çš„è¾¹ç¼˜æ—¶ï¼Œä¾¿ä¼šåœæ­¢åŠ¨ç”»ã€‚  </p><h4 id="inputElement"><a href="#inputElement" class="headerlink" title="inputElement"></a>inputElement</h4><p>æ§åˆ¶è§¦å‘è§†å·®æ•ˆæœçš„èŒƒå›´ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªå…ƒç´ èŠ‚ç‚¹ã€‚<br>å’Œ<code>relativeInput</code>å’Œ<code>hoverOnly</code>é…åˆä½¿ç”¨ã€‚  </p><h4 id="selector"><a href="#selector" class="headerlink" title="selector"></a>selector</h4><p>æ§åˆ¶éœ€è¦è§¦å‘è§†å·®åŠ¨ç”»çš„å…ƒç´ ï¼Œå½“é»˜è®¤ä¸º<code>null</code>æ—¶ï¼Œå®¹å™¨å†…çš„æ‰€æœ‰å…ƒç´ å‡ä¼šè§¦å‘ã€‚  </p><h4 id="limitX-amp-limitY"><a href="#limitX-amp-limitY" class="headerlink" title="limitX &amp; limitY"></a>limitX &amp; limitY</h4><p>å…ƒç´ åœ¨è½´ä¸Šè¿åŠ¨çš„æœ€å¤§è·ç¦»ã€‚<br>è®¾ç½®<code>false</code>è¡¨ç¤ºä¸é™åˆ¶ã€‚  </p><h4 id="invertX-amp-invertY"><a href="#invertX-amp-invertY" class="headerlink" title="invertX &amp; invertY"></a>invertX &amp; invertY</h4><p>åè½¬å…ƒç´ çš„è¿åŠ¨æ–¹å‘ï¼Œè®¾ç½®<code>true</code>åˆ™è¿åŠ¨æ–¹å‘ä¸é¼ æ ‡ç§»åŠ¨æ–¹å‘ç›¸åã€‚  </p><h4 id="calibrateX-amp-calibrateY"><a href="#calibrateX-amp-calibrateY" class="headerlink" title="calibrateX &amp; calibrateY"></a>calibrateX &amp; calibrateY</h4><p>ä¿å­˜å…ƒç´ åˆå§‹çš„ä½ç½®ï¼Œå¹¶æ ¹æ®è¯¥å€¼è¿›è¡Œè¿åŠ¨ã€‚ï¼ˆğŸ¤”ï¼Œæ²¡å¤ªæ‡‚ï¼Œå¥½åƒæ²¡å•¥æ•ˆæœï¼‰  </p><h4 id="scalarX-amp-scalarY"><a href="#scalarX-amp-scalarY" class="headerlink" title="scalarX &amp; scalarY"></a>scalarX &amp; scalarY</h4><p>è®¾ç½®è¿åŠ¨è·ç¦»çš„ä¹˜æ•°ï¼Œæ§åˆ¶å…ƒç´ è¿åŠ¨çš„å¤§å°ã€‚  </p><h4 id="frictionX-amp-frictionY"><a href="#frictionX-amp-frictionY" class="headerlink" title="frictionX &amp; frictionY"></a>frictionX &amp; frictionY</h4><p>è®¾ç½®å…ƒç´ è¿åŠ¨çš„ç¼“å†²ï¼Œä½äº<code>1</code>æ—¶ï¼Œä¼šå‡ç¼“è¿åŠ¨çš„é€Ÿåº¦ï¼Œé»˜è®¤<code>1.5</code>  </p><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>ä¸Šé¢çš„ä¸€äº›<code>API</code>åŒæ ·å¯ä»¥é€šè¿‡å®ä¾‹è¿›è¡Œæ§åˆ¶ï¼Œæ¯”å¦‚<code>limit</code>ã€<code>invert</code>ã€<code>calibrate</code>ã€<code>scalar</code>ã€<code>friction</code><br>è¿˜æœ‰ä»¥ä¸‹å¸¸ç”¨æ–¹æ³•<br><code>enable</code>ã€<code>disable</code>ã€<code>destroy</code>ã€<code>version</code>  </p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
      <category>å‰ç«¯</category>
      
      <category>åŠ¨ç”»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>animation</tag>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gsapåŠ¨ç”»çš„ç®€å•ä½¿ç”¨</title>
    <link href="/2022/06/23/gsap%E5%8A%A8%E7%94%BB%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/06/23/gsap%E5%8A%A8%E7%94%BB%E7%9A%84%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æœ€è¿‘çªç„¶éœ€è¦å†™ä¸€äº›åŒ…å«å¤šç§åŠ¨ç”»çš„é¦–é¡µï¼Œå¶ç„¶æ‰¾åˆ°äº†<a href="https://greensock.com/">gsap</a>ï¼Œå‘ç°æ˜¯çœŸçš„å¥½ç”¨ï¼Œè¿™é‡Œå¯¹å…¶ä¸€äº›<code>api</code>åšä¸‹ç®€å•ä»‹ç»ã€‚  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p><code>gsap</code>æ˜¯ä¸€ä¸ª<code>javascript</code>åŠ¨ç”»åº“ï¼Œå¯ä»¥è®©å¼€å‘è€…é€šè¿‡ç®€å•çš„<code>api</code>å®Œæˆéå¸¸å¤æ‚çš„åŠ¨ç”»ï¼ŒåŒ…å«éå¸¸å¤šç§ç±»å‹çš„åŠ¨ç”»çš„å®ç°ï¼Œæ¯”å¦‚<code>css3</code>åŠ¨ç”»ï¼Œ<code>svg</code>åŠ¨ç”»ä»¥åŠ<code>canvas</code>ã€<code>webgl</code>ç­‰ã€‚  </p><p>å®˜ç½‘ç»™å‡ºäº†å¤§é‡çš„ç¤ºä¾‹ä»£ç ï¼Œå¯ä»¥<a href="https://codepen.io/collection/AQPByE">å‰å¾€æŸ¥çœ‹</a>  </p><blockquote><p>ä½†æ˜¯å®ƒçš„ç¼ºç‚¹å°±æ˜¯æœ‰äº›åŠŸèƒ½æ˜¯ä»˜è´¹çš„ğŸ¤·ğŸ»â€â™€ï¸ï¼Œæ¯”å¦‚<code>SplitText</code>ã€<code>DrawSvg</code>ç­‰åŠŸèƒ½ï¼Œä»–ä»¬èƒ½å®ç°éå¸¸ç‚«é…·çš„åŠ¨ç”»æ•ˆæœï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œè´­ä¹°ä½¿ç”¨ã€‚ï¼ˆåæ­£æˆ‘ä¸ä¹°ğŸ˜ºï¼‰  </p></blockquote><ul><li>ä»¥ä¸‹çš„ä»‹ç»å…¨éƒ¨éƒ½æ˜¯<strong>gsap3</strong>çš„å†…å®¹ã€‚  </li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>æœ¬æ¬¡ä½¿ç”¨å¤§æ¦‚ç”¨åˆ°äº†ä»¥ä¸‹å‡ ä¸ª<code>api</code>ï¼š<code>to</code>ã€<code>from</code>ã€<code>timeline</code>ã€‚<br>ç”¨åˆ°çš„æ’ä»¶ä¸ºï¼š<code>ScrollTrigger</code>ã€<code>TextPlugin</code>ã€<code>MotionPathPlugin</code>  </p><h4 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h4><p>ä½¿ç”¨çš„æ’ä»¶éƒ½éœ€è¦æå‰æ³¨å†Œã€‚  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> &#123; gsap &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;gsap&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ScrollTrigger &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;gsap/ScrollTrigger&#x27;</span><br><span class="hljs-keyword">import</span> &#123; TextPlugin &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;gsap/TextPlugin&#x27;</span><br><span class="hljs-keyword">import</span> &#123; MotionPathPlugin &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;gsap/MotionPathPlugin&#x27;</span><br><br>gsap.registerPlugin(ScrollTrigger, TextPlugin, MotionPathPlugin)<br></code></pre></td></tr></table></figure><h5 id="ScrollTrigger"><a href="#ScrollTrigger" class="headerlink" title="ScrollTrigger"></a>ScrollTrigger</h5><p>  <code>ScrollTrigger</code>ä¸ºæ»šåŠ¨æ“ä½œçš„å…³è”åŠ¨ç”»ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®æ»šåŠ¨å®ç°ç›¸å…³çš„åŠ¨ç”»ã€‚  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js">gsap.to(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<br>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,<br>  <span class="hljs-attr">scrollTrigger</span>: &#123;<br>    <span class="hljs-attr">trigger</span>: <span class="hljs-string">&#x27;div&#x27;</span>, <span class="hljs-comment">//è§¦å‘æ»šåŠ¨åŠ¨ç”»çš„å…ƒç´ </span><br>    <span class="hljs-attr">start</span>: <span class="hljs-string">&#x27;start bottom&#x27;</span>, <span class="hljs-comment">// åŠ¨ç”»å¼€å§‹æ‰§è¡Œçš„æ—¶æœºï¼ˆå¼€å§‹/ç»“æŸï¼‰</span><br>    <span class="hljs-comment">// å››ä¸ªå­—ç¬¦ä¸²ä»£è¡¨å››ä¸ªæ—¶æœºï¼šonEnter onLeave onEnterBack onLeaveBack</span><br>    <span class="hljs-comment">// æ¯ä¸ªæ—¶æœºæ‰€æœ‰çš„åŠ¨ç”»ç±»å‹ï¼šplay pause resume reset restart complete reverse none </span><br>    <span class="hljs-attr">toggleAction</span>: <span class="hljs-string">&#x27;play none none reverse&#x27;</span>, <span class="hljs-comment">// åŠ¨ç”»å¯¹åº”æ—¶é—´è§¦å‘çš„åŠ¨ä½œ  </span><br>    <span class="hljs-attr">scrub</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ˜¯å¦è·Ÿéšé¼ æ ‡æ»šåŠ¨æ‰§è¡ŒåŠ¨ç”»ï¼Œè¾¹æ»šåŠ¨è¾¹æ‰§è¡ŒåŠ¨ç”»</span><br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>  <a href="https://codepen.io/GreenSock/pens/tags/?selected_tag=scrolltrigger">å®˜ç½‘ä¾‹å­</a>  </p><h5 id="TextPlugin"><a href="#TextPlugin" class="headerlink" title="TextPlugin"></a>TextPlugin</h5><p>  <code>TextPlugin</code>ä¸ºä¸€äº›æ–‡å­—åŠ¨ç”»çš„æ’ä»¶ï¼Œæˆ‘ç†è§£çš„æ˜¯æ–‡å­—åŠ¨ç”»çš„åŸºç¡€ç‰ˆã€‚<br>  æš‚æ—¶æ²¡æœ‰ç”¨åˆ°å•¥ç‰¹æ®Šçš„é…ç½®ã€‚<br>  <a href="https://codepen.io/collection/DmQpRq">å®˜ç½‘ä¾‹å­</a>    </p><h5 id="MotionPathPlugin"><a href="#MotionPathPlugin" class="headerlink" title="MotionPathPlugin"></a>MotionPathPlugin</h5><p>  <code>MotionPathPlugin</code>ä¸ºè·¯å¾„åŠ¨ç”»ï¼Œå¯ä»¥é€šè¿‡<code>svg</code>çš„<code>path</code>å®ç°ç›¸å…³çš„åŠ¨ç”»ã€‚  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">gsap.to(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<br>  <span class="hljs-attr">motionPath</span>: &#123;<br>    <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;#path&quot;</span>, <span class="hljs-comment">// svgè·¯å¾„å…ƒç´ </span><br>    <span class="hljs-attr">align</span>: <span class="hljs-string">&quot;#path&quot;</span>, <span class="hljs-comment">// å¯¹é½åˆ°è·¯å¾„</span><br>    <span class="hljs-attr">autoRotate</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// è‡ªåŠ¨æ—‹è½¬ï¼Œä¼šè·Ÿéšè·¯å¾„è‡ªåŠ¨æ—‹è½¬åŠ¨ç”»å…ƒç´ </span><br>    <span class="hljs-attr">alignOrigin</span>: [<span class="hljs-number">0.5</span>, <span class="hljs-number">0.5</span>] <span class="hljs-comment">// ä¸è·¯å¾„çš„é‡åˆç¨‹åº¦ï¼Œå½“å‰è®¾ç½®è¡¨ç¤ºå±…ä¸­  </span><br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><p>  <a href="https://codepen.io/GreenSock/pens/tags/?selected_tag=motionpathplugin">å®˜ç½‘ä¾‹å­</a>  </p><h4 id="to"><a href="#to" class="headerlink" title="to"></a>to</h4><p>è¡¨ç¤ºå…ƒç´ ä»å½“å‰çŠ¶æ€è½¬æ¢ä¸º<code>to</code>æŒ‡å®šçš„ä¸€äº›åŠ¨ç”»çŠ¶æ€ã€‚<br>æ¯”å¦‚ï¼Œå°†å…ƒç´ ç§»åŠ¨åˆ°<code>(100, 100)</code>ï¼Œå¹¶ä¸”<code>opacity</code>ä»1åˆ°0ã€‚  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">gsap.to(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<br>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,<br>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>,<br>  <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>,<br>&#125;)<br></code></pre></td></tr></table></figure><p>ä¸‹é¢ä»‹ç»å…¶ä¸­ä¸€äº›å¸¸ç”¨çš„å±æ€§ï¼Œä¸ä¸‹é¢<code>from</code>æ–¹æ³•çš„å‚æ•°åŸºæœ¬ç›¸åŒã€‚  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> Option = &#123;<br>  <span class="hljs-attr">duration</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´</span><br>  <span class="hljs-attr">repeat</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// é‡å¤æ¬¡æ•°ï¼Œ-1æ— é™åˆ¶</span><br>  <span class="hljs-attr">repeatDelay</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// äºŒæ¬¡æ‰§è¡ŒåŠ¨ç”»çš„å»¶è¿Ÿæ—¶é—´  </span><br>  <span class="hljs-attr">yoyo</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// åŠ¨ç”»æ˜¯å¦é‡å¤å¾€è¿”æ‰§è¡Œï¼Œæ¯”å¦‚ï¼šä»1-2ï¼Œç„¶åä»2-1  </span><br>  <span class="hljs-attr">stagger</span>: <span class="hljs-number">0.5</span>, <span class="hljs-comment">// å¤šä¸ªåŠ¨ç”»é”™å¼€æ‰§è¡Œçš„æ—¶é—´é—´éš”  </span><br>  <span class="hljs-attr">ease</span>: <span class="hljs-string">&#x27;power1.inOut&#x27;</span>, <span class="hljs-comment">// åŠ¨ç”»çš„é€Ÿåº¦æ›²çº¿ï¼Œè¯¦ç»†å¯ä»¥æŸ¥çœ‹æ–‡ä»¶ /node_modules/gsap/types/ease.d.ts  </span><br>  <span class="hljs-comment">// css å±æ€§</span><br>  <span class="hljs-attr">scale</span>: <span class="hljs-number">1</span> <span class="hljs-comment">// ç¼©æ”¾</span><br>  <span class="hljs-attr">rotate</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// æ—‹è½¬</span><br>  <span class="hljs-attr">transformOrigin</span>: <span class="hljs-string">&#x27;center&#x27;</span>, <span class="hljs-comment">// å˜æ¢ä¸­å¿ƒç‚¹</span><br>  <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// å®½åº¦ 100vh 100px 100% éƒ½å¯ä»¥</span><br>  <span class="hljs-attr">height</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// é«˜åº¦åŒç†</span><br>  <span class="hljs-attr">visibility</span>: <span class="hljs-string">&#x27;visible&#x27;</span>, <span class="hljs-comment">// æ˜¾ç¤ºéšè—  </span><br>  <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;red&#x27;</span>, <span class="hljs-comment">// é¢œè‰²</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="from"><a href="#from" class="headerlink" title="from"></a>from</h4><p>ä¸<code>to</code>ç›¸åï¼Œè¡¨ç¤ºå…ƒç´ ä»<code>from</code>çŠ¶æ€è½¬ä¸º<code>å…ƒç´ å½“å‰çŠ¶æ€</code>ã€‚  </p><h4 id="timeline"><a href="#timeline" class="headerlink" title="timeline"></a>timeline</h4><p><code>timeline</code>å¯ä»¥ç†è§£æˆä¸Šè¿°<code>api</code>çš„ä¸€ä¸ªé›†åˆã€‚<br>æœ‰æ—¶å¯èƒ½éœ€è¦æŒ‰ç…§æ—¶é—´é¡ºåºï¼ŒæŒ‰é¡ºåºçš„æ‰§è¡Œä¸€ç³»åˆ—çš„åŠ¨ç”»ä»»åŠ¡ï¼Œè¿™å°†æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚  </p><p>æ¯”å¦‚ä¸€ä¸ªçŸ©å½¢å…ƒç´ ï¼Œé¦–å…ˆ<code>x</code>ç§»åŠ¨åˆ°<code>100</code>ï¼Œæ¥ç€<code>y</code>ç§»åŠ¨åˆ°<code>100</code>ï¼Œå³ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">gsap.timeline()<br>.to(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<br>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span><br>&#125;)<br>.to(<span class="hljs-string">&#x27;div&#x27;</span>, &#123;<br>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span><br>&#125;)<br></code></pre></td></tr></table></figure><p><a href="https://codepen.io/GreenSock/pens/tags/?selected_tag=timeline">å®˜ç½‘ç¤ºä¾‹</a></p><h4 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h4><p><code>gsap</code>çš„åŠ¨ç”»èƒ½åŠ›éå¸¸çš„å¼ºï¼Œä½†æ˜¯ä¹Ÿæœ‰é™åˆ¶æ€§ï¼Œä»¥ä¸‹ä¸ºæœ¬äººè§‚ç‚¹ï¼Œä¸ä¸€å®šæ­£ç¡®ï¼š<br>  å…¶å®ç°åŠ¨ç”»çš„<code>css</code>èƒ½åŠ›ä¸<code>transition</code>æœ‰éå¸¸å¤§çš„å…³ç³»ï¼Œåªæœ‰èƒ½å“åº”<code>transition</code>çš„å±æ€§æ‰èƒ½å½¢æˆåŠ¨ç”»ï¼Œæ¯”å¦‚<code>width</code>ã€<code>height</code>ã€<code>backgroundColor</code>ã€<code>scale</code>ç­‰ã€‚<br>  ä½†æ˜¯æœ‰äº›å±æ€§æ˜¯æ— æ³•å“åº”çš„ï¼Œæ¯”å¦‚<code>display</code>ï¼Œå½“è®¾ç½®å…¶ä»<code>block</code>å˜ä¸º<code>none</code>æ—¶ï¼Œä¸ºç¬é—´å˜åŒ–ï¼Œæ— åŠ¨ç”»æ•ˆæœã€‚  </p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p><code>gsap</code>çš„åŠŸèƒ½éå¸¸çš„å¼ºå¤§ï¼Œä»¥ä¸Šä½¿ç”¨çš„åŠŸèƒ½åªæ˜¯çš®è‚¤ï¼Œå„ä½å¯ä»¥è‡ªå·±å»ç¢ç£¨ã€‚<br>é¡ºä¾¿çœ‹ä¸‹æœ¬äººä½¿ç”¨çš„æ•ˆæœï¼š<a href="https://food-billboard.github.io/create-chart-docs/">gh-pages</a>æˆ–<a href="http://47.97.27.23/api/backend/create-chart-docs/index.html">ç§äººæœåŠ¡å™¨</a>ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>animation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœåŠ¡ç«¯puppeteerçš„ä½¿ç”¨</title>
    <link href="/2022/04/21/%E6%9C%8D%E5%8A%A1%E7%AB%AFpuppeteer%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/04/21/%E6%9C%8D%E5%8A%A1%E7%AB%AFpuppeteer%E7%9A%84%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h2 id="æœåŠ¡ç«¯puppeteerçš„ä½¿ç”¨"><a href="#æœåŠ¡ç«¯puppeteerçš„ä½¿ç”¨" class="headerlink" title="æœåŠ¡ç«¯puppeteerçš„ä½¿ç”¨"></a>æœåŠ¡ç«¯puppeteerçš„ä½¿ç”¨</h2><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æœ€è¿‘çªç„¶ä½¿ç”¨åˆ°äº†<a href="https://github.com/puppeteer/puppeteer">puppeteer</a>ï¼ŒåŸæœ¬åœ¨æœ¬åœ°éƒ½æ˜¯å¥½å¥½çš„ï¼Œä½†æ˜¯å½“éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šä¹‹åå°±ä¸è¡Œäº†ã€‚  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>è™½ç„¶å…·ä½“åŸå› ä¸ç¡®å®šï¼Œä½†æ˜¯æ ¹æ®ç™¾åº¦çš„åšæ³•æœ€åä¸å†æŠ¥é”™ã€‚  </p><h3 id="å®‰è£…chrome"><a href="#å®‰è£…chrome" class="headerlink" title="å®‰è£…chrome"></a>å®‰è£…chrome</h3><ol><li>åˆ›å»ºæ–‡ä»¶<br><code>touch /etc/yum.repos.d/google.repo</code>  </li><li>é…ç½®å†…å®¹  </li></ol><p><code>vi /etc/yum.repos.d/google.repo</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[google]<br>name=Google-x86_64<br>baseurl=http://dl.google.com/linux/rpm/stable/x86_64<br>enabled=1<br>gpgcheck=0<br>gpgkey=https://dl-ssl.google.com/linux/linux_signing_key.pub<br></code></pre></td></tr></table></figure><ol start="3"><li><code>yum update</code>  </li><li><code>yum install google-chrome-stable</code>  </li></ol><h4 id="æ’ä¸ªé¢˜å¤–è¯"><a href="#æ’ä¸ªé¢˜å¤–è¯" class="headerlink" title="æ’ä¸ªé¢˜å¤–è¯"></a>æ’ä¸ªé¢˜å¤–è¯</h4><p>åœ¨å¼„è¿™ä¸ªä¸œè¥¿çš„æ—¶å€™çªç„¶ç¢°åˆ°äº†é˜¿é‡Œäº‘æœåŠ¡å™¨çš„<code>centos 8</code>æœåŠ¡å™¨æºå‘ç”Ÿå˜åŒ–ï¼Œ<code>yum</code>æ— æ³•ä¸‹è½½æ–°ä¸œè¥¿äº†<br>æ‰€ä»¥è¿™é‡Œä¹Ÿéšä¾¿è®°å½•ä¸€ä¸‹ï¼Œ<a href="https://blog.51cto.com/gagarin/5011005">æ¥æº</a></p><h3 id="ä¿®æ”¹puppeteerè°ƒç”¨æ–¹å¼"><a href="#ä¿®æ”¹puppeteerè°ƒç”¨æ–¹å¼" class="headerlink" title="ä¿®æ”¹puppeteerè°ƒç”¨æ–¹å¼"></a>ä¿®æ”¹<code>puppeteer</code>è°ƒç”¨æ–¹å¼</h3><p><code>puppeteer.launch(&#123; args: [&#39;--no-sandbox&#39;, &#39;--disable-dev-shm-usage&#39;], headless: true &#125;)</code></p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>åšä¸ªç®€å•è®°å½•ğŸ˜Š<br><a href="https://blog.csdn.net/Zeng__Yi/article/details/105661354">å‚è€ƒ</a></p>]]></content>
    
    
    <categories>
      
      <category>æœåŠ¡å™¨</category>
      
      <category>å‰ç«¯</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>backend node puppeteer</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœåŠ¡å™¨ä¸Šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤</title>
    <link href="/2022/04/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/"/>
    <url>/2022/04/21/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h2 id="æœåŠ¡å™¨ä¸Šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤"><a href="#æœåŠ¡å™¨ä¸Šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤" class="headerlink" title="æœåŠ¡å™¨ä¸Šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤"></a>æœåŠ¡å™¨ä¸Šç”¨åˆ°çš„ä¸€äº›å‘½ä»¤</h2><h3 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h3><p>è®°å½•ä¸€äº›å¹³å¸¸ç”¨åˆ°çš„ä¸€äº›å‘½ä»¤ï¼Œç»™è‡ªå·±æä¸ªé†’ã€‚  </p><h3 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h3><h4 id="ç«¯å£å ç”¨"><a href="#ç«¯å£å ç”¨" class="headerlink" title="ç«¯å£å ç”¨"></a>ç«¯å£å ç”¨</h4><p>å¹³å¸¸ç¢°åˆ°æœ‰å ç”¨ç«¯å£çš„æƒ…å†µï¼Œéœ€è¦æ€æ­»è¯¥è¿›ç¨‹ã€‚<br><code>sudo lsof -i -P -n</code> // æŸ¥çœ‹æ‰€æœ‰å ç”¨ç«¯å£<br><code>kill -9 pid</code>  æ€æ­»è¿›ç¨‹ï¼Œ<code>pid</code>æ˜¯å¯¹åº”ç«¯å£çš„id  </p><h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><p>ç»“æŸä½†æ˜¯æ²¡æœ‰å®Œå…¨ç»“æŸ  </p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
      <category>æœåŠ¡å™¨</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>deploy node backend</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å­—å·ä¸åƒç´ çš„å¯¹åº”å€¼</title>
    <link href="/2022/03/02/%E5%AD%97%E5%8F%B7%E4%B8%8E%E5%83%8F%E7%B4%A0%E7%9A%84%E5%AF%B9%E5%BA%94%E5%80%BC/"/>
    <url>/2022/03/02/%E5%AD%97%E5%8F%B7%E4%B8%8E%E5%83%8F%E7%B4%A0%E7%9A%84%E5%AF%B9%E5%BA%94%E5%80%BC/</url>
    
    <content type="html"><![CDATA[<p>å¹³å¸¸å¶å°”å¯èƒ½ä¼šç¢°åˆ°<code>px</code>å’Œ<code>word</code>çš„å­—å·çš„ç›¸äº’è½¬æ¢çš„æƒ…å†µï¼Œè¿™é‡Œä»ç½‘ä¸ŠæŠ„äº†ä¸‹ç®€å•åšä¸‹è®°å½•ã€‚</p><h2 id="å•ä½"><a href="#å•ä½" class="headerlink" title="å•ä½"></a>å•ä½</h2><h3 id="pt-pointï¼Œç£…"><a href="#pt-pointï¼Œç£…" class="headerlink" title="pt (pointï¼Œç£…)"></a>pt (pointï¼Œç£…)</h3><p>æ˜¯ä¸€ä¸ªç‰©ç†é•¿åº¦å•ä½ï¼ŒæŒ‡çš„æ˜¯ 72 åˆ†ä¹‹ä¸€è‹±å¯¸ã€‚</p><h3 id="px-pixelï¼Œåƒç´ "><a href="#px-pixelï¼Œåƒç´ " class="headerlink" title="px (pixelï¼Œåƒç´ )"></a>px (pixelï¼Œåƒç´ )</h3><p>æ˜¯ä¸€ä¸ªè™šæ‹Ÿé•¿åº¦å•ä½ï¼Œæ˜¯è®¡ç®—æœºç³»ç»Ÿçš„æ•°å­—åŒ–å›¾åƒé•¿åº¦å•ä½ï¼Œå¦‚æœ px è¦æ¢ç®—æˆç‰©ç†é•¿åº¦ï¼Œéœ€è¦æŒ‡å®šç²¾åº¦ DPI(Dots Per Inchï¼Œæ¯è‹±å¯¸åƒç´ æ•°)ï¼Œåœ¨æ‰«ææ‰“å°æ—¶ä¸€èˆ¬éƒ½æœ‰ DPI å¯é€‰ã€‚Windows ç³»ç»Ÿé»˜è®¤æ˜¯ 96dpiï¼ŒApple ç³»ç»Ÿé»˜è®¤æ˜¯ 72dpiã€‚</p><h3 id="em-ç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸"><a href="#em-ç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸" class="headerlink" title="em(ç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸)"></a>em(ç›¸å¯¹é•¿åº¦å•ä½ï¼Œç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸)</h3><p>æ˜¯ä¸€ä¸ªç›¸å¯¹é•¿åº¦å•ä½ï¼Œæœ€åˆæ˜¯æŒ‡å­—æ¯ M çš„å®½åº¦ï¼Œæ•…å emã€‚ç°æŒ‡çš„æ˜¯å­—ç¬¦å®½åº¦çš„å€æ•°ï¼Œç”¨æ³•ç±»ä¼¼ç™¾åˆ†æ¯”ï¼Œå¦‚ï¼š0.8em, 1.2em,2em ç­‰ã€‚é€šå¸¸ 1em=16pxã€‚</p><h2 id="æ¢ç®—"><a href="#æ¢ç®—" class="headerlink" title="æ¢ç®—"></a>æ¢ç®—</h2><ul><li>å­—å·ï¼šæ˜¯ä¸­æ–‡å­—åº“ä¸­ç‰¹æœ‰çš„ä¸€ç§å•ä½ï¼Œä»¥ä¸­æ–‡ä»£å·è¡¨ç¤ºç‰¹å®šçš„ç£…å€¼ ptï¼Œä¾¿äºè®°å¿†ã€è¡¨è¿°ã€‚<br>pt å’Œ px çš„æ¢ç®—å…¬å¼å¯ä»¥æ ¹æ® pt çš„å®šä¹‰å¾—å‡º:<br><code>px = 1/dpi(è‹±å¯¸)</code><br><code>pt = 1/72(è‹±å¯¸)</code><br><code>pt = px * dpi / 72</code><br>ä»¥ Windows ä¸‹çš„ <code>96dpi</code> æ¥è®¡ç®—ï¼Œ<code>1pt = px * 96/72 = px * 4/3</code></li></ul><h2 id="å¸¸ç”¨åˆ°çš„"><a href="#å¸¸ç”¨åˆ°çš„" class="headerlink" title="å¸¸ç”¨åˆ°çš„"></a>å¸¸ç”¨åˆ°çš„</h2><p>ç›´æ¥<a href="https://www.runoob.com/w3cnote/px-pt-em-convert-table.html">ç™¾åº¦</a></p><h2 id="å¼•ç”³"><a href="#å¼•ç”³" class="headerlink" title="å¼•ç”³"></a>å¼•ç”³</h2><h3 id="dpi-è®¡ç®—"><a href="#dpi-è®¡ç®—" class="headerlink" title="dpi è®¡ç®—"></a>dpi è®¡ç®—</h3><p>æ¥è‡ªç™¾åº¦ğŸ˜º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDPI</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">let</span> deviceXDPI = <span class="hljs-number">0</span> <br>  <span class="hljs-keyword">let</span> deviceYDPI = <span class="hljs-number">0</span>  <br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.screen.deviceXDPI != <span class="hljs-literal">undefined</span>) &#123;<br>    deviceXDPI = <span class="hljs-built_in">window</span>.screen.deviceXDPI;<br>    deviceYDPI = <span class="hljs-built_in">window</span>.screen.deviceYDPI;<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">const</span> tmpNode = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;div&#x27;</span>);<br>    tmpNode.style.cssText = <span class="hljs-string">`</span><br><span class="hljs-string">      width:1in;</span><br><span class="hljs-string">      height:1in;</span><br><span class="hljs-string">      position:absolute;</span><br><span class="hljs-string">      left:0px;</span><br><span class="hljs-string">      top:0px;</span><br><span class="hljs-string">      z-index:99;</span><br><span class="hljs-string">      visibility:hidden;</span><br><span class="hljs-string">    `</span><br>    <span class="hljs-built_in">document</span>.body.appendChild(tmpNode);<br>    deviceXDPI = <span class="hljs-built_in">parseInt</span>(tmpNode.offsetWidth);<br>    deviceYDPI = <span class="hljs-built_in">parseInt</span>(tmpNode.offsetHeight);<br>    tmpNode.parentNode.removeChild(tmpNode);<br>  &#125;<br>  <span class="hljs-keyword">return</span> [<br>    deviceXDPI,<br>    deviceYDPI<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µ</title>
    <link href="/2022/02/09/%E5%B9%B3%E6%97%B6%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/"/>
    <url>/2022/02/09/%E5%B9%B3%E6%97%B6%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5/</url>
    
    <content type="html"><![CDATA[<h2 id="å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µ"><a href="#å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µ" class="headerlink" title="å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µ"></a>å¹³æ—¶ç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µ</h2><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æ–°å¹´å¿«ä¹ğŸ¯ ğŸ†<br>è¿™é‡Œä»‹ç»çš„æ˜¯å¹³å¸¸å¯èƒ½ä¼šç”¨åˆ°çš„ä¸€äº›ä»£ç ç‰‡æ®µï¼Œå¯èƒ½å¯¹å„ä½æœ‰ç‚¹å¸®åŠ©ï¼Œæ–‡ç« ä¼šæŒç»­æ›´æ–°âœ¿âœ¿ãƒ½(Â°â–½Â°)ãƒâœ¿  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="Modal"><a href="#Modal" class="headerlink" title="Modal"></a>Modal</h3><ul><li><a href="https://ant.design/index-cn">antd</a>   </li><li>å†…éƒ¨æ§åˆ¶<code>visible</code>  </li><li>å¤–éƒ¨æ§åˆ¶æ˜¯å¦å¯å…³é—­  </li></ul><h4 id="typescript"><a href="#typescript" class="headerlink" title="typescript"></a>typescript</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> React, &#123; forwardRef, useImperativeHandle, useRef, useCallback, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> &#123; Modal, Button &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ModalProps &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd/es/modal&#x27;</span><br><br><span class="hljs-keyword">type</span> TModalRef = &#123;<br>  <span class="hljs-attr">open</span>: <span class="hljs-function">(<span class="hljs-params">value?: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span> <br>&#125;<br><br><span class="hljs-keyword">type</span> TModalProps = &#123;<br>  <span class="hljs-comment">// any props </span><br>&#125; &amp; Partial&lt;ModalProps&gt;<br><br><span class="hljs-comment">// modal </span><br><span class="hljs-keyword">const</span> InternalVisibleModal = forwardRef&lt;TModalRef, TModalProps&gt;(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> &#123;<br><br>  <span class="hljs-keyword">const</span> &#123;  <br>    <span class="hljs-attr">onCancel</span>: propsOnCancel,<br>    <span class="hljs-attr">onOk</span>: propsOnOk<br>  &#125; = props <br><br>  <span class="hljs-keyword">const</span> [ visible, setVisible ] = useState&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-literal">false</span>)<br><br>  <span class="hljs-keyword">const</span> open = useCallback(<span class="hljs-function">(<span class="hljs-params">value?: <span class="hljs-built_in">any</span></span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(value)<br>    setVisible(<span class="hljs-literal">true</span>)<br>  &#125;, [])<br><br>  <span class="hljs-keyword">const</span> onCancel = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = propsOnCancel?.(e)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> result !== <span class="hljs-string">&#x27;boolean&#x27;</span> || result) &#123;<br>      setVisible(<span class="hljs-literal">false</span>)<br>    &#125;<br>  &#125;, [propsOnCancel])<br><br>  <span class="hljs-keyword">const</span> onOk = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = propsOnOk?.(e)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> result !== <span class="hljs-string">&#x27;boolean&#x27;</span> || result) &#123;<br>      setVisible(<span class="hljs-literal">false</span>)<br>    &#125;<br>  &#125;, [propsOnOk])<br><br>  useImperativeHandle(ref, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      open<br>    &#125;<br>  &#125;, [open])<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">visible</span>=<span class="hljs-string">&#123;visible&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">onCancel</span>=<span class="hljs-string">&#123;onCancel&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">onOk</span>=<span class="hljs-string">&#123;onOk&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">title</span>=<span class="hljs-string">&#x27;è‡ªå®šä¹‰modal&#x27;</span></span></span><br><span class="hljs-tag"><span class="xml">    &gt;</span></span><br><span class="xml">      hello world </span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span><br>  )<br><br>&#125;)<br><br><span class="hljs-comment">// parent </span><br><span class="hljs-keyword">const</span> ParentComponent = <span class="hljs-function">() =&gt;</span> &#123;<br><br>  <span class="hljs-keyword">const</span> modalRef = useRef&lt;TModalRef&gt;(<span class="hljs-literal">null</span>)<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><br><span class="xml">        modalRef.current?.open()</span><br><span class="xml">      &#125;&#125;&gt;open<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">InternalVisibleModal</span></span></span><br><span class="hljs-tag"><span class="xml">        <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;modalRef&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      /&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/&gt;</span></span><br>  )<br><br>&#125;<br><br><br></code></pre></td></tr></table></figure><h4 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs jsx"><span class="hljs-keyword">import</span> React, &#123; forwardRef, useImperativeHandle, useRef, useCallback, useState &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span><br><span class="hljs-keyword">import</span> &#123; Modal, Button &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;antd&#x27;</span><br><br><span class="hljs-comment">// modal </span><br><span class="hljs-keyword">const</span> InternalVisibleModal = forwardRef(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> &#123;<br><br>  <span class="hljs-keyword">const</span> &#123;  <br>    <span class="hljs-attr">onCancel</span>: propsOnCancel,<br>    <span class="hljs-attr">onOk</span>: propsOnOk<br>  &#125; = props <br><br>  <span class="hljs-keyword">const</span> [ visible, setVisible ] = useState(<span class="hljs-literal">false</span>)<br><br>  <span class="hljs-keyword">const</span> open = useCallback(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(value)<br>    setVisible(<span class="hljs-literal">true</span>)<br>  &#125;, [])<br><br>  <span class="hljs-keyword">const</span> onCancel = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = propsOnCancel?.(e)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> result !== <span class="hljs-string">&#x27;boolean&#x27;</span> || result) &#123;<br>      setVisible(<span class="hljs-literal">false</span>)<br>    &#125;<br>  &#125;, [propsOnCancel])<br><br>  <span class="hljs-keyword">const</span> onOk = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = propsOnOk?.(e)<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> result !== <span class="hljs-string">&#x27;boolean&#x27;</span> || result) &#123;<br>      setVisible(<span class="hljs-literal">false</span>)<br>    &#125;<br>  &#125;, [propsOnOk])<br><br>  useImperativeHandle(ref, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      open<br>    &#125;<br>  &#125;, [open])<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Modal</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">visible</span>=<span class="hljs-string">&#123;visible&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">onCancel</span>=<span class="hljs-string">&#123;onCancel&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">onOk</span>=<span class="hljs-string">&#123;onOk&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      <span class="hljs-attr">title</span>=<span class="hljs-string">&#x27;è‡ªå®šä¹‰modal&#x27;</span></span></span><br><span class="hljs-tag"><span class="xml">    &gt;</span></span><br><span class="xml">      hello world </span><br><span class="xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span></span><br>  )<br><br>&#125;)<br><br><span class="hljs-comment">// parent </span><br><span class="hljs-keyword">const</span> ParentComponent = <span class="hljs-function">() =&gt;</span> &#123;<br><br>  <span class="hljs-keyword">const</span> modalRef = useRef(<span class="hljs-literal">null</span>)<br><br>  <span class="hljs-keyword">return</span> (<br>    <span class="xml"><span class="hljs-tag">&lt;&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">&#123;()</span> =&gt;</span> &#123;</span><br><span class="xml">        modalRef.current?.open()</span><br><span class="xml">      &#125;&#125;&gt;open<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span><br><span class="xml">      <span class="hljs-tag">&lt;<span class="hljs-name">InternalVisibleModal</span></span></span><br><span class="hljs-tag"><span class="xml">        <span class="hljs-attr">ref</span>=<span class="hljs-string">&#123;modalRef&#125;</span></span></span><br><span class="hljs-tag"><span class="xml">      /&gt;</span></span><br><span class="xml">    <span class="hljs-tag">&lt;/&gt;</span></span><br>  )<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="html2canvas"><a href="#html2canvas" class="headerlink" title="html2canvas"></a>html2canvas</h3><ul><li>é…åˆ<a href="https://github.com/niklasvh/html2canvas">html2canvas</a>   </li><li><code>html</code>è½¬<code>å›¾ç‰‡</code>  <h4 id="typescript-1"><a href="#typescript-1" class="headerlink" title="typescript"></a>typescript</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> html2canvas, &#123; Options &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;html2canvas&#x27;</span>;<br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">captureCover</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">  query: <span class="hljs-built_in">string</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">  html2canvasOptions: Partial&lt;Options&gt; = &#123;&#125;,</span></span><br><span class="hljs-params"><span class="hljs-function"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> element: HTMLElement | <span class="hljs-literal">null</span> = <span class="hljs-built_in">document</span>.querySelector(query);<br><br>  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject();<br><br>  <span class="hljs-keyword">const</span> &#123; width, height &#125; = element.getBoundingClientRect() || &#123;&#125;;<br><br>  <span class="hljs-keyword">const</span> options: Partial&lt;Options&gt; = &#123;<br>    <span class="hljs-attr">useCORS</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">allowTaint</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">logging</span>: <span class="hljs-literal">true</span>,<br>    width,<br>    height,<br>    <span class="hljs-attr">scrollY</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">scrollX</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;rgba(0, 0, 0, 0)&#x27;</span>,<br>    ...html2canvasOptions,<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>&lt;Blob&gt;(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    html2canvas(element <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>, options).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context</span>) </span>&#123;<br>      context.toBlob(<br>        <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>          <span class="hljs-keyword">if</span> (data) &#123;<br>            resolve(data);<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            reject();<br>          &#125;<br>        &#125;,<br>        <span class="hljs-string">&#x27;image/png&#x27;</span>,<br>        <span class="hljs-number">0.9</span>,<br>      );<br>    &#125;);<br>  &#125;);<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="javascript-1"><a href="#javascript-1" class="headerlink" title="javascript"></a>javascript</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> html2canvas <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;html2canvas&#x27;</span>;<br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">captureCover</span>(<span class="hljs-params"></span></span><br><span class="hljs-params"><span class="hljs-function">  query,</span></span><br><span class="hljs-params"><span class="hljs-function">  html2canvasOptions</span></span><br><span class="hljs-params"><span class="hljs-function"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(query);<br><br>  <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject();<br><br>  <span class="hljs-keyword">const</span> &#123; width, height &#125; = element.getBoundingClientRect() || &#123;&#125;;<br><br>  <span class="hljs-keyword">const</span> options = &#123;<br>    <span class="hljs-attr">useCORS</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">allowTaint</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">logging</span>: <span class="hljs-literal">true</span>,<br>    width,<br>    height,<br>    <span class="hljs-attr">scrollY</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">scrollX</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&#x27;rgba(0, 0, 0, 0)&#x27;</span>,<br>    ...html2canvasOptions,<br>  &#125;;<br><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    html2canvas(element, options).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context</span>) </span>&#123;<br>      context.toBlob(<br>        <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>          <span class="hljs-keyword">if</span> (data) &#123;<br>            resolve(data);<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            reject();<br>          &#125;<br>        &#125;,<br>        <span class="hljs-string">&#x27;image/png&#x27;</span>,<br>        <span class="hljs-number">0.9</span>,<br>      );<br>    &#125;);<br>  &#125;);<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="jspdf"><a href="#jspdf" class="headerlink" title="jspdf"></a>jspdf</h3><ul><li>é…åˆ<a href="https://github.com/niklasvh/html2canvas">html2canvas</a>  </li><li><code>html</code>è½¬<code>pdf</code>  <h4 id="typescript-2"><a href="#typescript-2" class="headerlink" title="typescript"></a>typescript</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> jsPDF <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;jspdf&#x27;</span><br><span class="hljs-keyword">import</span> html2Canvas, &#123; Options &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;html2canvas&#x27;</span><br><br><span class="hljs-keyword">const</span> A4_RATIO = <span class="hljs-number">630</span> / <span class="hljs-number">891</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> html2Pdf = <span class="hljs-keyword">async</span> (query: <span class="hljs-built_in">string</span>, <span class="hljs-attr">canvasOpts</span>: Partial&lt;Options&gt;=&#123;&#125;) =&gt; &#123;<br><br>  <span class="hljs-keyword">const</span> element: HTMLElement | <span class="hljs-literal">null</span> = <span class="hljs-built_in">document</span>.querySelector(query)<br><br>  <span class="hljs-keyword">if</span>(!element) <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject()<br><br>  <span class="hljs-keyword">const</span> originWidth = element.offsetWidth<br>  <span class="hljs-keyword">const</span> originHeight = element.offsetHeight<br><br>  <span class="hljs-keyword">const</span> scale = <span class="hljs-number">595.28</span> / originWidth<br>  <span class="hljs-keyword">const</span> scaleCanvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">&#x27;canvas&#x27;</span>)<br>  scaleCanvas.width = <span class="hljs-number">595.28</span><br>  scaleCanvas.height = originHeight * scale <br><br>  <span class="hljs-keyword">var</span> opts: Partial&lt;Options&gt; = &#123;<br>    <span class="hljs-attr">useCORS</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">allowTaint</span>: <span class="hljs-literal">true</span>,<span class="hljs-comment">//å…è®¸è·¨åŸŸå›¾ç‰‡</span><br>    <span class="hljs-attr">logging</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">width</span>: originWidth, <br>    <span class="hljs-attr">height</span>: originHeight,<br>    <span class="hljs-attr">scrollY</span>: <span class="hljs-number">0</span>, <br>    <span class="hljs-attr">scrollX</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">canvas</span>: scaleCanvas,<br>    scale,<br>    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">&quot;rgba(0, 0, 0, 0)&quot;</span>,<br>    <span class="hljs-attr">onclone</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">document</span></span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">const</span> deleteStyleKeys = [<span class="hljs-string">&#x27;transform&#x27;</span>, <span class="hljs-string">&#x27;transition&#x27;</span>, <span class="hljs-string">&#x27;boxShadow&#x27;</span>]<br>      <span class="hljs-keyword">const</span> element: HTMLElement | <span class="hljs-literal">null</span> = <span class="hljs-built_in">document</span>.querySelector(query)<br>      <span class="hljs-keyword">if</span>(!element) <span class="hljs-keyword">return</span> <br>      deleteStyleKeys.forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> ((element.style <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[key] = <span class="hljs-string">&#x27;&#x27;</span>))<br>    &#125;,<br>    ...canvasOpts<br>  &#125;;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    html2Canvas(element, opts).then(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">context</span>) </span>&#123;<br>  <br>      <span class="hljs-keyword">let</span> contentWidth = context.width <br>      <span class="hljs-keyword">let</span> contentHeight = context.height   <br>      <span class="hljs-keyword">let</span> pageHeight = contentWidth / A4_RATIO  <br>      <span class="hljs-keyword">let</span> leftHeight = contentHeight <br>      <span class="hljs-keyword">let</span> position = <span class="hljs-number">0</span><br>  <br>      <span class="hljs-keyword">let</span> pageData = context.toDataURL(<span class="hljs-string">&#x27;image/png&#x27;</span>, <span class="hljs-number">0.9</span>)<br>      <br>      <span class="hljs-keyword">let</span> PDF = <span class="hljs-keyword">new</span> jsPDF(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;pt&#x27;</span>, <span class="hljs-string">&#x27;a4&#x27;</span>)<br>      <span class="hljs-keyword">if</span> (leftHeight &lt;= pageHeight) &#123;<br>        PDF.addImage(pageData, <span class="hljs-string">&#x27;PNG&#x27;</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, contentWidth, contentHeight)<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">while</span> (leftHeight &gt;= <span class="hljs-number">20</span>) &#123;<br>          PDF.addImage(pageData, <span class="hljs-string">&#x27;PNG&#x27;</span>, <span class="hljs-number">0</span>, position, contentWidth, contentHeight)<br>          leftHeight -= pageHeight<br>          position -= pageHeight<br>          <span class="hljs-keyword">if</span> (leftHeight &gt;= <span class="hljs-number">20</span>) &#123;<br>            PDF.addPage()<br>          &#125;<br>        &#125;<br>      &#125;<br><br>      resolve(PDF.output(<span class="hljs-string">&#x27;blob&#x27;</span>))<br>      <br>    &#125;)<br>  &#125;)<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="SuperPartial"><a href="#SuperPartial" class="headerlink" title="SuperPartial"></a>SuperPartial</h3><ul><li><code>typescript</code></li><li><code>Partial</code> æ·±å±‚æ¬¡ç‰ˆæœ¬  <h4 id="typescript-3"><a href="#typescript-3" class="headerlink" title="typescript"></a>typescript</h4><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">type</span> SuperPartial&lt;T&gt; = &#123;<br>  [K <span class="hljs-keyword">in</span> keyof T]?: SuperPartial&lt;T[K]&gt;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="withTry"><a href="#withTry" class="headerlink" title="withTry"></a>withTry</h3><ul><li>å·¥å…·æ–¹æ³•  </li><li>å¼‚æ­¥é”™è¯¯æ•è·  <h4 id="typescript-4"><a href="#typescript-4" class="headerlink" title="typescript"></a>typescript</h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withTry</span>&lt;<span class="hljs-title">T</span>=<span class="hljs-title">any</span>&gt; (<span class="hljs-params">func: <span class="hljs-built_in">Function</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...args: <span class="hljs-built_in">any</span>[]</span>): <span class="hljs-title">Promise</span>&lt;[<span class="hljs-title">any</span>, <span class="hljs-title">T</span> | <span class="hljs-title">null</span>]&gt; </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> func(...args)<br>      <span class="hljs-keyword">return</span> [<span class="hljs-literal">null</span>, data]<br>    &#125;<span class="hljs-keyword">catch</span>(err) &#123;<br>      <span class="hljs-keyword">return</span> [err, <span class="hljs-literal">null</span>]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="javascript-2"><a href="#javascript-2" class="headerlink" title="javascript"></a>javascript</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withTry</span> (<span class="hljs-params">func</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">...args</span>) </span>&#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> func(...args)<br>      <span class="hljs-keyword">return</span> [<span class="hljs-literal">null</span>, data]<br>    &#125;<span class="hljs-keyword">catch</span>(err) &#123;<br>      <span class="hljs-keyword">return</span> [err, <span class="hljs-literal">null</span>]<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="sleep"><a href="#sleep" class="headerlink" title="sleep"></a>sleep</h3><ul><li>å»¶è¿Ÿæ–¹æ³•  <h4 id="javascript-3"><a href="#javascript-3" class="headerlink" title="javascript"></a>javascript</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sleep</span>(<span class="hljs-params">time=<span class="hljs-number">1000</span></span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time))<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>åˆ°è¿™é‡Œç»“æŸï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ã€‚  </p>]]></content>
    
    
    <categories>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>fragment code</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ </title>
    <link href="/2021/11/24/%E6%96%87%E4%BB%B6%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0/"/>
    <url>/2021/11/24/%E6%96%87%E4%BB%B6%E5%88%86%E7%89%87%E4%B8%8A%E4%BC%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰ç«¯æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ æµç¨‹"><a href="#å‰ç«¯æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ æµç¨‹" class="headerlink" title="å‰ç«¯æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ æµç¨‹"></a>å‰ç«¯æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ æµç¨‹</h2><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯ï¼Œå¹³å¸¸å·¥ä½œä¸­è‚¯å®šç¦»ä¸å¼€æ–‡ä»¶ä¸Šä¼ çš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¯èƒ½å¤§éƒ¨åˆ†æƒ…å†µéƒ½æ˜¯å¯¹å›¾ç‰‡ï¼Œé™„ä»¶ç­‰ä¸€äº›å°æ–‡ä»¶è¿›è¡Œä¸Šä¼ ï¼Œä½†æ˜¯å½“éœ€è¦ä¸Šä¼ å¤§æ–‡ä»¶çš„æ—¶å€™ï¼Œä½¿ç”¨æ™®é€šä¸Šä¼ æ–¹å¼æ—¶ï¼Œå¯èƒ½å°±ä¼šçœ‹åˆ°æ¥å£è¿”å›<code>413</code>ï¼Œè¿™é‡Œå°±éœ€è¦æåˆ°æœ¬æ–‡æ‰€è¦è¯´çš„æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ã€‚    </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="äºŒè¿›åˆ¶æ•°æ®ç±»å‹"><a href="#äºŒè¿›åˆ¶æ•°æ®ç±»å‹" class="headerlink" title="äºŒè¿›åˆ¶æ•°æ®ç±»å‹"></a>äºŒè¿›åˆ¶æ•°æ®ç±»å‹</h3><p>å‰ç«¯å¯¹äºŒè¿›åˆ¶æ•°æ®çš„å­˜å‚¨æ ¼å¼æœ‰å¾ˆå¤šç§ã€‚  </p><ul><li><code>input</code>è¾“å…¥æ¡†ä¸Šä¼ æ–‡ä»¶æ—¶ç”¨åˆ°çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/File">File</a>ç±»å‹ã€‚ </li><li>è§†é¢‘ç½‘ç«™ä¸Šèƒ½çœ‹åˆ°çš„<code>blob</code>é“¾æ¥èµ„æº  </li><li><code>es6</code>ä¸­å‡ºç°çš„<code>ArrayBuffer</code>ï¼Œå¹¶ä¸”æ˜¯æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ï¼Œæ–­ç‚¹ç»­ä¼ çš„åŸºç¡€ã€‚   </li><li>è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯<code>base64</code>  </li></ul><h3 id="ä¸åŒç±»å‹çš„ç›¸äº’è½¬æ¢"><a href="#ä¸åŒç±»å‹çš„ç›¸äº’è½¬æ¢" class="headerlink" title="ä¸åŒç±»å‹çš„ç›¸äº’è½¬æ¢"></a>ä¸åŒç±»å‹çš„ç›¸äº’è½¬æ¢</h3><p>å¾ˆå¤šæ•°æ®ç±»å‹çš„è½¬æ¢éƒ½éœ€è¦ä¾é äº<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader">FileReader</a>  </p><ol><li><code>ArrayBuffer to Blob</code>  </li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> Blob([<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>)])  <br><span class="hljs-keyword">const</span> fileReader = <span class="hljs-keyword">new</span> FileReader()<br><br>fileReader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(fileReader.result)<br>&#125;<br><br>fileReader.readAsArrayBuffer(blob)<br><br></code></pre></td></tr></table></figure><ol start="2"><li><code>Blob to Base64</code>  </li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> blob = <span class="hljs-keyword">new</span> Blob([<span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>(<span class="hljs-number">1024</span>)])  <br><span class="hljs-keyword">const</span> fileReader = <span class="hljs-keyword">new</span> FileReader()<br><br>fileReader.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(fileReader.result)<br>&#125;<br><br>fileReader.readAsDataURL(blob)<br></code></pre></td></tr></table></figure><p>ä»¥ä¸Šæ˜¯ä¸¤ä¸ªç®€å•çš„æ•°æ®ç±»å‹è½¬æ¢çš„ä¾‹å­   </p><h3 id="éœ€è¦ä½¿ç”¨åˆ°çš„npm-package"><a href="#éœ€è¦ä½¿ç”¨åˆ°çš„npm-package" class="headerlink" title="éœ€è¦ä½¿ç”¨åˆ°çš„npm package"></a>éœ€è¦ä½¿ç”¨åˆ°çš„npm package</h3><ul><li><code>spark-md5</code><br><a href="https://www.npmjs.com/package/spark-md5">spark-md5</a>å¯ä»¥å°†å¯¹åº”çš„æ•°æ®è¿›è¡Œ<code>md5</code>åŠ å¯†ï¼Œè¿™æ ·åœ¨ä¸‹ä¸€æ¬¡å¯¹åŒä¸€ä¸ªæ–‡ä»¶è¿›è¡Œä¸Šä¼ æ—¶ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡æ•´ä¸ªä¸Šä¼ æµä¼ ï¼Œå®ç°ç§’ä¼ çš„æ•ˆæœã€‚  </li></ul><h3 id="å…·ä½“æµç¨‹"><a href="#å…·ä½“æµç¨‹" class="headerlink" title="å…·ä½“æµç¨‹"></a>å…·ä½“æµç¨‹</h3><ul><li><p><code>input</code>æ¥æ”¶æ–‡ä»¶<code>template.mp4</code>  </p></li><li><p>è·å–æ–‡ä»¶çš„åŸºç¡€ä¿¡æ¯  </p><ul><li>æ–‡ä»¶çš„<code>mime</code>ï¼Œå½“å‰çš„ç±»å‹æ˜¯<code>video/mp4</code>  </li><li>æ–‡ä»¶çš„å¤§å°<code>file.size</code>ï¼Œå‡è®¾æœ¬æ¬¡æ–‡ä»¶çš„å¤§å°ä¸º<code>1G</code>  </li><li>è®¾ç½®æœ¬æ¬¡ä¸Šä¼ åˆ†ç‰‡çš„å¤§å°ä¸º<code>5M</code>  </li><li>è®¡ç®—æœ¬æ¬¡ä¸Šä¼ çš„åˆ†ç‰‡æ•°é‡ä¸º<code>1G / 5M = 205</code>ï¼Œæ‰€ä»¥æœ¬æ¬¡éœ€è¦ä¸Šä¼ 205æ¬¡  </li></ul></li><li><p>å¯¹æ–‡ä»¶è¿›è¡Œåˆ†ç‰‡  </p><ul><li>ä½¿ç”¨<code>spark-md5</code>è¿›è¡Œåˆ†ç‰‡  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; <span class="hljs-built_in">ArrayBuffer</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;spark-md5&#x27;</span><br><br><span class="hljs-keyword">const</span> SparkMd5 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">ArrayBuffer</span>()<br><br><span class="hljs-comment">// ä¿å­˜åˆ†ç‰‡ç”¨äºåœ¨åé¢ä¸Šä¼ æ—¶ç”¨  </span><br><span class="hljs-keyword">const</span> cacheChunks = []<br><span class="hljs-comment">// å½“å‰åˆ†ç‰‡çš„ç´¢å¼•</span><br><span class="hljs-keyword">const</span> index = <span class="hljs-number">0</span><br><span class="hljs-comment">// åˆ†ç‰‡çš„å¤§å°</span><br><span class="hljs-keyword">const</span> chunkSize = <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">5</span> <br><span class="hljs-comment">// file åªéœ€è¦ç®€å•è°ƒç”¨ file.slice å°±å¯ä»¥</span><br><span class="hljs-keyword">const</span> currentChunk = file.slice(index * chunkSize, (index + <span class="hljs-number">1</span>) * chunkSize)  <br><br>cacheChunks.push(currentChunk)<br><br><span class="hljs-comment">// æ·»åŠ åˆ†ç‰‡  </span><br>SparkMd5.append(currentChunk)<br><br><span class="hljs-comment">// æ‰€æœ‰åˆ†ç‰‡æ·»åŠ å®Œæˆæ—¶  </span><br><span class="hljs-keyword">const</span> md5 = SparkMd5.end()<br><br><span class="hljs-comment">// å®Œæˆè§£æåé”€æ¯å¯¹åº”å®ä¾‹  </span><br>SparkMd5.destroy()<br><br></code></pre></td></tr></table></figure></li></ul></li><li><p>æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥<br>å°†æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ä¼ é€’ç»™åå°ï¼ŒæœåŠ¡ç«¯æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ã€‚<br>å¦‚æœå­˜åœ¨ï¼Œåˆ™è·³è¿‡ä¹‹åçš„ä¸Šä¼ è¿‡ç¨‹ã€‚<br>å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­åé¢çš„ä¸Šä¼ æµç¨‹ã€‚  </p></li><li><p>æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ <br>æŒ‰ç…§ç´¢å¼•é¡ºåºå¯¹æ–‡ä»¶åˆ†ç‰‡è¿›è¡Œä¸Šä¼   </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><br><span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData()<br><span class="hljs-comment">// éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶åˆ†ç‰‡</span><br>formData.append(<span class="hljs-string">&quot;file&quot;</span>, chunk)<br><span class="hljs-comment">// å½“å‰åˆ†ç‰‡çš„ç´¢å¼•  </span><br>formData.append(<span class="hljs-string">&quot;index&quot;</span>, index)<br><span class="hljs-comment">// æ–‡ä»¶md5 </span><br>formData.append(<span class="hljs-string">&quot;md5&quot;</span>, md5)<br><br>axios.post(<span class="hljs-string">&quot;/path/to/upload&quot;</span>, formData)<br><br></code></pre></td></tr></table></figure><p>åç«¯é€šè¿‡è¿”å›ä¸‹ä¸€åˆ†ç‰‡çš„ç´¢å¼•æˆ–è€…æ˜¯ä¸‹ä¸€åˆ†ç‰‡çš„èŒƒå›´æ¥æŒ‡å®šå‰ç«¯æ¥ä¸‹æ¥éœ€è¦ä¸Šä¼ çš„åˆ†ç‰‡<br>åœ¨ä¸Šä¸€æ­¥éª¤ä¸­ä¹Ÿå¯ä»¥è¿”å›å’Œè¿™ä¸€æ­¥éª¤ç›¸åŒçš„å†…å®¹ã€‚  </p></li><li><p>æ–‡ä»¶ä¸Šä¼ å®Œæˆé€šçŸ¥<br>è¿™ä¸€æ­¥éª¤ä¸ºå¯é€‰æ­¥éª¤ï¼Œé€šè¿‡å‰ç«¯é€šçŸ¥åç«¯å®Œæˆäº†æ‰€æœ‰æ–‡ä»¶åˆ†ç‰‡çš„ä¸Šä¼ ã€‚<br>ä¸€èˆ¬ä¸éœ€è¦å‰ç«¯ä¸»åŠ¨å‘åç«¯é€šçŸ¥ã€‚  </p></li></ul><h3 id="åç«¯å®ç°"><a href="#åç«¯å®ç°" class="headerlink" title="åç«¯å®ç°"></a>åç«¯å®ç°</h3><p>è¿™é‡Œç®€å•ä½¿ç”¨<code>node</code>è®²è§£ä¸€ä¸‹åç«¯æ¥æ”¶æ–‡ä»¶çš„åŸºæœ¬é€»è¾‘<br>ä½¿ç”¨<code>koa</code>åšåŸºç¡€æœåŠ¡<br>ä½¿ç”¨<code>koa-body</code>æ¥æ”¶å‰ç«¯çš„æ–‡ä»¶å†…å®¹<br>ä½¿ç”¨<code>koa-router</code>åšå¯¹åº”çš„restfulè®¾è®¡  </p><ol><li><p>æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">let</span> fileCache = &#123;&#125;<br><br>router<br>.get(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-keyword">async</span> (ctx) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> &#123; md5, chunkSize, filename, size, length &#125; = ctx.query <br>  <span class="hljs-keyword">if</span>(fileCache[md5] &amp;&amp; fileCache[md5].chunks.length === length) &#123;<br>    ctx.body = &#123;<br>      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">res</span>: &#123;<br>        <span class="hljs-attr">data</span>: <span class="hljs-literal">true</span> <br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span><br>  &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(fileCache[md5]) &#123;<br>    <span class="hljs-keyword">const</span> index = findLastUnUploadChunkIndex()<br>    ctx.body = &#123;<br>      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">res</span>: &#123;<br>        <span class="hljs-attr">data</span>: index<br>      &#125;<br>    &#125;<br>  &#125;<span class="hljs-keyword">else</span> &#123;<br>    fileCache[md5] = &#123;<br>      <span class="hljs-attr">chunks</span>: [],<br>      size,<br>      length,<br>      chunkSize,<br>      md5<br>    &#125;<br>    ctx.body = &#123;<br>      <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">res</span>: &#123;<br>        <span class="hljs-attr">data</span>: <span class="hljs-number">0</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶ä¸Šä¼   </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">router.post(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-keyword">async</span> (ctx) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> files = ctx.request.files.file <br>  <span class="hljs-keyword">const</span> &#123; md5, index &#125; = ctx.request.body <br>  fileCache[md5].chunks.push(index) <br>  <span class="hljs-comment">// ä½¿ç”¨fsä¿å­˜å¯¹åº”çš„åˆ†ç‰‡è‡³æŒ‡å®šæ–‡ä»¶å¤¹</span><br>  <span class="hljs-comment">// åˆ†ç‰‡åç§°å¯ä»¥ä½¿ç”¨md5-indexçš„å½¢å¼</span><br>&#125;)<br></code></pre></td></tr></table></figure></li><li><p>æ–‡ä»¶åˆå¹¶  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>)<br><span class="hljs-keyword">const</span> fsPromise = fs.promises  <br><br><span class="hljs-comment">// åˆå¹¶åˆ†ç‰‡</span><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mergeChunk</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> realFilePath = <span class="hljs-string">&quot;/path/to/real/file&quot;</span><br><br>  <span class="hljs-comment">// è·å–å¯¹åº”çš„æ–‡ä»¶åˆ†ç‰‡æ–‡ä»¶åç§°  </span><br>  <span class="hljs-keyword">const</span> chunkList = <span class="hljs-keyword">await</span> fsPromise.readdir(<span class="hljs-string">&quot;/path/to/chunk&quot;</span>)  <br><br>  <span class="hljs-comment">// å¯¹æ–‡ä»¶è¿›è¡Œæ’åº  </span><br>  chunkList.sort(<span class="hljs-function">(<span class="hljs-params">suffixA, suffixB</span>) =&gt;</span> <span class="hljs-built_in">Number</span>(suffixA.split(<span class="hljs-string">&#x27;-&#x27;</span>)[<span class="hljs-number">1</span>]) - <span class="hljs-built_in">Number</span>(suffixB.split(<span class="hljs-string">&#x27;-&#x27;</span>)[<span class="hljs-number">1</span>]))<br>  <br>  <span class="hljs-comment">//æ–‡ä»¶åˆå¹¶</span><br>  <span class="hljs-keyword">const</span> mergeTasks = <span class="hljs-keyword">async</span> () =&gt; &#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; chunkList.length; i ++) &#123;<br>      <span class="hljs-keyword">const</span> chunk = chunkList[i]<br>      <span class="hljs-keyword">await</span> fs.readFile(chunk)<br>      .then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> fs.appendFile(realFilePath, data))<br>      .then(<span class="hljs-function"><span class="hljs-params">_</span> =&gt;</span> fs.unlink(chunk))<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> fs.writeFile(realFilePath, <span class="hljs-string">&#x27;&#x27;</span>)<br>  .then(mergeTasks)<br>  .catch(<span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;&#125;)<br>&#125;<br><br></code></pre></td></tr></table></figure></li></ol><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>ä»¥ä¸Šå°±æ˜¯æ•´ä¸ªæ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ çš„æµç¨‹ï¼Œå½“ä¸­çš„å…·ä½“ç»†èŠ‚å¯ä»¥æŸ¥çœ‹æœ¬äººå®Œæˆçš„å¯¹åº”çš„<a href="https://food-billboard.github.io/chunk-file-load/#/">ä¸Šä¼ å·¥å…·ç±»åº“</a>ï¼Œè¿˜æœ‰åŸºäºè¯¥ç±»åº“å°è£…çš„<code>React</code><a href="https://food-billboard.github.io/chunk-file-load-component/#/">ä¸Šä¼ ç»„ä»¶</a>  </p>]]></content>
    
    
    <categories>
      
      <category>æ–‡ä»¶</category>
      
      <category>ä¸Šä¼ </category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>upload file chunk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gitmoji ä¼˜é›…æäº¤ä»£ç </title>
    <link href="/2021/11/19/gitmoji/"/>
    <url>/2021/11/19/gitmoji/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ç›¸ä¿¡å¹³æ—¶åº”è¯¥å¤§å®¶éƒ½ç”¨è¿‡<code>github</code>å½“åšä»£ç ä»“åº“ï¼Œä½œä¸ºä¸€ä¸ªä¼˜è´¨çš„ä»“åº“ï¼Œå¯¹äºä»£ç çš„æäº¤ä¹Ÿæœ‰å¯¹åº”çš„è§„èŒƒï¼Œä¸ºäº†è®©æäº¤çœ‹å¾—æ›´æµ…æ˜¾æ˜“æ‡‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å›¾æ ‡æ¥è¡¨ç¤ºä¸ä¸€æ ·çš„æ„æ€ï¼Œè¿™é‡Œå°±ä»‹ç»ä¸€ä¸ªæäº¤å·¥å…·<a href="https://gitmoji.dev/">gitmoji</a>ã€‚</p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>å…³äºè¿™ä¸ªåº“çš„ä½¿ç”¨ç›¸ä¿¡å®˜ç½‘å·²ç»æè¿°çš„éå¸¸è¯¦ç»†äº†ï¼Œè¿™é‡Œå°±ç®€å•åšä¸‹ç¿»è¯‘æ¥ä¾›è‡ªå·±æŸ¥çœ‹ã€‚  </p><p>å¸¸ç”¨çš„å‡ ä¸ª  </p><table><thead><tr><th>å›¾æ ‡</th><th>ä»£ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>ğŸ¨</td><td>:art:</td><td>æ”¹è¿›ä»£ç çš„ç»“æ„/æ ¼å¼ã€‚</td></tr><tr><td>ğŸ”¥</td><td>:fire:</td><td>åˆ é™¤ä»£ç æˆ–æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ›</td><td>:bug:</td><td>ä¿®å¤ä¸€ä¸ªé”™è¯¯ã€‚</td></tr><tr><td>âœ¨</td><td>:sparkles:</td><td>ä»‹ç»æ–°åŠŸèƒ½ã€‚</td></tr><tr><td>âœ…</td><td>:white_check_mark:</td><td>æ·»åŠ ã€æ›´æ–°æˆ–é€šè¿‡æµ‹è¯•ã€‚</td></tr><tr><td>ğŸš€</td><td>:rocket:</td><td>ä»£ç éƒ¨ç½²ã€‚</td></tr><tr><td>ğŸ’„</td><td>:lipstick:</td><td>æ·»åŠ æˆ–æ›´æ–° UI å’Œæ ·å¼æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ”’ï¸</td><td>:lock:</td><td>ä¿®å¤å®‰å…¨é—®é¢˜ã€‚</td></tr><tr><td>ğŸ”–</td><td>:bookmark:</td><td>å‘å¸ƒ/ç‰ˆæœ¬æ ‡ç­¾ã€‚</td></tr><tr><td>ğŸ”§</td><td>:wrench:</td><td>æ·»åŠ æˆ–æ›´æ–°é…ç½®æ–‡ä»¶ã€‚</td></tr><tr><td>âªï¸</td><td>:rewind:</td><td>è¿˜åŸæ›´æ”¹ã€‚</td></tr><tr><td>ğŸ¤¡</td><td>:clown_face:</td><td>mock ä»£ç </td></tr><tr><td>ğŸ™ˆ</td><td>:see_no_evil:</td><td>æ·»åŠ æˆ–æ›´æ–° .gitignore æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ—‘ï¸</td><td>:wastebasket:</td><td>å¼ƒç”¨éœ€è¦æ¸…ç†çš„ä»£ç ã€‚</td></tr><tr><td>âš°ï¸</td><td>:coffin:</td><td>åˆ é™¤æ­»ä»£ç ã€‚</td></tr><tr><td>ğŸ§ª</td><td>:test_tube:</td><td>æ·»åŠ å¤±è´¥çš„æµ‹è¯•ã€‚</td></tr><tr><td>ğŸ‘”</td><td>:necktie:</td><td>æ·»åŠ æˆ–æ›´æ–°ä¸šåŠ¡é€»è¾‘</td></tr></tbody></table><p>ç´¢å¼•  </p><table><thead><tr><th>å›¾æ ‡</th><th>ä»£ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>ğŸ¨</td><td>:art:</td><td>æ”¹è¿›ä»£ç çš„ç»“æ„/æ ¼å¼ã€‚</td></tr><tr><td>âš¡ï¸</td><td>:zap:</td><td>æé«˜æ€§èƒ½ã€‚</td></tr><tr><td>ğŸ”¥</td><td>:fire:</td><td>åˆ é™¤ä»£ç æˆ–æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ›</td><td>:bug:</td><td>ä¿®å¤ä¸€ä¸ªé”™è¯¯ã€‚</td></tr><tr><td>ğŸš‘ï¸</td><td>:ambulance:</td><td>å…³é”®ä¿®è¡¥ç¨‹åºã€‚</td></tr><tr><td>âœ¨</td><td>:sparkles:</td><td>ä»‹ç»æ–°åŠŸèƒ½ã€‚</td></tr><tr><td>ğŸ“</td><td>:memo:</td><td>æ·»åŠ æˆ–æ›´æ–°æ–‡æ¡£ã€‚</td></tr><tr><td>ğŸš€</td><td>:rocket:</td><td>ä»£ç éƒ¨ç½²ã€‚</td></tr><tr><td>ğŸ’„</td><td>:lipstick:</td><td>æ·»åŠ æˆ–æ›´æ–° UI å’Œæ ·å¼æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ‰</td><td>:tada:</td><td>é¡¹ç›®åˆ›å»º</td></tr><tr><td>âœ…</td><td>:white_check_mark:</td><td>æ·»åŠ ã€æ›´æ–°æˆ–é€šè¿‡æµ‹è¯•ã€‚</td></tr><tr><td>ğŸ”’ï¸</td><td>:lock:</td><td>ä¿®å¤å®‰å…¨é—®é¢˜ã€‚</td></tr><tr><td>ğŸ”–</td><td>:bookmark:</td><td>å‘å¸ƒ/ç‰ˆæœ¬æ ‡ç­¾ã€‚</td></tr><tr><td>ğŸš¨</td><td>:rotating_light:</td><td>ä¿®å¤ç¼–è¯‘å™¨/linter è­¦å‘Šã€‚</td></tr><tr><td>ğŸš§</td><td>:construction:</td><td>å·¥ä½œæ­£åœ¨è¿›è¡Œä¸­ã€‚</td></tr><tr><td>ğŸ’š</td><td>:green_heart:</td><td>ä¿®å¤ CI æ„å»ºã€‚</td></tr><tr><td>â¬‡ï¸</td><td>:arrow_down:</td><td>é™çº§ä¾èµ–é¡¹ã€‚</td></tr><tr><td>â¬†ï¸</td><td>:arrow_up:</td><td>å‡çº§ä¾èµ–é¡¹ã€‚</td></tr><tr><td>ğŸ“Œ</td><td>:pushpin:</td><td>å°†ä¾èµ–é¡¹å›ºå®šåˆ°ç‰¹å®šç‰ˆæœ¬ã€‚</td></tr><tr><td>ğŸ‘·</td><td>:construction_worker:</td><td>æ·»åŠ æˆ–æ›´æ–° CI æ„å»ºç³»ç»Ÿã€‚</td></tr><tr><td>ğŸ“ˆ</td><td>:chart_with_upwards_trend:</td><td>æ·»åŠ æˆ–æ›´æ–°åˆ†ææˆ–è·Ÿè¸ªä»£ç ã€‚</td></tr><tr><td>â™»ï¸</td><td>:recycle:</td><td>é‡æ„ä»£ç ã€‚</td></tr><tr><td>â•</td><td>:heavy_plus_sign:</td><td>æ·»åŠ ä¾èµ–é¡¹ã€‚</td></tr><tr><td>â–</td><td>:heavy_minus_sign:</td><td>åˆ é™¤ä¾èµ–é¡¹ã€‚</td></tr><tr><td>ğŸ”§</td><td>:wrench:</td><td>æ·»åŠ æˆ–æ›´æ–°é…ç½®æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ”¨</td><td>:hammer:</td><td>æ·»åŠ æˆ–æ›´æ–°å¼€å‘è„šæœ¬ã€‚</td></tr><tr><td>ğŸŒ</td><td>:globe_with_meridians:</td><td>å›½é™…åŒ–å’Œæœ¬åœ°åŒ–ã€‚</td></tr><tr><td>âœï¸</td><td>:pencil2:</td><td>ä¿®æ­£é”™åˆ«å­—ã€‚</td></tr><tr><td>ğŸ’©</td><td>:poop:</td><td>ç¼–å†™éœ€è¦æ”¹è¿›çš„ç³Ÿç³•ä»£ç ã€‚</td></tr><tr><td>âªï¸</td><td>:rewind:</td><td>è¿˜åŸæ›´æ”¹ã€‚</td></tr><tr><td>ğŸ”€</td><td>:twisted_rightwards_arrows:</td><td>åˆå¹¶åˆ†æ”¯ã€‚</td></tr><tr><td>ğŸ“¦ï¸</td><td>:package:</td><td>æ·»åŠ æˆ–æ›´æ–°å·²ç¼–è¯‘çš„æ–‡ä»¶æˆ–åŒ…ã€‚</td></tr><tr><td>ğŸ‘½ï¸</td><td>:alien:</td><td>ç”±äºå¤–éƒ¨ API æ›´æ”¹è€Œæ›´æ–°ä»£ç ã€‚</td></tr><tr><td>ğŸšš</td><td>:truck:</td><td>ç§»åŠ¨æˆ–é‡å‘½åèµ„æºï¼ˆä¾‹å¦‚ï¼šæ–‡ä»¶ã€è·¯å¾„ã€è·¯ç”±ï¼‰ã€‚</td></tr><tr><td>ğŸ“„</td><td>:page_facing_up:</td><td>æ·»åŠ æˆ–æ›´æ–°è®¸å¯è¯ã€‚</td></tr><tr><td>ğŸ’¥</td><td>:boom:</td><td>å¼•å…¥é‡å¤§æ›´æ”¹ã€‚</td></tr><tr><td>ğŸ±</td><td>:bento:</td><td>æ·»åŠ æˆ–æ›´æ–°é™æ€èµ„æº</td></tr><tr><td>â™¿ï¸</td><td>:wheelchair:</td><td>æé«˜å¯è®¿é—®æ€§ã€‚</td></tr><tr><td>ğŸ’¡</td><td>:bulb:</td><td>åœ¨æºä»£ç ä¸­æ·»åŠ æˆ–æ›´æ–°æ³¨é‡Šã€‚</td></tr><tr><td>ğŸ»</td><td>:beers:</td><td>é†‰é…’å†™ä»£ç ã€‚(æ²¡æ‡‚å•¥æ„æ€)</td></tr><tr><td>ğŸ’¬</td><td>:speech_balloon:</td><td>æ·»åŠ æˆ–æ›´æ–°æ–‡æœ¬å’Œæ–‡å­—ã€‚</td></tr><tr><td>ğŸ—ƒï¸</td><td>:card_file_box:</td><td>æ‰§è¡Œä¸æ•°æ®åº“ç›¸å…³çš„æ›´æ”¹ã€‚</td></tr><tr><td>ğŸ”Š</td><td>:loud_sound:</td><td>æ·»åŠ æˆ–æ›´æ–°æ—¥å¿—ã€‚</td></tr><tr><td>ğŸ”‡</td><td>:mute:</td><td>åˆ é™¤æ—¥å¿—ã€‚</td></tr><tr><td>ğŸ‘¥</td><td>:busts_in_silhouette:</td><td>æ·»åŠ æˆ–æ›´æ–°è´¡çŒ®è€…ã€‚</td></tr><tr><td>ğŸš¸</td><td>:children_crossing:</td><td>æ”¹å–„ç”¨æˆ·ä½“éªŒ/å¯ç”¨æ€§</td></tr><tr><td>ğŸ—ï¸</td><td>:building_construction:</td><td>è¿›è¡Œæ¶æ„æ›´æ”¹ã€‚</td></tr><tr><td>ğŸ“±</td><td>:iphone:</td><td>ä»äº‹å“åº”å¼è®¾è®¡ã€‚</td></tr><tr><td>ğŸ¤¡</td><td>:clown_face:</td><td>mock ä»£ç </td></tr><tr><td>ğŸ¥š</td><td>:egg:</td><td>æ·»åŠ æˆ–æ›´æ–°å¤æ´»èŠ‚å½©è›‹ã€‚</td></tr><tr><td>ğŸ™ˆ</td><td>:see_no_evil:</td><td>æ·»åŠ æˆ–æ›´æ–° .gitignore æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸ“¸</td><td>:camera_flash:</td><td>æ·»åŠ æˆ–æ›´æ–°å¿«ç…§ã€‚</td></tr><tr><td>âš—ï¸</td><td>:alembic:</td><td>è¿›è¡Œå®éªŒã€‚</td></tr><tr><td>ğŸ”ï¸</td><td>:mag:</td><td>æ”¹è¿›æœç´¢å¼•æ“ä¼˜åŒ–ã€‚</td></tr><tr><td>ğŸ·ï¸</td><td>:label:</td><td>æ·»åŠ æˆ–æ›´æ–°ç±»å‹ã€‚</td></tr><tr><td>ğŸŒ±</td><td>:seedling:</td><td>æ·»åŠ æˆ–æ›´æ–°ç§å­æ–‡ä»¶ã€‚</td></tr><tr><td>ğŸš©</td><td>:triangular_flag_on_post:</td><td>æ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤åŠŸèƒ½æ ‡å¿—ã€‚</td></tr><tr><td>ğŸ¥…</td><td>:goal_net:</td><td>æ•æ‰é”™è¯¯ã€‚</td></tr><tr><td>ğŸ’«</td><td>:dizzy:</td><td>æ·»åŠ æˆ–æ›´æ–°åŠ¨ç”»å’Œè¿‡æ¸¡ã€‚</td></tr><tr><td>ğŸ—‘ï¸</td><td>:wastebasket:</td><td>å¼ƒç”¨éœ€è¦æ¸…ç†çš„ä»£ç ã€‚</td></tr><tr><td>ğŸ›‚</td><td>:passport_control:</td><td>å¤„ç†ä¸æˆæƒã€è§’è‰²å’Œæƒé™ç›¸å…³çš„ä»£ç ã€‚</td></tr><tr><td>ğŸ©¹</td><td>:adhesive_bandage:</td><td>å¯¹éå…³é”®é—®é¢˜çš„ç®€å•ä¿®å¤ã€‚</td></tr><tr><td>ğŸ§</td><td>:monocle_face:</td><td>æ•°æ®æ¢ç´¢/æ£€æŸ¥ã€‚</td></tr><tr><td>âš°ï¸</td><td>:coffin:</td><td>åˆ é™¤æ­»ä»£ç ã€‚</td></tr><tr><td>ğŸ§ª</td><td>:test_tube:</td><td>æ·»åŠ å¤±è´¥çš„æµ‹è¯•ã€‚</td></tr><tr><td>ğŸ‘”</td><td>:necktie:</td><td>æ·»åŠ æˆ–æ›´æ–°ä¸šåŠ¡é€»è¾‘</td></tr><tr><td>ğŸ©º</td><td>:stethoscope:</td><td>æ·»åŠ æˆ–æ›´æ–°å¥åº·æ£€æŸ¥ã€‚</td></tr></tbody></table><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>ç®€å•æ°´ğŸ’§ä¸€ä¸‹ã€‚  </p>]]></content>
    
    
    <categories>
      
      <category>ä»£ç æäº¤</category>
      
      <category>è§„èŒƒ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä»0åˆ°1å®Œæˆé˜¿é‡Œäº‘nodeæœåŠ¡æ­å»ºéƒ¨ç½²</title>
    <link href="/2021/10/30/%E4%BB%8E0%E5%88%B01%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E9%83%A8%E7%BD%B2/"/>
    <url>/2021/10/30/%E4%BB%8E0%E5%88%B01%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»0åˆ°1å®Œæˆé˜¿é‡Œäº‘nodeæœåŠ¡æ­å»ºéƒ¨ç½²"><a href="#ä»0åˆ°1å®Œæˆé˜¿é‡Œäº‘nodeæœåŠ¡æ­å»ºéƒ¨ç½²" class="headerlink" title="ä»0åˆ°1å®Œæˆé˜¿é‡Œäº‘nodeæœåŠ¡æ­å»ºéƒ¨ç½²"></a>ä»0åˆ°1å®Œæˆé˜¿é‡Œäº‘nodeæœåŠ¡æ­å»ºéƒ¨ç½²</h2><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>å‰æ®µæ—¶é—´è‡ªå·±æ ¹æ®ç½‘ä¸Šçš„æ•™ç¨‹æ£é¼“äº†ä¸€ä¸‹è‡ªå·±çš„æœåŠ¡å™¨ï¼Œç»ˆäºæŠŠè‡ªå·±çš„<code>node</code>æœåŠ¡éƒ¨ç½²åˆ°äº†é˜¿é‡Œäº‘ã€‚æ‰€ä»¥åœ¨è¿™é‡ŒæŠŠè‡ªå·±çš„ä¸€äº›ç»éªŒåˆ†äº«ç»™å„ä½ï¼Œå¸Œæœ›èƒ½å¯¹å¤§å®¶æœ‰å¸®åŠ©áƒ¦( Â´ï½¥á´—ï½¥` )æ¯”å¿ƒã€‚  </p><ol><li>å…ˆä»‹ç»ä¸€ä¸‹è¿™æ¬¡éƒ¨ç½²ç”¨åˆ°çš„ä¸€äº›ä¸œè¥¿ï¼Œå…å¾—æµªè´¹å„ä½çš„æ—¶é—´âœ… ã€‚ </li></ol><ul><li>é¦–å…ˆæœ¬äººæ˜¯ä¸€ä¸ªå‰ç«¯ï¼Œæ‰€ä»¥è¿™æ¬¡çš„æœåŠ¡ç«¯è¯­è¨€ç”¨çš„æ˜¯<code>node</code>æ¡†æ¶<a href="https://koajs.com/">koa</a>   </li><li><code>node</code>ç”Ÿäº§ç¯å¢ƒè‡ªç„¶ç¦»ä¸å¼€<a href="https://pm2.keymetrics.io/">pm2</a>ï¼Œæœ¬æ¬¡è¿œç¨‹éƒ¨ç½²ä¹Ÿç”¨åˆ°äº†å®ƒ  </li><li>æ•°æ®åº“ç”¨çš„<a href="https://docs.mongodb.com/">mongodb</a>ä»¥åŠå®ƒçš„<code>orm</code><a href="http://www.mongoosejs.net/">mongoose</a>  </li><li>ç¼“å­˜ç”¨çš„<code>redis</code>ï¼Œè¿™ä¸ªç”¨åˆ°çš„åœ°æ–¹ä¸æ˜¯å¾ˆå¤šã€‚  </li><li><code>nginx</code>åšä»£ç†  </li><li>å°†ä¸Šé¢çš„æ•°æ®åº“ã€ç¼“å­˜ã€<code>nginx</code>ç­‰åšå®¹å™¨åŒ–ä½¿ç”¨<code>docker</code>ï¼Œå¹¶ä½¿ç”¨<code>docker-compose</code>åšç»Ÿä¸€ç®¡ç†ã€‚  </li><li>ci/ci ç”¨çš„<code>github actions</code>ï¼Œä¸¤ä¸ªå­—ï¼Œé¦™ï¼ï¼ï¼ˆä¹‹å‰ç”¨çš„<code>travis</code>ï¼Œä½†æ˜¯åæ¥å¾—çŸ¥å®ƒå±…ç„¶å¼€å§‹æ”¶è´¹äº†ï¼Œé‚£æ²¡äº‹äº†ï¼Œç™½å«–æ€ªä¸å¯èƒ½å¤šèŠ±ä¸€åˆ†é’±çš„ï¼‰  </li></ul><ol start="2"><li>å½“å‰è¿˜æœ‰éƒ¨åˆ†æœªå®Œæˆçš„å†…å®¹â    </li></ol><ul><li>æ¶ˆæ¯é˜Ÿåˆ—æ§åˆ¶<code>rabbitmq</code>  </li><li>è§†é¢‘ç»†åŒ–å¤„ç†<code>ffmpeg</code>  </li></ul><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><ol><li>æœåŠ¡ç«¯ä¾èµ–å®‰è£…<br>é¦–å…ˆæ˜¯æœåŠ¡å™¨ä¸Šç›¸å…³çš„ä¾èµ–å®‰è£…ï¼š<code>node</code>å’Œ<code>docker</code>ä»¥åŠ<code>docker-compose</code>  </li></ol><ul><li>node<br>å®‰è£…<code>node</code>å¯ä»¥å‚è€ƒè¿™è¾¹<a href="https://www.jianshu.com/p/2e31fd9eb048">æ–‡ç« </a>çš„å†…å®¹  </li><li>docker<br>å®‰è£…<code>docker</code>å¯ä»¥å‚è€ƒ<a href="https://www.runoob.com/docker/ubuntu-docker-install.html">è¿™ä¸ª</a>  </li><li>docker-compose<br>å®‰è£…<code>docker-compose</code>å¯ä»¥å‚è€ƒ<a href="https://www.runoob.com/docker/ubuntu-docker-install.html">è¿™ä¸ª</a>  </li></ul><ol start="2"><li><p>github actions<br>å…³äºä»£ç é›†æˆéƒ¨ç½²æ–¹é¢ï¼Œæœ¬é¡¹ç›®ä½¿ç”¨äº†<code>github actions</code>ï¼Œå¦‚æœæœ‰ä¸äº†è§£çš„è¯ï¼Œå¯ä»¥å‚è€ƒ<a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">é˜®ä¸€å³°</a>çš„æ–‡ç« ã€‚<br>è¿™é‡Œå…³äºå®ƒå¯¹äºæœåŠ¡å™¨çš„ä¸€äº›é…ç½®é—®é¢˜ï¼Œæœ¬äººåœ¨ä¹‹å‰çš„ä¸€ç¯‡æ–‡ç« ä¸­æœ‰è¯¦ç»†æè¿°ï¼Œå¯ä»¥å‚çœ‹<a href="https://food-billboard.github.io/2021/10/25/deploy/">é‚£ç¯‡æ–‡ç« </a>æ¥è¿›è¡Œé…ç½®ã€‚</p></li><li><p>docker docker-compose  </p><ul><li><p><code>docker</code>   </p><blockquote><p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linuxæˆ–Windowsæ“ä½œç³»ç»Ÿçš„æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚<br><code>docker</code>ç®€åŒ–äº†æˆ‘ä»¬åœ¨æœåŠ¡éƒ¨ç½²ä¸Šçš„æµç¨‹ï¼Œå¹¶ä¸”å®ƒçš„å¯ç§»æ¤æ€§ä»¥åŠè·¨æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥è®©æˆ‘ä»¬ä¸€æ¬¡é…ç½®ï¼Œå¤šå¤„ä½¿ç”¨ã€‚ </p></blockquote></li><li><p><code>docker-compose</code>  </p><blockquote><p>Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚<br>é€šå¸¸éƒ¨ç½²æœåŠ¡ä¸€èˆ¬ç‰µæ‰¯åˆ°å…¶ä»–å¾ˆå¤šçš„é…ç½®ï¼Œæ¯”å¦‚æœ¬äººçš„<code>node</code>é¡¹ç›®ï¼Œéœ€è¦ç”¨åˆ°<code>mongodb</code>ã€<code>redis</code>ã€<code>nginx</code>ç­‰ï¼Œå¦‚æœè¿™äº›éƒ½å•ç‹¬é…ç½®ï¼Œä½†æ˜¯å®‰è£…å°±éœ€è¦åˆ†åˆ«å¤„ç†ä¸‰æ¬¡ï¼Œé€šè¿‡<code>docker</code>å®¹å™¨åŒ–å¹¶é…åˆ<code>docker-compose</code>è¿›è¡Œç»Ÿä¸€é…ç½®ï¼Œå¤§å¤§é™ä½äº†éš¾åº¦ã€‚  </p></blockquote></li></ul></li></ol><p>ä¸‹é¢å°±ä»‹ç»ä¸€ä¸‹æœ¬äººä½¿ç”¨çš„å‡ ç§å®¹å™¨çš„é…ç½®ï¼ˆå¯èƒ½ä¸å…¨ï¼Œå¯ä»¥é€‰æ‹©å¾—çœ‹ğŸ˜ï¼‰   </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-comment"># mongodb </span><br><span class="hljs-attr">mongo:</span><br>  <span class="hljs-attr">container_name:</span> <span class="hljs-string">mongo</span><br>  <span class="hljs-attr">image:</span> <span class="hljs-string">mongo:4.0.3</span><br>  <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>  <span class="hljs-attr">ports:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">27017</span><span class="hljs-string">:27017</span><br>  <span class="hljs-attr">volumes:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/home/movie/mongodb/data:/data/db</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/usr/local/mongodb/log:/var/log/mongodb</span>  <br><br><span class="hljs-comment"># redis </span><br><span class="hljs-attr">image:</span> <span class="hljs-string">redis</span><br>  <span class="hljs-attr">container_name:</span> <span class="hljs-string">redis</span><br>  <span class="hljs-attr">volumes:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">/usr/local/redis/redis.conf:/usr/local/etc/redis/redis.conf</span><br>  <span class="hljs-attr">ports:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">6379</span><span class="hljs-string">:6379</span><br><br><span class="hljs-comment"># nginx </span><br><span class="hljs-attr">image:</span> <span class="hljs-string">nginx:1.19</span><br>  <span class="hljs-attr">container_name:</span> <span class="hljs-string">nginx</span><br>  <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br>  <span class="hljs-attr">privileged:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">ports:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">8080</span><span class="hljs-string">:80</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">80</span><span class="hljs-string">:80</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-number">443</span><span class="hljs-string">:443</span><br>  <span class="hljs-attr">volumes:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./bin/nginx/nginx.conf:/etc/nginx/conf.d/default.conf</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./bin/nginx/logs.log:/etc/nginx/logs/log.log</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./public:/movie/server/public:ro</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./static:/movie/server/static:ro</span><br>  <span class="hljs-attr">network_mode:</span> <span class="hljs-string">host</span><br></code></pre></td></tr></table></figure><ul><li>å°±ä»¥ä¸Šçš„é…ç½®ï¼Œè¿™é‡Œåšä¸€ä¸‹è¯´æ˜ï¼š<ul><li>å¦‚ä¸Š<code>volumes</code>æ˜¯åšæ–‡ä»¶æ˜ å°„çš„ï¼Œå½“å¸Œæœ›å¤–éƒ¨æ–‡ä»¶æ˜ å°„åˆ°å†…éƒ¨æ–‡ä»¶ï¼Œå¹¶ä¸”åŒæ­¥ä¿®æ”¹æ—¶ï¼Œä¸è¦ç›´æ¥æ˜ å°„å¯¹åº”çš„æ–‡ä»¶ï¼Œè€Œæ˜¯æ˜ å°„å…¶å¤–éƒ¨çš„æ–‡ä»¶å¤¹ï¼Œå¦åˆ™çš„æ— æ³•åšåˆ°ä¿®æ”¹åŒæ­¥ã€‚  </li><li>å¤–éƒ¨çš„æœåŠ¡ä¼šå’Œå®¹å™¨å†…çš„æœåŠ¡å‘ç”Ÿå†²çªï¼Œæ¯”å¦‚ä½ åœ¨å¤–éƒ¨å¯åŠ¨äº†<code>nginx</code>ï¼ŒåŒæ ·åœ¨å®¹å™¨é‡Œå¯ç”¨<code>docker</code>ï¼Œé‚£ä¹ˆå¯èƒ½å°±æ˜¯å¤–éƒ¨çš„<code>nginx</code>é…ç½®èµ·ä½œç”¨äº†ã€‚  </li></ul></li></ul><p>å¦‚æœæœ‰åœ¨æœ¬åœ°åš<code>docker</code>æµ‹è¯•ï¼Œå¯ä»¥<code>vs code</code>çš„<code>docker</code>æ’ä»¶ï¼Œå¯ä»¥é‡‡ç”¨å¯è§†åŒ–çš„æ–¹å¼æŸ¥çœ‹åˆ°å®¹å™¨å†…éƒ¨çš„æ–‡ä»¶ç»“æ„ã€‚  </p><ul><li><p>å¦å¤–<br>æ”¶é›†äº†å‡ ä¸ªæœ‰æ—¶å€™ç”¨åˆ°çš„<code>docker</code>å‘½ä»¤  </p><ul><li><p>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„dockerå®¹å™¨ <code>docker ps</code>  </p></li><li><p>è¿›å…¥æŒ‡å®šå®¹å™¨å†…éƒ¨ <code>docker exec -it å®¹å™¨id sh</code>  </p></li><li><p>ä»å®¹å™¨ä¸­é€€å‡º <code>exit</code>  </p></li><li><p>æŸ¥çœ‹å®¹å™¨å†…éƒ¨æš´éœ²çš„ip <code>docker inspect å®¹å™¨id |grep IPA</code>  </p></li><li><p>å¤–éƒ¨æ‰§è¡Œmongodb <code>docker exec -it å®¹å™¨id mongo --host 127.0.0.1 --port 27017</code>  </p></li><li><p>å¤–éƒ¨æ‰§è¡Œredis <code>docker exec -it å®¹å™¨id redis-cli</code></p></li><li><p>æ–‡ä»¶å¤åˆ¶ <code>docker cp å®¹å™¨id:å®¹å™¨çš„è·¯å¾„ æœ¬åœ°çš„è·¯å¾„</code>  </p></li><li><p>åœæ­¢é•œåƒ <code>docker stop docker_id</code>  </p></li><li><p>åˆ é™¤å®¹å™¨ <code>docker rm docker_id</code>  </p></li><li><p>æ­£åœ¨è¿è¡Œçš„å®¹å™¨ <code>docker ps</code>  </p></li><li><p>æ‰€æœ‰å®¹å™¨ <code>docker ps -a</code>  </p></li><li><p>åˆ é™¤é•œåƒ <code>docker rmi docker_id</code>  </p></li><li><p>æŸ¥çœ‹é•œåƒ <code>docker images</code></p></li><li><p>æŸ¥çœ‹å®¹å™¨è¿è¡Œæ—¥å¿— <code>docker logs docker_id</code></p></li></ul></li></ul><ol start="4"><li>pm2  <blockquote><p>PM2 æ˜¯ä¸€ä¸ªå¸¦æœ‰è´Ÿè½½å‡è¡¡åŠŸèƒ½çš„ Node åº”ç”¨è¿›ç¨‹ç®¡ç†å™¨ã€‚<br>åˆ©ç”¨<code>pm2</code>åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡ŒæœåŠ¡æŒä¹…æ€§è¿è¡Œï¼Œä»¥åŠè¾¾åˆ°ä»<code>local</code>åˆ°<code>remote</code>çš„ä»£ç éƒ¨ç½²ã€‚  </p></blockquote></li></ol><p>ä¸‹é¢æ˜¯å®ƒçš„é…ç½®ï¼Œå½“ä¸­æœ‰æ³¨é‡Šè¿›è¡Œè§£é‡Šã€‚  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">module</span>.exports = &#123;<br>  <span class="hljs-comment">// åº”ç”¨åç§°</span><br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;app&quot;</span>,<br>  <span class="hljs-comment">// éœ€è¦å¯åŠ¨çš„æœåŠ¡  </span><br>  <span class="hljs-attr">apps</span> : [<br>    &#123;<br>      <span class="hljs-comment">// è¿›ç¨‹åç§°</span><br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;app&#x27;</span>,<br>      <span class="hljs-comment">// è¿›ç¨‹çš„å…¥å£æ–‡ä»¶  </span><br>      <span class="hljs-attr">script</span>: <span class="hljs-string">&#x27;app.js&#x27;</span>,<br>      <span class="hljs-comment">// ç¯å¢ƒå˜é‡</span><br>      <span class="hljs-attr">env</span>: &#123;<br>        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">&quot;production&quot;</span><br>      &#125;,<br>      <span class="hljs-comment">// è´Ÿè½½å‡è¡¡</span><br>      <span class="hljs-attr">exec_mode</span>: <span class="hljs-string">&quot;cluster_mode&quot;</span>,<br>      <span class="hljs-comment">// é”™è¯¯æ—¥å¿—è·¯å¾„</span><br>      <span class="hljs-attr">error_file</span>: <span class="hljs-string">&#x27;./src/logs/pm2/error.log&#x27;</span>,<br>      <span class="hljs-comment">// è¾“å‡ºè·¯å¾„  </span><br>      <span class="hljs-attr">out_file</span>: <span class="hljs-string">&#x27;./src/logs/pm2/output.log&#x27;</span><br>    &#125;, <br>    <span class="hljs-comment">// å¦ä¸€ä¸ªè¿›ç¨‹  </span><br>    &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;socket&quot;</span>,<br>      <span class="hljs-attr">script</span>: <span class="hljs-string">&quot;./src/chat/index.js&quot;</span>,<br>      <span class="hljs-attr">exec_mode</span>: <span class="hljs-string">&quot;cluster_mode&quot;</span>,<br>    &#125;<br>  ],<br><br>  <span class="hljs-comment">// éƒ¨ç½²çš„é…ç½® </span><br>  <span class="hljs-attr">deploy</span> : &#123;<br>    <span class="hljs-attr">production</span> : &#123;<br>      <span class="hljs-attr">user</span>: <span class="hljs-string">&quot;è¿™é‡Œæ˜¯æœåŠ¡å™¨çš„ç”¨æˆ·å&quot;</span>,<br>      <span class="hljs-attr">host</span>: <span class="hljs-string">&quot;æœåŠ¡å™¨çš„ipåœ°å€(xx.xx.xx.xxæˆ–è€…å¯ä»¥ä½¿ç”¨æ•°ç»„è®¾ç½®å¤šä¸ª)&quot;</span>,<br>      <span class="hljs-attr">ssh_options</span>: <span class="hljs-string">&quot;sshè¿æ¥çš„å‚æ•°&quot;</span>,<br>      <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;githubåˆ†æ”¯&quot;</span>,<br>      <span class="hljs-attr">repo</span>: <span class="hljs-string">&quot;githubä»“åº“&quot;</span>,<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;éƒ¨ç½²çš„æœåŠ¡å™¨ä¸­çš„æ–‡ä»¶ç›®å½•&quot;</span>,<br>      <span class="hljs-comment">// ä»£ç è¢«cloneåæ‰§è¡Œçš„å‘½ä»¤</span><br>      <span class="hljs-string">&quot;post-deploy&quot;</span>:<br>        <span class="hljs-string">&quot;git pull origin master &amp;&amp; source ~/.nvm/nvm.sh &amp;&amp; yarn install&quot;</span>, <br>      <span class="hljs-comment">// ç¯å¢ƒå˜é‡</span><br>      <span class="hljs-attr">env</span>: &#123;<br>        <span class="hljs-string">&quot;NODE_ENV&quot;</span>: <span class="hljs-string">&quot;production&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><ol><li>å¯èƒ½å­˜åœ¨æ‹‰å–<code>docker</code>é•œåƒå‡ºç°<code>net/http: TLS handshake timeout</code>é—®é¢˜<br>ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿ  <blockquote><p>Ubuntu16.04+ã€Debian8+ã€CentOS7<br>å¯¹äºä½¿ç”¨ systemd çš„ç³»ç»Ÿï¼Œè¯·åœ¨ /etc/docker/daemon.json ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼ˆå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨è¯·æ–°å»ºè¯¥æ–‡ä»¶ï¼‰ï¼š<br><code>&#123;&quot;registry-mirrors&quot;:[&quot;https://reg-mirror.qiniu.com/&quot;]&#125;</code><br>è¿™ä¸ªæ˜¯ä¸ƒç‰›äº‘çš„é•œåƒåŠ é€Ÿåœ°å€  </p></blockquote></li></ol><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>è¿™å°±æ˜¯æœ¬æ¬¡æˆ‘åœ¨æ­å»ºéƒ¨ç½²é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸­æ€»ç»“çš„ä¸€äº›ç»éªŒå’Œæ•™è®­ï¼Œå¦‚æœ‰é”™è¯¯çš„è¯è¯·æŒ‡æ­£ï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ã€‚<br>å®Œæ•´çš„é¡¹ç›®é…ç½®å¯ä»¥åˆ°<a href="https://github.com/food-billboard/node-server">è¿™é‡Œ</a>æŸ¥çœ‹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
      <category>æœåŠ¡å™¨</category>
      
      <category>å‰ç«¯</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>deploy node</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mongodbæ“ä½œå®ä¾‹</title>
    <link href="/2021/10/26/mongodb%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/"/>
    <url>/2021/10/26/mongodb%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>è¿™æ˜¯<code>mongodb</code>çš„ç¬¬äºŒç¯‡æ–‡ç« ï¼Œæœ¬æ–‡åŒ…å«äº†ä¸€äº›åœ¨å¹³æ—¶è‡ªå·±å¼€å‘è¿‡ç¨‹å½“ä¸­ä½¿ç”¨çš„ä¸€äº›æ“ä½œç¬¦ä»¥åŠç‰¹æ®Šæƒ…å†µï¼Œå¸Œæœ›å¯¹å„ä½æœ‰å¸®åŠ©ğŸ˜º ã€‚  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="filter"><a href="#filter" class="headerlink" title="$filter"></a>$filter</h3><ul><li><p>ç”¨äºä»å·²æœ‰æ•°æ®å¯¹è±¡ä¸­çš„æ•°ç»„ä¸­ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„æ•°æ®é¡¹  </p></li><li><p>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®:  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">students</span>: [<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">10</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">19</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Jack&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">17</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure></li><li><p>ç­›é€‰å‡ºå¹´é¾„å¤§äº<code>18</code>çš„å­¦ç”Ÿ  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$project</span>: &#123;<br>      <span class="hljs-attr">student_gt_18</span>: &#123;<br>        <span class="hljs-attr">$filter</span>: &#123;<br>          <span class="hljs-attr">input</span>: <span class="hljs-string">&quot;$students&quot;</span>,<br>          <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>          <span class="hljs-attr">cond</span>: &#123;<br>            <span class="hljs-attr">$gt</span>: [ <span class="hljs-string">&quot;$$student.age&quot;</span>, <span class="hljs-number">18</span> ]<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure></li><li><p>ä½ å°†ä¼šå¾—åˆ°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">student_gt_18</span>: [<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">19</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure></li></ul><p><code>$filter</code>æœ‰ä¸‰ä¸ªå‚æ•°:  </p><ol><li><code>input</code><br>å…ƒæ•°æ®ä¸­çš„æŸä¸€å­—æ®µ(å¦‚<code>students</code>)  </li><li><code>as</code><br><code>students</code>çš„éå†é¡¹åç§°(å¦‚<code>student</code>)</li><li><code>cond</code><br>ç­›é€‰æ¡ä»¶ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨éå†é¡¹çš„å€¼(å¦‚<code>$$student.age</code>ï¼Œå¾—åˆ°äº†å½“å‰é¡¹çš„<code>age</code>)   </li></ol><h3 id="map"><a href="#map" class="headerlink" title="$map"></a>$map</h3><ul><li><p>ç”¨äºéå†å·²æœ‰æ•°æ®å¯¹è±¡ä¸­çš„æ•°ç»„ä¸­å¹¶è§£ææˆæ–°çš„æ•°ç»„<br>å…¶å®è¿™ä¸ªå’Œä¸Šé¢çš„<code>$filter</code>åœ¨è¯­ä¹‰ä¸Šä¸<code>javascript</code>çš„åŒåæ–¹æ³•çš„åŠŸèƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ ·çš„è¯åº”è¯¥ä¼šå¾ˆå¥½ç†è§£äº†ğŸ‘ ã€‚</p></li><li><p>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®:  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">students</span>: [<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">10</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">19</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure></li><li><p>å°†å­¦ç”Ÿ<code>name</code>å’Œ<code>age</code>å­—æ®µæ‹¼æ¥ç”Ÿæˆæ–°çš„å­—æ®µ<code>description</code>   </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$project</span>: &#123;<br>      <span class="hljs-attr">new_students</span>: &#123;<br>        <span class="hljs-attr">$map</span>: &#123;<br>          <span class="hljs-attr">input</span>: <span class="hljs-string">&quot;$students&quot;</span>,<br>          <span class="hljs-attr">as</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>          <span class="hljs-attr">in</span>: &#123;<br>            <span class="hljs-attr">description</span>: &#123;<br>              <span class="hljs-attr">$concat</span>: [ <span class="hljs-string">&quot;$$student.name&quot;</span>, <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;$$student.age&quot;</span> ]<br>            &#125;<br>          &#125;<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure></li><li><p>ä½ å°†ä¼šå¾—åˆ°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">new_students</span>: [<br>      &#123;<br>        <span class="hljs-attr">description</span>: <span class="hljs-string">&quot;Join-10&quot;</span>,<br>      &#125;,<br>      &#123;<br>        <span class="hljs-attr">description</span>: <span class="hljs-string">&quot;Lisa-19&quot;</span>,<br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure></li></ul><p><code>$map</code>æœ‰ä¸‰ä¸ªå‚æ•°:  </p><ol><li><code>input</code><br>å…ƒæ•°æ®ä¸­çš„æŸä¸€å­—æ®µ(å¦‚<code>students</code>)  </li><li><code>as</code><br><code>students</code>çš„éå†é¡¹åç§°(å¦‚<code>student</code>)</li><li><code>in</code><br>å°†ä¼šç”Ÿæˆçš„æ•°æ®å­—æ®µï¼Œ<code>key</code>ä¸ºå­—æ®µåç§°ï¼Œ<code>value</code>ä¸ºå­—æ®µå€¼ï¼Œå¯ä»¥åœ¨å…¶ä¸­ä½¿ç”¨éå†é¡¹çš„å€¼(å¦‚<code>$$student.age</code>ï¼Œå¾—åˆ°äº†å½“å‰é¡¹çš„<code>age</code>)<br>ç”šè‡³å¯ä»¥åœ¨å…¶ä¸­å¯¹ä¸€äº›æ•°ç»„è¿›è¡Œ<code>$filter</code>æ“ä½œï¼Œè¿™æ˜¯è¢«å…è®¸çš„ã€‚   </li></ol><h3 id="lookup"><a href="#lookup" class="headerlink" title="$lookup"></a>$lookup</h3><ul><li>å¤æ‚å¤šè¡¨è”æŸ¥<br>è¿™ä¸ªåº”è¯¥åœ¨å¹³å¸¸å¼€å‘ä¸­ç”¨åˆ°çš„é¢‘ç‡éå¸¸çš„é«˜ï¼Œç”¨äºå°†åµŒå¥—çš„é›†åˆè¿›è¡ŒæŸ¥è¯¢<br>æƒ³è±¡ä¸€ä¸‹å¯èƒ½ä½ çš„<code>users</code>é›†åˆä¸­ä¿å­˜ç€<code>teacher</code>çš„å­—æ®µï¼Œå€¼ä¸ºå¦ä¸€ä¸ª<code>teachers</code>é›†åˆçš„<code>id</code>ï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ°<code>$lookup</code>æ¥è¿›è¡ŒæŸ¥è¯¢  </li></ul><p><strong>$lookupæœ‰ä¸¤ç§æŸ¥è¯¢å½¢å¼</strong>  </p><h4 id="ç®€å•æŸ¥è¯¢"><a href="#ç®€å•æŸ¥è¯¢" class="headerlink" title="ç®€å•æŸ¥è¯¢"></a>ç®€å•æŸ¥è¯¢</h4><p>è¿™ç§é€‚åˆåªæŸ¥è¯¢ä¸€å±‚çš„æƒ…å†µï¼Œæ¯”å¦‚ä¸Šé¢è¯´çš„<code>teachers</code>é›†åˆä¸­ä¸å­˜åœ¨å½“å‰æŸ¥è¯¢æ‰€éœ€è¦å†æ¬¡è”è¡¨æŸ¥è¯¢çš„å­—æ®µ<br>å¬ç€æœ‰äº›åˆ«æ‰­ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­  </p><ul><li>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>å’Œ<code>teachers</code>çš„æ•°æ®: </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span><br>  &#125;<br>]<br><br><span class="hljs-comment">// teachers </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">40</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢<code>students</code>é›†åˆå¹¶åŒæ—¶æŸ¥è¯¢å‡ºå…¶ä¸­çš„<code>teacher</code>æ•°æ®  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$lookup</span>: &#123;<br>      <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;teachers&#x27;</span>,<br>      <span class="hljs-attr">localField</span>: <span class="hljs-string">&#x27;teacher&#x27;</span>,<br>      <span class="hljs-attr">foreignField</span>: <span class="hljs-string">&#x27;id&#x27;</span>,<br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&#x27;teacher_data&#x27;</span><br>    &#125;<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">$project</span>: &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">age</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">teacher_data</span>: <span class="hljs-number">1</span><br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure><ul><li>ä½ å°†ä¼šå¾—åˆ°  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-comment">// æ³¨æ„è¿™é‡Œ</span><br>    <span class="hljs-attr">teacher_data</span>: [<br>      &#123;<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">40</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p>æ³¨æ„çœ‹ä¸Šé¢çš„æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®çš„<code>teacher_data</code>å­—æ®µï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚é€šè¿‡<code>$lookup</code>æŸ¥è¯¢çš„ç»“æœéƒ½ä¼šå˜æˆä¸€ä¸ªæ•°ç»„ã€‚<br>å¦‚æœä¸æƒ³æ˜¯æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡<code>$unwind</code>æ¥è¿›è¡Œæ‹†åˆ†ï¼Œæœ‰å…³<code>$unwind</code>å¯åœ¨åæ–‡çœ‹åˆ°ã€‚  </p><p>ç®€å•æŸ¥è¯¢åŒ…å«å››ä¸ªå‚æ•°ï¼š  </p><ol><li><code>from</code><br>è¦æŸ¥è¯¢çš„ç›®æ ‡é›†åˆåç§°  </li><li><code>localField</code><br>å½“å‰é›†åˆä¸­éœ€è¦è¿›è¡ŒæŸ¥è¯¢çš„å­—æ®µåç§°  </li><li><code>foreignField</code><br>ä¸¤ä¸ªé›†åˆæ‰€å…³è”èµ·æ¥çš„å­—æ®µåç§°ï¼Œä¸Šé¢æ˜¯<code>id</code>  </li><li><code>as</code><br>æŸ¥è¯¢ç»“æœä¿å­˜çš„å­—æ®µåç§°ï¼Œä½ å¯ä»¥ä½¿ç”¨åŸå§‹å­—æ®µåç§°è¿›è¡Œè¦†ç›–ï¼Œä¹Ÿå¯ä»¥æ–°å¢ä¸€ä¸ª  </li></ol><h4 id="å¤æ‚æŸ¥è¯¢"><a href="#å¤æ‚æŸ¥è¯¢" class="headerlink" title="å¤æ‚æŸ¥è¯¢"></a>å¤æ‚æŸ¥è¯¢</h4><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­åº”è¯¥å¯ä»¥ç†è§£åˆšåˆšçš„é‚£å¥è¯äº†å§ï¼Œå¤æ‚æŸ¥è¯¢å¯ä»¥æŠŠé‚£äº›åµŒå¥—å…³è”äº†å¤šå±‚çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥<br>è¿˜æ˜¯çœ‹ä¸‹é¢çš„ä¾‹å­ğŸŒ°  </p><ul><li>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>å’Œ<code>teachers</code>ä»¥åŠ<code>schools</code>çš„æ•°æ®: </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span><br>  &#125;<br>]<br><br><span class="hljs-comment">// teachers </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">40</span>,<br>    <span class="hljs-attr">school</span>: <span class="hljs-string">&quot;custom_school_id_001&quot;</span><br>  &#125;<br>]<br><br><span class="hljs-comment">// schools </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_school_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;high school&quot;</span>,<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢<code>students</code>é›†åˆå¹¶åŒæ—¶æŸ¥è¯¢å‡ºå…¶ä¸­çš„<code>teacher</code>æ•°æ®ä»¥åŠ<code>school</code>æ•°æ®<br>æ­¤æ—¶é€šè¿‡ç®€å•å¾—æŸ¥è¯¢å·²ç»æ— æ³•æ»¡è¶³è¦æ±‚  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$lookup</span>: &#123;<br>      <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;teachers&#x27;</span>, <br>      <span class="hljs-attr">let</span>: &#123;<br>        <span class="hljs-attr">teacher_id</span>: <span class="hljs-string">&quot;$teacher&quot;</span><br>      &#125;,<br>      <span class="hljs-attr">pipeline</span>: [<br>        &#123;<br>          <span class="hljs-attr">$match</span>: &#123;<br>            <span class="hljs-attr">$expr</span>: &#123;<br>              <span class="hljs-attr">$eq</span>: [<br>                <span class="hljs-string">&quot;$id&quot;</span>, <span class="hljs-string">&quot;$$teacher_id&quot;</span><br>              ]<br>            &#125;<br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">$lookup</span>: &#123;<br>            <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;schools&#x27;</span>,<br>            <span class="hljs-attr">as</span>: <span class="hljs-string">&#x27;school_data&#x27;</span>,<br>            <span class="hljs-attr">foreignField</span>: <span class="hljs-string">&quot;id&quot;</span>,<br>            <span class="hljs-attr">localField</span>: <span class="hljs-string">&quot;school&quot;</span><br>          &#125;<br>        &#125;,<br>        &#123;<br>          <span class="hljs-attr">$project</span>: &#123;<br>            <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">school</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">age</span>: <span class="hljs-number">1</span>,<br>            <span class="hljs-attr">school_data</span>: <span class="hljs-string">&quot;$school_data&quot;</span><br>          &#125;<br>        &#125;<br>      ],<br>      <span class="hljs-attr">as</span>: <span class="hljs-string">&#x27;teacher_data&#x27;</span><br>    &#125;<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">$project</span>: &#123;<br>      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">age</span>: <span class="hljs-number">1</span>,<br>      <span class="hljs-attr">teacher_data</span>: <span class="hljs-number">1</span><br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure><ul><li>ä½ å°†ä¼šå¾—åˆ°  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher_data</span>: [<br>      &#123;<br>        <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>        <span class="hljs-attr">age</span>: <span class="hljs-number">40</span>,<br>        <span class="hljs-attr">school_data</span>: [<br>          &#123;<br>            <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_school_id_001&quot;</span>,<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;high school&quot;</span>,<br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p>å¤æ‚æŸ¥è¯¢ä¹Ÿæ˜¯å››ä¸ªå‚æ•°:  </p><ol><li><code>from</code><br>ä¸ç®€å•æŸ¥è¯¢ç›¸åŒ  </li><li><code>as</code><br>ä¸ç®€å•æŸ¥è¯¢ç›¸åŒ  </li><li><code>let</code><br>åœ¨å½“å‰æŸ¥è¯¢å±‚å®šä¹‰çš„å˜é‡å¯ä»¥åœ¨æœ¬æ¬¡æŸ¥è¯¢ä¸­ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸Šé¢å®šä¹‰çš„<code>teacher_id</code>ï¼Œç”¨äºåœ¨ä¸‹å±‚æŸ¥è¯¢æ—¶åšç­›é€‰æ¡ä»¶åˆ¤æ–­  </li><li><code>pipeline</code><br>ä¸‹å±‚æŸ¥è¯¢æ“ä½œï¼Œé¡¾åæ€ä¹‰ï¼Œç®¡é“æ“ä½œï¼Œå€¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå½“ä¸­å¯ä»¥ä½¿ç”¨ä¸å¤–å±‚ç›¸åŒçš„æŸ¥è¯¢æ“ä½œï¼Œå¯ä»¥è®¿é—®åˆ°ä¸Šå±‚<code>let</code>ä¸­å®šä¹‰çš„å˜é‡ï¼Œä½¿ç”¨<code>$$</code>å‰ç¼€  </li></ol><ul><li><p>åº”è¯¥æœ‰æ³¨æ„åˆ°ä¸Šé¢åœ¨<code>pipeline</code>ç¬¬ä¸€é¡¹æ˜¯<code>$match</code>ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·æ“ä½œï¼Ÿ<br>å½“ä½¿ç”¨å¤æ‚æŸ¥è¯¢æ—¶ï¼Œéœ€è¦è‡ªå·±æ¥å®šä¹‰ç­›é€‰æ¡ä»¶ï¼Œå¦åˆ™å®ƒå°†ä¼šæŠŠé›†åˆå½“ä¸­çš„æ‰€æœ‰æ•°æ®å…¨éƒ¨è¿”å›  </p></li><li><p><code>$match</code> è¡¨ç¤ºçš„æ˜¯ç­›é€‰æ¡ä»¶<br>ä»¥åŠå…¶ä¸­è‹¥ä½¿ç”¨åˆ°<code>let</code>å®šä¹‰çš„å˜é‡æ—¶ï¼Œéœ€è¦ä½¿ç”¨<code>$expr</code>æ“ä½œç¬¦ï¼Œå…·ä½“çš„æˆ‘è¿˜æ²¡æœ‰äº†è§£è¿‡ğŸ˜Š ã€‚<br>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“è¦åšæ¯”è¾ƒçš„å€¼å¾—ç±»å‹æ˜¯<code>mongodb</code>è‡ªå¸¦çš„<code>ObjectId</code>ç±»å‹æ—¶ï¼Œç›¸ç­‰åˆ¤æ–­æ¡ä»¶éœ€è¦ä½¿ç”¨<code>$eq</code>æ“ä½œç¬¦ï¼Œå¦åˆ™æ°¸è¿œè¿”å›<code>false</code>    </p></li><li><p>æ³¨æ„:</p></li><li><p><code>pipeline</code> ä¸­ä½¿ç”¨ <code>$match</code> åŒ¹é… <code>let</code>ä¸­å®šä¹‰çš„å­—æ®µæ—¶ï¼Œéœ€è¦åœ¨å¤–é¢åŒ…ä¸€ä¸ª <code>$expr</code>, å¦åˆ™æ— æ³•åŒ¹é…<br><code>$match: &#123; $expr: &#123; _id: &quot;$$customFields&quot; &#125; &#125;</code>  </p></li><li><p>å¦‚æœè¦åœ¨<code>$match</code>ä¸­åŒ¹é…<code>ObjectId</code>, éœ€è¦ä½¿ç”¨<code>$eq</code>, ç›´æ¥æ¯”è¾ƒä¼¼ä¹æ— æ•ˆ,åŸå› æœ‰å¾…æŸ¥è¯. <code>$expr: &#123; $eq: [ &quot;$_id&quot;, &quot;$$customFields&quot; ] &#125;</code>   </p></li><li><p>ps<br>è¿™æ˜¯æˆ‘å¦å¤–ç¢°åˆ°çš„ä¸€ä¸ªä¾‹å­ğŸŒ°<br>éœ€è¦åˆ¤æ–­æŸä¸ªå€¼æ˜¯å¦åœ¨æ•°ç»„ä¸­å­˜åœ¨ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨<code>$in</code>æ“ä½œç¬¦è¿›è¡Œåˆ¤æ–­<br>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦åˆ¤æ–­çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŸ¥è¯¢çš„æ•°ç»„  </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// ç®€å•æè¿°ä¸€ä¸‹</span><br>&#123;<br>  <span class="hljs-attr">let</span>: &#123;<br>    <span class="hljs-attr">teacher_id</span>: <span class="hljs-string">&quot;$teacher&quot;</span><br>  &#125;,<br>  <span class="hljs-attr">pipeline</span>: [<br>    &#123;<br>      <span class="hljs-attr">$match</span>: &#123;<br>        <span class="hljs-attr">$expr</span>: &#123;<br>          <span class="hljs-string">&quot;$in&quot;</span>: [ <span class="hljs-string">&quot;$name&quot;</span>, [<span class="hljs-string">&quot;Lisa&quot;</span>] ]<br>        &#125;<br>      &#125;<br>    &#125;<br>  ]<br>&#125;<br></code></pre></td></tr></table></figure></li></ul><h3 id="unwind"><a href="#unwind" class="headerlink" title="$unwind"></a>$unwind</h3><p>æ ¹æ®æŒ‡å®šçš„æ•°ç»„å­—æ®µè¿›è¡Œæ‹†åˆ†æˆå¤šé¡¹<br>å®ƒä¹Ÿæœ‰ä¸¤ç§å½¢å¼  </p><h4 id="ç®€å•å½¢å¼"><a href="#ç®€å•å½¢å¼" class="headerlink" title="ç®€å•å½¢å¼"></a>ç®€å•å½¢å¼</h4><ul><li>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®: </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: [<br>      <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>      <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span><br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢<code>users</code>æ•°æ®å¹¶å°†<code>teacher</code>å­—æ®µè¿›è¡Œæ‹†åˆ†    </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$unwind</span>: <span class="hljs-string">&quot;$teacher&quot;</span><br>  &#125;<br>])<br></code></pre></td></tr></table></figure><ul><li>ä½ å°†ä¼šå¾—åˆ°  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p><code>teacher</code>ä¸ºæ‹†åˆ†çš„å­—æ®µï¼Œéœ€è¦æ·»åŠ <code>$</code>å‰ç¼€<br>è¿™ç§ç®€å•çš„å†™æ³•é€‚åˆé‚£ç§å­—æ®µè§„æ•´çš„æƒ…å†µï¼Œå½“éœ€è¦åšå¼‚å¸¸å¤„ç†æ—¶ï¼Œè¿™ç§æƒ…å†µå°±ä¸é€‚ç”¨äº†ã€‚  </p><h4 id="å¤æ‚å½¢å¼"><a href="#å¤æ‚å½¢å¼" class="headerlink" title="å¤æ‚å½¢å¼"></a>å¤æ‚å½¢å¼</h4><ul><li>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®: </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: [<br>      <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>      <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span><br>    ]<br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_002&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>,<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢<code>users</code>æ•°æ®å¹¶å°†<code>teacher</code>å­—æ®µè¿›è¡Œæ‹†åˆ†ï¼Œå¹¶è®¾ç½®å½“<code>teacher</code>ä¸å­˜åœ¨æ—¶ç»§ç»­ä¿ç•™    </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$unwind</span>: &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;$teacher&quot;</span>,<br>      <span class="hljs-attr">preserveNullAndEmptyArrays</span>: <span class="hljs-literal">true</span> <br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure><ul><li>ä½ å°†ä¼šå¾—åˆ°</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_002&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Lisa&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">20</span>,<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p>å¦‚ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œå½“<code>teacher</code>ä¸å­˜åœ¨æ—¶ï¼Œä¿ç•™äº†å¯¹åº”çš„å­—æ®µï¼Œå¦‚æœè®¾ç½®<code>preserveNullAndEmptyArrays</code>æ—¶ï¼Œç¬¬ä¸‰æ¡æ•°æ®å°†ä¸è¢«æŸ¥è¯¢åˆ°ã€‚  </p><p>å¤æ‚å½¢å¼æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</p><ol><li><code>path</code><br>åŒç®€å•å½¢å¼  </li><li><code>preserveNullAndEmptyArrays</code><br>æ˜¯å¦ä¿ç•™ç©ºæ•°ç»„  </li><li><code>includeArrayIndex</code><br>æš‚æ—¶æ²¡æœ‰ç”¨åˆ°è¿‡ï¼Œå†è¯´ã€‚  </li></ol><h3 id="addToSet"><a href="#addToSet" class="headerlink" title="$addToSet"></a>$addToSet</h3><p>è¿™ä¸ªæ–¹æ³•åœ¨å‰é¢çš„<a href="https://food-billboard.github.io/2020/10/18/mongodb%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%AC%A6/">mongodbå¸¸ç”¨æ“ä½œç¬¦æ–‡ç« ä¸­ä»‹ç»è¿‡</a>ä»‹ç»è¿‡ï¼Œä½†æ˜¯é‚£æ˜¯æ·»åŠ ä¸€é¡¹ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åŒæ—¶æ·»åŠ å¤šä¸ªé¡¹ã€‚  </p><ul><li>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®: </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: [<br>      <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>    ]<br>  &#125;,<br>]<br></code></pre></td></tr></table></figure><ul><li>å‘<code>name</code>ä¸º<code>Join</code>çš„æ•°æ®å­—æ®µæ·»åŠ ä¸¤ä¸ª<code>teacher</code>é¡¹    </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">db.users.updateOne(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-attr">$addToSet</span>: &#123;<br>    <span class="hljs-attr">teacher</span>: &#123;<br>      <span class="hljs-attr">$each</span>: [<br>        <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span>,<br>        <span class="hljs-string">&quot;custom_teacher_id_003&quot;</span><br>      ]<br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><ul><li>è¯¥å­—æ®µä¼šå˜æˆ  </li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">teacher</span>: [<br>      <span class="hljs-string">&quot;custom_teacher_id_001&quot;</span>,<br>      <span class="hljs-string">&quot;custom_teacher_id_002&quot;</span>,<br>      <span class="hljs-string">&quot;custom_teacher_id_003&quot;</span><br>    ]<br>  &#125;,<br>]<br></code></pre></td></tr></table></figure><p>é…åˆ<code>$each</code>æ·»åŠ å¤šé¡¹ï¼Œè¿™ä¸ªæ²¡å•¥å¥½è¯´çš„  </p><h3 id="addFields"><a href="#addFields" class="headerlink" title="$addFields"></a>$addFields</h3><ul><li><p>å‘è¾“å‡ºç»“æœä¸­æ–°å¢å­—æ®µ<br>è¿™ç§çš„ä¸€èˆ¬ä½¿ç”¨æƒ…å†µæ˜¯å¯¹åŸå§‹çš„ä¸€äº›æ•°æ®å­—æ®µåšç‰¹æ®Šå¤„ç†ï¼Œæ¯”å¦‚ç»Ÿè®¡ç­‰ã€‚  </p></li><li><p>å‡è®¾æœ‰å¦‚ä¸‹é›†åˆåç§°ä¸º<code>users</code>çš„æ•°æ®:  </p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// users </span><br>[<br>  &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">homework</span>: [<br>      <span class="hljs-number">30</span>,<br>      <span class="hljs-number">40</span><br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li>æŸ¥è¯¢<code>users</code>æ•°æ®å¹¶æ·»åŠ æ–°å­—æ®µ<code>total_homework</code>    </li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.users.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$addFields</span>: &#123;<br>      <span class="hljs-attr">total_homework</span>: &#123; <br>        <span class="hljs-attr">$sum</span>: <span class="hljs-string">&quot;$homework&quot;</span> <br>      &#125;<br>    &#125;<br>  &#125;,<br>])<br></code></pre></td></tr></table></figure><ul><li>ä½ å°†ä¼šå¾—åˆ°</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-attr">_id</span>: <span class="hljs-string">&quot;custom_student_id_001&quot;</span>,<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Join&quot;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-attr">homework</span>: [<br>      <span class="hljs-number">30</span>,<br>      <span class="hljs-number">40</span><br>    ],<br>    <span class="hljs-attr">total_homework</span>: <span class="hljs-number">70</span> <br>  &#125;,<br>]<br></code></pre></td></tr></table></figure><h3 id="push"><a href="#push" class="headerlink" title="$push"></a>$push</h3><p>è¿™ä¸ªä¹Ÿæ˜¯åœ¨<a href="https://food-billboard.github.io/2020/10/18/mongodb%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%AC%A6/">å‰ä¸€ç¯‡æ–‡ç« </a>æœ‰ä»‹ç»  </p><p>ä½†æ˜¯å½“éœ€è¦åŒæ—¶æ·»åŠ å¤šé¡¹æ—¶ï¼Œå¯èƒ½ä¼šéœ€è¦ç”¨åˆ°<code>$pushAll</code>æ“ä½œç¬¦ï¼Œä½†æ˜¯åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œ<code>$pushAll</code>ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨<code>$push</code><br>è‡³äºä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒå‰é¢çš„<code>$addToSet</code>æ“ä½œç¬¦ã€‚</p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>ä»¥ä¸Šå°±æ˜¯æœ¬äººåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­ç¢°åˆ°çš„ä¸€éƒ¨åˆ†é—®é¢˜ï¼Œä»¥åå¦‚æœæœ‰æ–°çš„é—®é¢˜è¿˜ä¼šè¡¥å……ã€‚å¦‚æœæœ‰å“ªé‡Œé”™äº†æ¬¢è¿æŒ‡æ­£ğŸ˜Š ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>mongodb</category>
      
      <category>node</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>database</tag>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Github Actions éƒ¨ç½²nodeé¡¹ç›®</title>
    <link href="/2021/10/25/deploy/"/>
    <url>/2021/10/25/deploy/</url>
    
    <content type="html"><![CDATA[<h2 id="å¼€å¤´"><a href="#å¼€å¤´" class="headerlink" title="å¼€å¤´"></a>å¼€å¤´</h2><p>ä½œä¸ºä¸€ä¸ªå‰ç«¯ï¼Œå…¶å®å¹³å¸¸å’ŒæœåŠ¡å™¨æ‰“äº¤é“çš„æ—¶é—´å¹¶ä¸å¤šï¼Œä½†ä½œä¸ºä¸€ä¸ªç¨‹åºçŒ¿ï¼Œåˆæ€ä¹ˆèƒ½ä¸æƒ³æä¸€æå‘¢ã€‚<br>è®²ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ğŸŒ°ï¼š<br>ä½ å‘ç°äº†ä½ é¡µé¢çš„ä¸€ä¸ªbugï¼Œæ”¹å¥½ä¹‹åéœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨äº†ï¼Œæ°å·§æ²¡æœ‰åå°äººå‘˜åœ¨ï¼Œéœ€è¦è‡ªå·±éƒ¨ç½²ã€‚ä½ è¾“å…¥è´¦å·å¯†ç ç™»å½•äº†æœåŠ¡å™¨ï¼Œè¿›å…¥åˆ°å¯¹åº”çš„ç›®å½•ï¼Œæ›¿æ¢äº†å¯¹åº”çš„æ–‡ä»¶ï¼Œå®Œæˆäº†æœ¬æ¬¡çš„ä¿®æ”¹ã€‚è¿‡äº†ä¸€ä¼šå„¿ï¼Œä½ å‘ç°å¥½åƒè¿˜æœ‰é—®é¢˜ï¼Œç„¶åä½ åˆé‡æ–°æ¥äº†ä¸€éã€‚ã€‚ã€‚<br>è¿™æ ·é‡å¤åšåŠŸç»å¯¹ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥æ­¤æ—¶å°±éœ€è¦<code>github actions</code>ç™»åœºäº†ã€‚å®ƒå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ä¸­é—´è¿™äº›å¤æ‚åˆé‡å¤çš„å·¥ä½œï¼Œè®©æˆ‘ä»¬èƒ½æœ‰æ›´å¤šçš„æ—¶é—´æ‘¸ğŸŸã€‚ğŸ˜</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>å…³äº<code>github actions</code>çš„ä»‹ç»ï¼Œè¿™é‡Œä¸å¤šè¯´ï¼Œå¤§å®¶å¯ä»¥å‚çœ‹<a href="http://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html">é˜®ä¸€å³°è€å¸ˆçš„æ–‡ç« </a>  </p><h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><p>é¦–å…ˆæ˜¯å…·ä½“çš„æµç¨‹  </p><ul><li>æœ¬åœ°å®Œæˆä»£ç ä¿®æ”¹ï¼Œæäº¤ä»£ç åˆ°<code>github</code>  </li><li><code>github</code>æ£€æµ‹åˆ°ä»£ç æäº¤ï¼Œè‡ªåŠ¨æ‰§è¡Œé¡¹ç›®ç›®å½•ä¸‹çš„<code>.github/workflows</code>çš„ymlæ–‡ä»¶ã€‚</li><li>è™šæ‹Ÿæœºå†…:  </li></ul><ol><li>åˆ‡æ¢å¯¹åº”çš„åˆ†æ”¯ï¼Œæ¯”å¦‚<code>master</code>  </li><li>ç”Ÿæˆ<code>ssh</code>ç§˜é’¥æ–‡ä»¶  </li><li>è®¾ç½®å¯¹åº”çš„<code>node</code>ç‰ˆæœ¬  </li><li>å®‰è£…<code>yarn</code>ã€<code>pm2</code>  </li><li><code>pm2</code>éƒ¨ç½²ä»£ç è‡³æœåŠ¡å™¨  </li><li><code>ssh</code>ç™»å½•æœåŠ¡å™¨ï¼Œ<code>pm2</code>æ›´æ–°å¹¶å¯åŠ¨<code>node</code>æœåŠ¡ï¼Œæ›´æ–°<code>docker</code>æœåŠ¡  </li></ol><h3 id="å…·ä½“æµç¨‹"><a href="#å…·ä½“æµç¨‹" class="headerlink" title="å…·ä½“æµç¨‹"></a>å…·ä½“æµç¨‹</h3><p>ä»¥ä¸‹æ–‡ä»¶è·¯å¾„åŸºæœ¬æºè‡ª<code>mac</code>  </p><ol><li>åœ¨æœ¬æœºçš„<code>.ssh</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆç§˜é’¥ã€å…¬é’¥ï¼Œå¦‚æœæœ‰çš„è¯è¯·å¿½ç•¥  </li></ol><ul><li>ä½¿ç”¨å‘½ä»¤ç”Ÿæˆ<code>ssh-keygen -t rsa -C ä½ çš„githubé‚®ç®±@.com</code>  </li><li>å°†å…¬é’¥æ–‡ä»¶<code>id_rsa.pub</code>å†…å®¹æ·»åŠ åˆ°<code>github</code>é…ç½®ä¸­(githubç½‘ç«™ä¸Šçš„ -&gt; <code>settings</code> -&gt; <code>SSH and GPG keys</code>)  </li></ul><ol start="2"><li>åœ¨å¯¹åº”çš„æœåŠ¡å™¨ä¸­çš„<code>.ssh</code>æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆç§é’¥ã€å…¬é’¥ï¼Œæœ‰çš„è¯è¯·å¿½ç•¥  </li></ol><ul><li>ä½¿ç”¨å‘½ä»¤<code>ssh-keygen -o</code>  </li></ul><ol start="3"><li>æ·»åŠ æœ¬æœºçš„å…¬é’¥è‡³æœåŠ¡å™¨  </li></ol><ul><li>æœåŠ¡å™¨<code>.ssh</code>æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª<code>authorized_keys</code>æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰çš„è¯è¯·åˆ›å»º<code>touch authorized_keys</code>  </li><li>æ·»åŠ æœ¬æœºçš„å…¬é’¥å†…å®¹è‡³<code>authorized_keys</code>ä¸­  </li></ul><ol start="4"><li>æ·»åŠ æœåŠ¡å™¨å…¬é’¥è‡³<code>github</code>  </li></ol><ul><li>å°†æœåŠ¡å™¨å…¬é’¥å†…å®¹æ·»åŠ åˆ°<code>github</code> (githubç½‘ç«™ -&gt; <code>settings</code> -&gt; <code>SSH and GPG keys</code>) æˆ–è€… (githubé¡¹ç›®ä¸­ -&gt; <code>settings</code> -&gt; <code>deploy keys</code>)</li></ul><ol start="5"><li>æ·»åŠ æµç¨‹ä¸­æ‰€éœ€è¦çš„ä¸€äº›ç¯å¢ƒå˜é‡<br>å…¶ä¸­æœ‰äº›å˜é‡å¹¶ä¸æ˜¯å¿…é¡»å¾—ï¼Œå¯è‡ªè¡Œé€‰æ‹©æ·»åŠ <br>æ‰€æœ‰çš„è‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡éƒ½æ”¾åœ¨é¡¹ç›®çš„<code>secrets</code>ä¸­(githubé¡¹ç›®ä¸­ -&gt; <code>settings</code> -&gt; <code>secrets</code>)<br><code>name</code>å­—æ®µè‡ªå®šä¹‰  </li></ol><ul><li>å°†æœ¬æœºç§é’¥æ–‡ä»¶<code>id_rsa</code>å†…å®¹æ·»åŠ è‡³ç¯å¢ƒå˜é‡ï¼Œ<code>name</code>è®¾ç½®ä¸º<code>LOCAL_SSH_PRIVATE_KEY</code>ï¼Œ<code>value</code>ä¸º<code>id_rsa</code>å†…å®¹  </li><li>æ·»åŠ æœåŠ¡å™¨çš„<code>host</code>ï¼Œ<code>name</code>è®¾ç½®ä¸º<code>SSH_IP</code>  </li><li>æ·»åŠ æœåŠ¡å™¨<code>ssh</code>ç”¨æˆ·åï¼Œ<code>name</code>è®¾ç½®ä¸º<code>SSH_USERNAME</code></li><li>æ·»åŠ æœåŠ¡å™¨<code>ssh</code>å¯†ç ï¼Œ<code>name</code>è®¾ç½®ä¸º<code>SSH_PASSWORD</code>  </li><li>æ·»åŠ æœåŠ¡å™¨é¡¹ç›®æ–‡ä»¶ç›®å½•åœ°å€ï¼Œ<code>name</code>è®¾ç½®ä¸º<code>REMOTE_PATH</code>  </li></ul><ol start="6"><li>æ·»åŠ <code>github</code>è‡³æœåŠ¡å™¨çš„<code>known_hosts</code>æ–‡ä»¶ä¸­  </li></ol><ul><li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤<code>ssh-keyscan -t rsa github.com &gt;&gt; ~/.ssh/known_hosts</code><br>è‹¥ä¸æ‰§è¡Œæ­¤æ“ä½œï¼Œ<code>github</code>è®¿é—®æœåŠ¡å™¨å¯èƒ½ä¼šå‡ºé”™  </li></ul><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œå³å¯å¼€å§‹é¡¹ç›®çš„éƒ¨ç½²æ–‡ä»¶é…ç½®  </p><p>å®Œæ•´çš„ä»£ç åœ¨ä¸‹æ–¹ï¼Œå½“ä¸­çš„ä¸€äº›ç»†èŠ‚ç”¨æ³¨é‡Šæ ‡å‡º  </p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">server</span> <span class="hljs-string">to</span> <span class="hljs-string">aliyun</span> <br><span class="hljs-attr">on:</span> <br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span> <br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">deploy-and-start:</span><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span> <span class="hljs-comment"># è¿è¡Œç¯å¢ƒ</span><br>    <span class="hljs-attr">steps:</span><br>      <span class="hljs-comment"># åˆ‡æ¢åˆ†æ”¯</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>  <br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@master</span><br><br>      <span class="hljs-comment"># è®¾ç½®sshæ–‡ä»¶</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">ssh</span><br>        <span class="hljs-attr">env:</span><br>          <span class="hljs-comment"># è¿™é‡Œç”¨åˆ°äº†åˆšåˆšçš„ç¯å¢ƒå˜é‡ï¼Œæœ¬æœºçš„ ssh ç§é’¥  </span><br>          <span class="hljs-attr">LOCAL_SSH_PRIVATE_KEY:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.LOCAL_SSH_PRIVATE_KEY</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-comment"># åœ¨è™šæ‹Ÿæœºä¸­ç”Ÿæˆå¯¹åº”çš„ ssh æ–‡ä»¶</span><br>        <span class="hljs-comment"># å¦åˆ™çš„è¯åœ¨ä¸‹é¢çš„ pm2 æ“ä½œä¸­ å°†æ— æ³•éªŒè¯é€šè¿‡  </span><br>        <span class="hljs-attr">run:</span> <span class="hljs-string">|  </span><br><span class="hljs-string">          mkdir -p ~/.ssh/</span><br><span class="hljs-string">          echo &quot;$LOCAL_SSH_PRIVATE_KEY&quot; &gt; ~/.ssh/id_rsa </span><br><span class="hljs-string">          chmod 600 ~/.ssh/id_rsa</span><br><span class="hljs-string"></span><br>      <span class="hljs-comment"># è®¾ç½®node </span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">setup</span> <span class="hljs-string">node</span> <br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v1</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">node-version:</span> <span class="hljs-number">12.16</span><span class="hljs-number">.1</span><br>      <span class="hljs-comment"># å®‰è£…å¯¹åº”çš„æ¨¡å—  </span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          npm install yarn pm2 -g</span><br><span class="hljs-string"></span>      <span class="hljs-comment"># ä»£ç æ›´æ–°è‡³æœåŠ¡å™¨  </span><br>      <span class="hljs-comment"># å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡çš„è¯åˆ™æ‰§è¡Œ pm2 deploy pm2.config.js production setup</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br><span class="hljs-string">          pm2 deploy pm2.config.js production update</span><br><span class="hljs-string"></span><br>      <span class="hljs-comment"># ç™»å½•æœåŠ¡å™¨å¹¶å¯åŠ¨dockeræœåŠ¡   </span><br>      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">start</span> <span class="hljs-string">the</span> <span class="hljs-string">remote</span> <span class="hljs-string">server</span> <br>        <span class="hljs-attr">uses:</span> <span class="hljs-string">appleboy/ssh-action@master</span><br>        <span class="hljs-attr">with:</span><br>          <span class="hljs-attr">username:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.SSH_USERNAME</span> <span class="hljs-string">&#125;&#125;</span><br>          <span class="hljs-attr">password:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.SSH_PASSWORD</span> <span class="hljs-string">&#125;&#125;</span><br>          <span class="hljs-attr">host:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.SSH_IP</span> <span class="hljs-string">&#125;&#125;</span><br>          <span class="hljs-comment"># è¿›å…¥åˆ°æœåŠ¡å™¨çš„é¡¹ç›®è·¯å¾„ä¸‹  </span><br>          <span class="hljs-comment"># å®‰è£…å…¨å±€ä¾èµ–  </span><br>          <span class="hljs-comment"># å®‰è£…é¡¹ç›®ä¾èµ–  </span><br>          <span class="hljs-comment"># å¯åŠ¨/é‡å¯ dockeræœåŠ¡  </span><br>          <span class="hljs-comment"># å¯åŠ¨é¡¹ç›®  </span><br>          <span class="hljs-attr">script:</span> <span class="hljs-string">|</span><br><span class="hljs-string">            cd $&#123;&#123; secrets.REMOTE_PATH &#125;&#125;</span><br><span class="hljs-string">            npm install pm2 yarn -g </span><br><span class="hljs-string">            yarn </span><br><span class="hljs-string">            docker-compose -f docker-compose.yml pull</span><br><span class="hljs-string">            docker-compose -f docker-compose.yml up -d</span><br><span class="hljs-string">            pm2 startOrRestart pm2.config.js</span><br></code></pre></td></tr></table></figure><h3 id="å½“ä¸­çš„é—®é¢˜"><a href="#å½“ä¸­çš„é—®é¢˜" class="headerlink" title="å½“ä¸­çš„é—®é¢˜"></a>å½“ä¸­çš„é—®é¢˜</h3><ol><li>ä¸ºä»€ä¹ˆä½¿ç”¨<code>pm2</code><br><code>node</code>ä½œä¸ºä¸€ä¸ªåå°æœåŠ¡åº”ç”¨ï¼Œä¸åƒå‰ç«¯åº”ç”¨ä¸€æ ·å­˜åœ¨å‘¨æœŸçŸ­ï¼Œå®ƒè¢«è¦æ±‚éœ€è¦é•¿æœŸä¿æŒç¨³å®šçš„å¯åŠ¨çŠ¶æ€ï¼Œå½“ä¸­çš„è®¸å¤šç»†èŠ‚å¦‚æœå•é å¼€å‘è€…æ¥æ§åˆ¶çš„è¯ï¼Œä¼šæ˜¾å¾—ç›¸å½“çš„éº»çƒ¦ï¼Œæ­¤æ—¶ä¾é ä¸<code>pm2</code>æ¥è¿›è¡Œç®¡ç†ä¼šå˜å¾—éå¸¸çš„å®¹æ˜“ã€‚<br><code>pm2</code>å†…ç½®äº†è´Ÿè½½å‡è¡¡ï¼Œå‡ºé”™é‡å¯ï¼Œåå°è¿è¡Œç­‰çš„ç‰¹ç‚¹ï¼Œå¸®åŠ©å¼€å‘è€…åœ¨è¿ç»´å½“ä¸­ç»™åˆ°äº†ç›¸å½“å¤§çš„ä¾¿åˆ©ï¼Œå¹¶ä¸”å®ƒè¿˜èƒ½å¸®ä½ è‡ªåŠ¨éƒ¨ç½²é¡¹ç›®åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚å…·ä½“çš„ç»†èŠ‚å¯è‡ªè¡Œå‰å¾€<a href="https://github.com/Unitech/pm2">github</a>æŸ¥çœ‹  </li><li>ä¸ºä»€ä¹ˆä½¿ç”¨<code>docker</code>  <blockquote><p>Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linuxæˆ–Windowsæ“ä½œç³»ç»Ÿçš„æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ã€‚  </p></blockquote></li></ol><p>æƒ³è±¡ä¸€ä¸‹å½“ä½ è¾›è‹¦çš„åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²å®Œæˆäº†<code>nginx</code>ã€<code>mongodb</code>ã€<code>redis</code>ç­‰æœåŠ¡ä¹‹åï¼ŒæŸä¸€å¤©çªç„¶è¦æ±‚ä½ æ›´æ¢å¦ä¸€å°æœåŠ¡å™¨éƒ¨ç½²ï¼Œä½ æ˜¯å¦éœ€è¦é‡æ–°å°†åˆšåˆšçš„æœåŠ¡é‡æ–°å®‰è£…å¯ç”¨éƒ¨ç½²ï¼Œè¿™æ ·å°±æ˜¾å¾—éå¸¸éº»çƒ¦äº†ã€‚<br>è€Œ<code>docker</code>è¿™ç§å°é—­çš„ï¼Œå¯ç§»æ¤çš„ç‰¹æ€§ï¼Œå¯ä»¥æå¤§çš„ç®€åŒ–æˆ‘ä»¬çš„éƒ¨ç½²æµç¨‹ï¼Œæˆ‘ä»¬åªéœ€é…ç½®ä¸€æ¬¡ï¼Œå³å¯ï¼Œåç»­çš„æ‰€æœ‰æ“ä½œå…¨éƒ¨éƒ½åœ¨<code>docker</code>å®¹å™¨å½“ä¸­è¿›è¡Œã€‚å…·ä½“çš„ç»†èŠ‚ä¸åœ¨æœ¬æ¬¡è®¨è®ºèŒƒå›´ã€‚  </p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>è¿™æ˜¯æœ¬äººåœ¨è‡ªå·±çš„æ‘¸ç´¢ä¸­è¸©å‘çš„ä¸€äº›å†…å®¹ï¼Œå½“ä¸­å¯èƒ½è¿˜ä¸ä¹ä¸€äº›é”™è¯¯ï¼Œæ¬¢è¿æŒ‡æ­£ğŸ™ğŸ»<br>æœ€åï¼Œè¿™æ˜¯æœ¬äººçš„<a href="https://github.com/food-billboard/node-server">åå°æœåŠ¡é¡¹ç›®</a>ï¼Œå…¶ä¸­æœ‰ä¸Šé¢çš„é…ç½®æ–‡ä»¶ç­‰ï¼Œæ¬¢è¿å¤§å®¶å‚è€ƒç‚¹è¯„ğŸ˜ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éƒ¨ç½²</category>
      
      <category>node</category>
      
      <category>åç«¯</category>
      
      <category>ssh</category>
      
      <category>pm2</category>
      
    </categories>
    
    
    <tags>
      
      <tag>node</tag>
      
      <tag>github actions</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹</title>
    <link href="/2020/12/28/%E5%9F%BA%E4%BA%8ETus%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%B5%81%E7%A8%8B/"/>
    <url>/2020/12/28/%E5%9F%BA%E4%BA%8ETus%E5%8D%8F%E8%AE%AE%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%B5%81%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>æœ€è¿‘ä¸€ç›´éƒ½åœ¨å¼„å…³äºæ–‡ä»¶ä¸Šä¼ æ–¹é¢çš„é—®é¢˜ï¼Œå¦‚æœåªæ˜¯å°æ–‡ä»¶çš„è¯ï¼ŒåŸºæœ¬ç›´æ¥<code>post</code>ä¸Šä¼ å°±å¯ä»¥è§£å†³ï¼Œä½†æ˜¯å½“é¢å¯¹å¤§æ–‡ä»¶æ—¶ï¼Œå¦‚æœè¿˜æ˜¯åªç”¨ç®€å•çš„è¯·æ±‚å¯èƒ½æ— æ³•å®Œæˆæ–‡ä»¶çš„ä¸Šä¼ . </p><p>å‡è®¾å½“å‰ç”¨æˆ·è¦ä¸Šä¼ ä¸€ä¸ª<code>2G</code>çš„è§†é¢‘æ–‡ä»¶. å¯èƒ½å°±ä¼šé‡åˆ°è®¸å¤šé—®é¢˜: </p><ol><li>é¦–å…ˆæœ€å¤§çš„é—®é¢˜å°±æ˜¯ï¼ŒæœåŠ¡ç«¯ä¸å¯èƒ½æ¥å—å‰ç«¯åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­ä¸Šä¼ å¦‚æ­¤å¤§çš„<code>body</code>.  </li><li>æ‰€ä»¥ä¸å¾—ä¸é€‰æ‹©å°†å¤§æ–‡ä»¶åˆ†æˆå¤šä¸ªå°æ–‡ä»¶åˆ†å¤šæ¬¡ä¸Šä¼ ï¼ŒåŸºæœ¬å¯ä»¥è§£å†³é—®é¢˜. ä½†æ˜¯å¦‚æœå‡ºç°ä¸€äº›ä¸å¯æ§çš„åŸå› å¯¼è‡´æ–‡ä»¶ä¸Šä¼ ä¸­æ–­ï¼Œç”¨æˆ·åªèƒ½é€‰æ‹©é‡æ–°ä¸Šä¼ ï¼Œè€Œé‡æ–°ä¸Šä¼ æ„å‘³ç€ä¹‹å‰ä¸Šä¼ çš„å†…å®¹åˆå¾—å†ä¸€æ¬¡ä¸Šä¼ ï¼Œå¦‚æœç”¨æˆ·åœ¨ä¸€ä¸ªç½‘ç»œç¯å¢ƒå¾ˆå·®çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ ¹æœ¬æ— æ³•å®Œæˆä¸Šä¼ ã€‚</li></ol><p>åŸºäºä»¥ä¸Šçš„æƒ…å†µï¼Œé€šè¿‡<code>Tus</code>åè®®æ¥å®ç°åˆ†ç‰‡ä¸Šä¼ ä»¥åŠæ–­ç‚¹ç»­ä¼ çš„åŠŸèƒ½ä¾¿èƒ½è¾¾åˆ°ç›¸å½“å¥½çš„ç”¨æˆ·ä½“éªŒã€‚ä¸‹é¢å°±æ¥è®²è®²è¿™ä¸ªå®ç°è¿‡ç¨‹ã€‚</p><h2 id="Tus"><a href="#Tus" class="headerlink" title="Tus"></a>Tus</h2><p>ä»€ä¹ˆæ˜¯<code>Tus</code>ï¼Œ<code>Tus</code>æ˜¯åŸºäº<code>HTTP</code>çš„å¯æ¢å¤æ–‡ä»¶ä¸Šä¼ åè®®ã€‚å¯æ¢å¤æ„å‘³ç€å¯ä»¥éšæ—¶ä¸­æ–­ä¸Šè½½ï¼Œå¹¶ä¸”å¯ä»¥ç»§ç»­ä¸Šè½½è€Œæ— éœ€å†æ¬¡é‡æ–°ä¸Šè½½å…ˆå‰çš„æ•°æ®ã€‚  </p><p><code>Tus</code>å®˜ç½‘ä¸Šæœ‰è®¸å¤šå®ç°çš„åº“å¯ä¾›ä½¿ç”¨ã€‚è€Œä½œä¸ºä¸€ä¸ªå‰ç«¯é€‰æ‰‹ï¼Œå¿…ç„¶ç”¨çš„<code>tus-js-client</code>ï¼Œè€Œæˆ‘ä¸€å¼€å§‹æ¥è§¦çš„æ—¶å€™ç”¨çš„æ˜¯æ–‡ä»¶ä¸Šä¼ å·¥å…·<code>filepond</code>(å…¶å®ä¹‹å‰è¿˜ç”¨è¿‡<code>uppy</code>ï¼Œå› ä¸ºå®ƒ<code>github</code>âœ¨å¤šï¼Œè€Œä¸”å®ƒåŸç”Ÿå°±æ”¯æŒ<code>Tus</code>åè®®ï¼Œä½ é—®æˆ‘ä¸ºä»€ä¹ˆä¸ç”¨é‚£ä¸ªï¼Œå› ä¸ºæˆ‘çœ‹ä¸æ‡‚ğŸ˜¬)ã€‚<br>å¹¸å¥½åœ¨<code>filepond</code>çš„issuesä¸­çœ‹åˆ°è²Œä¼¼å®ƒä¹Ÿå¯ä»¥å’Œ<code>Tus</code>ç»“åˆä½¿ç”¨ğŸ™‚ã€‚  </p><p>å…¶å®<code>filepond</code>ä½¿ç”¨æ¥è¯´è¿˜ç®—æ˜¯ä¸é”™çš„ä½“éªŒï¼Œä½†æ˜¯å®ƒä¼¼ä¹æ²¡æœ‰é’ˆå¯¹<strong>æ–­ç‚¹ç»­ä¼ </strong>æ–¹é¢åšè¿‡å¤„ç†ï¼Œå¯èƒ½ä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºæˆ‘å¤ªèœäº†å§ã€‚  ä¸‹é¢æ˜¯<code>filepond</code>çš„æ ·å­ï¼ŒæŒºå¥½çœ‹ã€‚<br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/filepondæ•ˆæœ.png" /></p><h2 id="å‰åç«¯åŸºæœ¬äº¤äº’æµç¨‹"><a href="#å‰åç«¯åŸºæœ¬äº¤äº’æµç¨‹" class="headerlink" title="å‰åç«¯åŸºæœ¬äº¤äº’æµç¨‹"></a>å‰åç«¯åŸºæœ¬äº¤äº’æµç¨‹</h2><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/tus.jpg" /><p>åŸºäºä¸Šé¢çš„æµç¨‹å›¾è¿™é‡Œç®€å•æè¿°ä¸€ä¸‹å¹¶è®²è®²å…¶ä¸­ä¸€äº›æ³¨æ„çš„åœ°æ–¹ã€‚  </p><ol><li>å®¢æˆ·ç«¯é¦–å…ˆå‘æœåŠ¡ç«¯å‘é€<code>options</code>è¯·æ±‚ã€‚è·å–æœåŠ¡ç«¯çš„é…ç½®ï¼Œ<br>æ¯”å¦‚æœåŠ¡ç«¯æ”¯æŒçš„<code>tus</code>ç‰ˆæœ¬ï¼Œæˆ–è€…æ”¯æŒçš„<code>tus</code>æ‰©å±•ã€‚  </li><li>å¦‚æœæœåŠ¡ç«¯æ”¯æŒï¼Œå®¢æˆ·ç«¯å¯ä»¥é€‰æ‹©:  <ul><li>å‘æœåŠ¡ç«¯å‘èµ·<code>post</code>è¯·æ±‚åˆ›å»ºæ–‡ä»¶å‰¯æœ¬  </li><li>å‘é€<code>post</code>è¯·æ±‚çš„åŒæ—¶å‘é€éƒ¨åˆ†æ–‡ä»¶åˆ†ç‰‡  </li><li>ç›´æ¥å‘é€<code>head</code>è¯·æ±‚å°è¯•æ¢å¤ä¸Šä¼ ï¼Œå¦‚æœå¤±è´¥åˆ™å›é€€åˆ°<code>post</code>åˆ›å»ºæ–‡ä»¶ã€‚  </li></ul></li><li>æœåŠ¡ç«¯è¿”å›æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯ç”¨äºåç»­æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ã€‚  <ul><li>æ¢å¤ä¸Šä¼ : æ ¹æ®æœåŠ¡ç«¯è¿”å›çš„å“åº”å¤´<code>Upload-Offset</code>ä»æŒ‡å®šæ–‡ä»¶ä½ç½®å¼€å§‹æ¢å¤ä¸Šä¼   </li><li>é¦–æ¬¡ä¸Šä¼ : ä»æ–‡ä»¶å¼€å§‹ä½ç½®ä¸Šä¼ ã€‚ä¹Ÿå°±æ˜¯<code>0</code>ã€‚  </li></ul></li><li>é‡å¤å‘èµ·<code>patch</code>è¯·æ±‚å‘é€æ–‡ä»¶åˆ†ç‰‡ï¼Œæ ¹æ®æœåŠ¡ç«¯å“åº”çš„<code>Upload-Offset</code>æ¥ç¡®å®šä¸‹ä¸€åˆ†ç‰‡ä½ç½®ã€‚<br>å¦‚æœå®ƒçš„å€¼ç­‰äºæ–‡ä»¶çš„å¤§å°ï¼Œè¯´æ˜æ–‡ä»¶ä¸Šä¼ å·²ç»å®Œæˆã€‚  </li><li>è‡³æ­¤æ•´ä¸ªæ–‡ä»¶ä¸Šä¼ æµç¨‹å®Œæˆã€‚  </li></ol><h2 id="Tus-æ‰©å±•"><a href="#Tus-æ‰©å±•" class="headerlink" title="Tus æ‰©å±•"></a>Tus æ‰©å±•</h2><p><code>Tus</code>è¿˜æœ‰è®¸å¤šæ‰©å±•ç”¨äºå¸®åŠ©å¼€å‘è€…å®ç°æ›´å¤šçš„åŠŸèƒ½ã€‚åœ¨ä¸Šé¢çš„æµç¨‹ä¸­å·²ç»ç”¨åˆ°äº†ä¸€äº›ã€‚<br>ä»¥ä¸‹æ‰€æœ‰çš„æ‰©å±•éƒ½éœ€è¦æœåŠ¡ç«¯æ”¯æŒã€‚<br>å®˜æ–¹çš„æ–¹æ³•æ˜¯åœ¨<code>options</code>è¯·æ±‚å½“ä¸­çš„å“åº”ä¸­æ ¹æ®<code>Tus-Extension</code>å“åº”å¤´æ¥åˆ†æå…·ä½“æœåŠ¡ç«¯æ‰€æ¥å—çš„æ‰©å±•ã€‚<br>ä¸‹é¢çš„æ‰©å±•ä¼šå½±å“åˆ°ä¸Šé¢è¯·æ±‚æµç¨‹ä¸­çš„å¾ˆå¤šåœ°æ–¹ï¼Œä¹Ÿä¼šåœ¨ä¸‹é¢ä»‹ç»ã€‚(å¾ˆå¤šåœ°æ–¹å…¶å®è¿˜æ˜¯å¯¹å®˜ç½‘çš„ç¿»è¯‘ï¼Œå¦‚æœæœ‰å…´è¶£çš„å¯ä»¥å»å®˜ç½‘ç»§ç»­å­¦ä¹ æ›´å¤šçš„å†…å®¹ğŸ˜Š)  </p><ol><li>Creation<br>åœ¨æ–‡ä»¶ä¸Šä¼ å‰åœ¨æœåŠ¡ç«¯åˆ›å»ºæ–‡ä»¶ä¿¡æ¯<br>å¯ä»¥å°†æ–‡ä»¶çš„ç›¸å…³ä¿¡æ¯é¢„å…ˆåœ¨å­˜å‚¨åœ¨æœåŠ¡ç«¯ï¼Œè¿™æ ·å¯ä»¥ä¸ºåç»­æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ åšå‚ç…§ã€‚<br>æ¯”å¦‚å¯ä»¥å°†æ–‡ä»¶å”¯ä¸€æ ‡è¯†ç¬¦<code>md5</code>å…ˆè¿›è¡Œä¸Šä¼ ï¼ŒæœåŠ¡ç«¯å­˜å‚¨æ•°æ®åº“ï¼Œä¿å­˜æ¯ä¸€ä¸Šä¼ çš„åˆ†ç‰‡ã€‚  </li></ol><p>å‰ç«¯å¯ä»¥æŠŠä¸€äº›æ–‡ä»¶ä¿¡æ¯æ”¾åœ¨<code>Upload-Metadata</code>è¯·æ±‚å¤´ä¸­  </p><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/creation-post-req.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/creation-post-response.png" /><p>æœåŠ¡ç«¯ä¼šè¿”å›<code>Location</code>å‘ŠçŸ¥å‰ç«¯æ–‡ä»¶çš„ä¸Šä¼ åœ°å€ã€‚  </p><ol start="2"><li>Creation-With-Upload<br>åœ¨æœåŠ¡ç«¯åˆ›å»ºè¯·æ±‚ä¸­æ·»åŠ æ–‡ä»¶åˆ†ç‰‡å†…å®¹<br>ä¸ºäº†èŠ‚çœæµé‡ï¼Œåœ¨æœåŠ¡ç«¯å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨å‘æœåŠ¡ç«¯åˆ›å»ºè¯·æ±‚çš„åŒæ—¶ä¹Ÿå°†æŸä¸€åˆ†ç‰‡ä¸€åŒä¸Šä¼ ã€‚  </li></ol><p>å’Œ<code>Creation</code>ç±»ä¼¼ï¼Œä¹Ÿä¼šè¿”å›<code>Location</code>å¤´ï¼ŒåŒæ—¶ä¼šè¿”å›<code>Upload-Offset</code>è®¾ç½®ä¸‹ä¸€åˆ†ç‰‡çš„ç´¢å¼•ã€‚<br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/creation-with-upload-req.png" /><br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/creation-with-upload-res.png" /></p><ol start="3"><li>Expiration<br>ä¸´æ—¶æ–‡ä»¶çš„è¿‡æœŸæ—¶é—´<br>æœåŠ¡ç«¯çš„å­˜å‚¨ç©ºé—´æ¯•ç«Ÿæœ‰é™ï¼Œä¸å¯èƒ½æ— æ—¶é™çš„å°†æ–‡ä»¶çš„åˆ†ç‰‡ä¿å­˜åœ¨æœåŠ¡ç«¯çš„æ•°æ®åº“ä¸­ã€‚<br>æ‰€ä»¥æœåŠ¡ç«¯å¯ä»¥è®¾ç½®åˆ†ç‰‡çš„å­˜å‚¨æ—¶é—´ï¼Œå¹¶é€šè¿‡å“åº”å¤´<code>Upload-Expires</code>å‘ŠçŸ¥å‰ç«¯å®ƒçš„è¿‡æœŸæ—¶é—´ã€‚<br>å½“è¶…è¿‡æœåŠ¡ç«¯è§„å®šçš„æ—¶é—´ä¹‹åï¼Œç”¨æˆ·éœ€è¦é‡æ–°åœ¨æœåŠ¡ç«¯åˆ›å»ºæ–‡ä»¶å‰¯æœ¬ï¼Œé‡æ–°ä¸Šä¼ ã€‚  <img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/expiration-req.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/expiration-res.png" /> </li></ol><p>å½“å‰ç«¯å‘é€æ–‡ä»¶åˆ†ç‰‡å“åº”æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šæ·»åŠ å“åº”å¤´<code>Upload-Expires</code>å‘ŠçŸ¥å‰ç«¯è¯¥åˆ†ç‰‡è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœè¶…è¿‡æ—¶é—´ï¼ŒæœåŠ¡ç«¯å°†ä¼šè¿”å›<code>404</code>ï¼Œå‰ç«¯éœ€è¦é‡æ–°ä¸Šä¼ ã€‚  </p><ol start="4"><li>Checksum<br>åˆ†ç‰‡å¤§å°æ£€æŸ¥<br>æœåŠ¡ç«¯å¯ä»¥å¯¹å‰ç«¯å‘é€çš„æ–‡ä»¶åˆ†ç‰‡è¿›è¡Œæ ¡éªŒã€‚<br>åœ¨ä¸Šä¼ å‰è·å–æœåŠ¡ç«¯ä¸Šä¼ é…ç½®æ”¯æŒåº¦ä¿¡æ¯æ—¶ï¼Œå‰ç«¯å¯ä»¥æ ¹æ®<code>Tus-Checksum-Algorithm</code>å­—æ®µçŸ¥é“æœåŠ¡ç«¯æ”¯æŒçš„åŠ å¯†ç®—æ³•ã€‚  </li></ol><p>æœ‰æ—¶æ— æ³•ä¸€å¼€å§‹å°±åšå‡ºç›¸åº”çš„è®¡ç®—ï¼Œå¹¶ä¸”åœ¨æœåŠ¡ç«¯æ”¯æŒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨<code>Trailer</code>è¯·æ±‚å¤´åœ¨å®Œæˆä¸Šä¼ åå†è¿›è¡Œæ ¡éªŒã€‚<br>æœåŠ¡ç«¯å¯ä»¥åœ¨ä¸€å¼€å§‹<code>options</code>çš„<code>Tus-Extension</code>ä¸­æ·»åŠ <code>Checksum-Trailer</code>å­—æ®µè¡¨ç¤ºæ”¯æŒè¯¥åŠŸèƒ½ã€‚<br>æ¯”å¦‚å¯¹æ–‡ä»¶è¿›è¡Œ<code>md5</code>åŠ å¯†ï¼Œéœ€è¦å¯¹æ–‡ä»¶åˆ†ç‰‡ä¸€ä¸€è¿›è¡Œå¤„ç†ã€‚  </p><p>å½“ä¸Šä¼ æ ¡éªŒå¤±è´¥æ—¶ï¼ŒæœåŠ¡ç«¯ä¾¿ä¼šä¸¢å¼ƒæ­¤åˆ†ç‰‡ï¼Œç´¢å¼•ä¹Ÿä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚<br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/checksum-options-req.png" /><br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/checksum-options-req.png" /><br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/checksum-patch-req.png" /><br><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/checksum-patch-res.png" /> </p><p>ä¸Šè¿°ä¾‹å­ä¸­  </p><ul><li>æœåŠ¡ç«¯<code>options</code>å“åº”ä¸­<code>Tus-Checksum-Algorithm: md5,sha1,crc32</code>å±•ç¤ºäº†å…¶æ”¯æŒçš„æ ¡éªŒç®—æ³•  </li><li>å‰ç«¯<code>patch</code>è¯·æ±‚<code>Upload-Checksum: sha1 Kq5sNclPz7QV2+lfQIuc6R7oRu0=</code>ä½¿ç”¨<code>sha1</code>ç®—æ³•ã€‚  </li><li>æœåŠ¡ç«¯æ ¡éªŒé€šè¿‡è¿”å›<code>204</code></li><li>è‹¥å¤±è´¥ï¼Œåˆ™è¿”å›ä»¥ä¸‹çŠ¶æ€ç (<code>400</code>: ç®—æ³•ä¸æ”¯æŒï¼Œ<code>460</code>: æ ¡éªŒå’Œä¸åŒ¹é…)<br>å®˜ç½‘ä¸Šä»‹ç»<code>The Upload-Checksum request header contains information about the checksum of the current body payload. The header MUST consist of the name of the used checksum algorithm and the Base64 encoded checksum separated by a space.</code><br>å¤§æ¦‚è¯´ä¸Šé¢çš„<code>Upload-Checksum</code>å¤´ç”±<code>sha1</code>ç®—æ³•å’Œç”±<code>base64</code>ç¼–ç çš„æ ¡éªŒå’Œç»„æˆï¼Œä½†æ˜¯æˆ‘ä¸æ˜¯å¤ªèƒ½ç†è§£è¿™ä¸ªï¼Œä¸ç®¡æ˜¯ä½¿ç”¨base64è§£ç æˆ–è€…ç”¨sha1è§£ç ä¼¼ä¹éƒ½æ— æ³•è§£ç å‡º<code>Kq5sNclPz7QV2+lfQIuc6R7oRu0=</code>ï¼Œå¦‚æœæœ‰æ‡‚çš„å¤§ä½¬çš„è¯å¯ä»¥ç»™è§£é‡Šè§£é‡ŠğŸ˜ƒã€‚  </li></ul><ol start="5"><li><p>Termination<br>æ–‡ä»¶åˆ é™¤<br>è¿™ä¸ªåº”è¯¥æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œå°±æ˜¯å‘æœåŠ¡ç«¯è¯·æ±‚åˆ é™¤æ–‡ä»¶ä¿¡æ¯ã€‚  </p><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/termination-req.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/termination-res.png" /></li><li><p>Concatenation<br>å¹¶è¡Œä¸Šä¼ <br>å¯¹äºä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªä¸ªåˆ†ç‰‡ä¸²è¡Œä¸Šä¼ ï¼Œå¯èƒ½è¿˜æ˜¯æœ‰ç‚¹æ…¢ã€‚<br><code>tus</code>æ”¯æŒå¯ä»¥å®è¡Œå¹¶è¡Œä¸Šä¼ ï¼Œå¯ä»¥é’ˆå¯¹åŒä¸€ä¸ªæ–‡ä»¶èµ„æºåœ¨æœåŠ¡ç«¯ç”Ÿæˆå¤šä¸ªä¸Šä¼ åœ°å€ï¼Œè¿™æ ·å°±å¯ä»¥åŒæ—¶ä¸Šä¼ æ–‡ä»¶çš„ä¸åŒåˆ†ç‰‡ã€‚<br>å½“ç„¶è¿™ä¹Ÿéœ€è¦æœåŠ¡ç«¯æ”¯æŒã€‚  </p><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-req-1.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-res-1.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-req-2.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-res-2.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-patch-req-1.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-patch-res-1.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-patch-req-2.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-patch-res-2.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-req-4.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-post-res-4.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-head-req.png" /><img src="/images/åŸºäºTusåè®®çš„æ–‡ä»¶ä¸Šä¼ æµç¨‹/Concatenation-head-res.png" /></li></ol><p>ä¸Šè¿°ä¾‹å­ä¸­</p><ul><li>å…ˆæ˜¯åœ¨å¼€å§‹æ—¶å‘é€ä¸¤ä¸ª<code>post</code>è¯·æ±‚å¹¶æºå¸¦<code>Upload-Concat: partial</code>è¯·æ±‚å¤´ï¼Œåœ¨æœåŠ¡ç«¯ç”Ÿæˆäº†ä¸¤ä¸ªä¸Šä¼ åœ°å€<code>https://tus.example.org/files/a</code>å’Œ<code>https://tus.example.org/files/b</code>  </li><li>æ¥ç€å°±å¯ä»¥åŒæ—¶åœ¨ä¸¤ä¸ªåœ°å€ä¸Šä¼ åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä»¥æ­¤æ¥æé«˜æ•ˆç‡ã€‚  </li><li>å½“ä¸Šä¼ å®Œæ‰€æœ‰åˆ†ç‰‡åï¼Œå‘é€<code>post</code>è¯·æ±‚å¹¶æºå¸¦<code>Upload-Concat: final;/files/a /files/b</code>ï¼Œæ ¼å¼ä¸º<code>final;</code>åŠ ä¸Šä¸Šä¸€æ­¥ä¸­ç”Ÿæˆçš„ä¸Šä¼ åœ°å€ï¼Œä»¥ç©ºæ ¼åˆ†éš”ã€‚æœåŠ¡ç«¯å“åº”åˆæˆè·¯å¾„<code>Location: https://tus.example.org/files/ab</code>å‘ŠçŸ¥å‰ç«¯æ–‡ä»¶çš„åœ°å€ã€‚  è¯¥é¡ºåºéœ€è¦å’Œ<code>post</code>ä¸­è¿”å›çš„åœ°å€é¡ºåºä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´æœåŠ¡ç«¯æ–‡ä»¶åˆ†ç‰‡åˆå¹¶å‡ºé”™ã€‚  </li><li>å‰ç«¯å‘é€<code>head</code>è¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚å®Œæˆè¿™ä¸ªæ–‡ä»¶åˆ†ç‰‡çš„åˆå¹¶ã€‚  </li></ul><p>å°±æˆ‘ä¸ªäººçœ‹æ³•ï¼Œ<code>Tus</code>åè®®æä¾›çš„æ˜¯ä¸€ç§æ€æƒ³ï¼Œè®©æˆ‘ä»¬åœ¨æ–‡ä»¶ä¸Šä¼ ä»»åŠ¡ä¸­å‡ºç°çš„ä»»ä½•æƒ…å†µéƒ½èƒ½å¾—åˆ°ç›¸åº”çš„åº”å¯¹æ–¹æ³•ï¼Œå®Œç¾å®Œæˆæ•´ä¸ªä¸Šä¼ æµç¨‹ã€‚<br>æ‰€åœ¨ä¸Šé¢æ‰€ä»‹ç»çš„æ‰©å±•ï¼Œä¸ä¸¥è°¨çš„è®²ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è‡ªå·±çš„æ–¹æ³•æ¥å®ç°ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯èƒ½è®©ä¸¤ç«¯èƒ½æ›´å¥½çš„ç†è§£å½“å‰çš„æ–‡ä»¶çš„ä¸Šä¼ æƒ…å†µã€‚<br>æˆ‘ä»¬ä¸å¿…å¤ªè¿‡äºæ‹˜æ³¥äºç›¸åº”çš„apiï¼Œåªéœ€è¦èƒ½è®©ä¸¤ç«¯æ›´å¥½ï¼Œæ›´å®¹æ˜“çš„åä½œå°±å¥½ã€‚  </p><p>è¿˜æœ‰ï¼Œåœ¨æˆ‘ä½¿ç”¨å‰ç«¯<code>tus</code>çš„<code>tus-js-client</code>å·¥å…·æ—¶ï¼Œæ£€æŸ¥<code>api</code>ä»‹ç»ä»¥åŠç²—ç•¥æŸ¥æ‰¾äº†ä¸‹æºç ï¼Œçœ‹åˆ°å®ƒä¼¼ä¹å¯¹äº<code>tus</code>æ‰©å±•åªå®ç°äº†<code>Creation</code>ã€<code>Creation-With-Upload</code>ã€<code>Concatenation</code>è¿™å‡ ä¸ªæ‰©å±•ï¼Œå¦‚æœæƒ³ä½¿ç”¨å…¶ä»–æ‰©å±•å¯èƒ½éœ€è¦è‡ªè¡Œå®ç°ã€‚<br>ä¸è¿‡å…¶ä»–å‡ ä¸ªæ‰©å±•çš„é‡ç‚¹åœ¨åç«¯ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯å®ƒæ²¡æœ‰å®ç°çš„åŸå› ã€‚(ä¹Ÿå¯èƒ½æ˜¯æˆ‘æ²¡çœ‹æ‡‚ğŸ˜)  </p><h2 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h2><p>æ–‡ä»¶ä¸Šä¼ å…¶ä¸­è¿˜æœ‰éœ€è¦çš„çŸ¥è¯†ï¼ŒåŒ…æ‹¬æ–‡ä»¶çš„åˆ†ç‰‡ï¼Œå‰ç«¯çš„æ–‡ä»¶å¤„ç†æ–¹å¼ä»¥åŠå…³äºæ–‡ä»¶çš„åŠ å¯†ç­‰ã€‚åŒ…æ‹¬è¿™é‡Œçš„<code>Tus</code>ï¼Œä¹Ÿè¿˜æœ‰å¾ˆå¤šåœ°æ–¹ä¸æ˜¯å¾ˆç†è§£ï¼Œå¦‚æœæœ‰å“ªé‡Œé”™äº†ï¼Œå…ˆé“ä¸ªæ­‰ï¼Œæ¬¢è¿å„ä½ç»™æŒ‡æ­£ã€‚â€“å¥½å¥½å­¦ä¹ ğŸ±ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æ–‡ä»¶</category>
      
      <category>ä¸Šä¼ </category>
      
      <category>å‰ç«¯</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tus upload file</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mongodbå¸¸ç”¨æ“ä½œç¬¦</title>
    <link href="/2020/10/18/mongodb%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%AC%A6/"/>
    <url>/2020/10/18/mongodb%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C%E7%AC%A6/</url>
    
    <content type="html"><![CDATA[<h2 id="MongoDBæ“ä½œç¬¦"><a href="#MongoDBæ“ä½œç¬¦" class="headerlink" title="MongoDBæ“ä½œç¬¦"></a>MongoDBæ“ä½œç¬¦</h2><h3 id="MongoDBä»‹ç»"><a href="#MongoDBä»‹ç»" class="headerlink" title="MongoDBä»‹ç»"></a>MongoDBä»‹ç»</h3><p><code>MongoDB</code> æ˜¯ç”±<code>C++</code>è¯­è¨€ç¼–å†™çš„ï¼Œæ˜¯ä¸€ä¸ªåŸºäºåˆ†å¸ƒå¼æ–‡ä»¶å­˜å‚¨çš„å¼€æºæ•°æ®åº“ç³»ç»Ÿã€‚<br>åœ¨é«˜è´Ÿè½½çš„æƒ…å†µä¸‹ï¼Œæ·»åŠ æ›´å¤šçš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä¿è¯æœåŠ¡å™¨æ€§èƒ½ã€‚<br><code>MongoDB</code> æ—¨åœ¨ä¸ºWEBåº”ç”¨æä¾›å¯æ‰©å±•çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚<br><code>MongoDB</code> å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼(<code>key=&gt;value</code>)<code>å¯¹ç»„æˆã€‚MongoDB</code> æ–‡æ¡£ç±»ä¼¼äº <code>JSON</code> å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚<br>å¦‚ä¸‹è¿™ç§ç»“æ„<br><img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/mongodb-cover-page.png" /></p><h3 id="MongoDBå‘½ä»¤è¡Œç®€å•æ“ä½œ"><a href="#MongoDBå‘½ä»¤è¡Œç®€å•æ“ä½œ" class="headerlink" title="MongoDBå‘½ä»¤è¡Œç®€å•æ“ä½œ"></a>MongoDBå‘½ä»¤è¡Œç®€å•æ“ä½œ</h3><p>å‡è®¾å­˜åœ¨æ•°æ®åº“åç§°ä¸º<code>database</code><br>å¹¶ä¸”å­˜åœ¨ä¸€ä¸ªé›†åˆä¸º<code>collection</code><br>é›†ä¸­<code>collection</code>ä¸­æœ‰å¦‚ä¸‹æ•°æ®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript">[<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Daniel&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">24</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;it&quot;</span>,<br>    <span class="hljs-string">&quot;hobby&quot;</span>: <span class="hljs-string">&quot;travel&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>    <span class="hljs-string">&quot;hobby&quot;</span>: <span class="hljs-string">&quot;travel&quot;</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure><ul><li><p>åˆ›å»ºæ•°æ®åº“æˆ–ä½¿ç”¨æ•°æ®åº“<br><code>use database</code></p></li><li><p>åˆ é™¤æ•°æ®åº“<br><code>db.dropDatabase()</code></p></li><li><p>æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨<br><code>show dbs</code></p></li><li><p>åˆ›å»ºé›†åˆ<br>æ‰§è¡Œ<code>use</code>æ“ä½œå<br><code>db.collection.opertion</code><br>æ²¡æœ‰åˆ›å»ºé›†åˆçš„è¯­æ³•ï¼Œç›´æ¥å¯¹æŒ‡å®šé›†åˆè¿›è¡Œæ“ä½œå°±ä¼šåˆ›å»ºè¯¥é›†åˆ  </p></li><li><p>æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„é›†åˆåˆ—è¡¨<br><code>show collections</code></p></li><li><p>åˆ é™¤é›†åˆ<br><code>db.collection.drop()</code></p></li><li><p>æŸ¥æ‰¾</p></li></ul><ol><li>æ‰§è¡Œ<code>find</code>å‘½ä»¤<br><code>db.collection.find(&#123; hobby: &quot;travel&quot; &#125;)</code><br>å¾—åˆ°ä»¥ä¸‹ç»“æœ<img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/find-common.png"  /></li></ol><p><code>find</code>å‘½ä»¤ä¼šæ‰¾åˆ°ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„æ‰€æœ‰ç»“æœ<br>å¯ä»¥åœ¨åé¢è·Ÿä¸Š<code>.pretty()</code>æ¥è®©æ•°æ®å±•ç¤ºæ›´ç¾è§‚ã€‚<br>åé¢è·Ÿ<code>.count()</code>è¿”å›æŸ¥æ‰¾åˆ°çš„æ•°é‡<br>åé¢è·Ÿ<code>.sort()</code>è¿”å›æ’åºåçš„æ•°æ®<br>æ¯”å¦‚è¿™æ ·<code>db.collection.find(&#123; hobby: &quot;travel&quot; &#125;).sort(&#123; age: 1 &#125;)</code>ï¼Œ<code>1</code>è¡¨ç¤ºå‡åºï¼Œ<code>2</code>é™åº</p><ol start="2"><li>æ‰§è¡Œ<code>findOne</code>å‘½ä»¤<br><code>db.collection.findOne(&#123; hobby: &quot;travel&quot; &#125;)</code>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/findOne.png"  />`findOne`åªä¼šæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡  </li></ol><ul><li>åˆ é™¤</li></ul><ol><li><p>æ‰§è¡Œ<code>deleteOne</code>å‘½ä»¤<br><code>db.collection.deleteOne(&#123; hobby: &quot;travel&quot; &#125;)</code><br>å¾—åˆ°ä»¥ä¸‹ç»“æœ</p><img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/deleteOne.png"  />`deleteOne`å‘½ä»¤ä¼šåˆ é™¤ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ç¬¬ä¸€æ¡æ•°æ®</li><li><p>æ‰§è¡Œ<code>deleteMany</code>å‘½ä»¤<br><code>db.collection.deleteMany(&#123; hobby: &quot;travel&quot; &#125;)</code><br><code>deleteMany</code>å‘½ä»¤ä¼šåˆ é™¤ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„æ‰€æœ‰æ•°æ®</p></li></ol><ul><li>æ’å…¥</li></ul><ol><li><p>æ‰§è¡Œ<code>insertOne</code>å‘½ä»¤<br><code>db.collection.insertOne(&#123; &quot;name&quot;: &quot;Rick&quot;, &quot;age&quot;: 32, &quot;job&quot;: &quot;teacher&quot;, &quot;hobby&quot;: &quot;sport&quot; &#125;)</code><br><code>insertOne</code>å‘½ä»¤å¯ä»¥æ·»åŠ ä¸€æ¡æ•°æ®åˆ°é›†åˆä¸­<br>ä»–æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>&#123; writeConcern &#125;</code>ï¼Œå†™å…¥ç­–ç•¥ï¼Œé»˜è®¤ä¸º 1ï¼Œå³è¦æ±‚ç¡®è®¤å†™æ“ä½œï¼Œ0 æ˜¯ä¸è¦æ±‚ã€‚  </p><img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/insertOne.png"  /></li><li><p>æ‰§è¡Œ<code>insertMany</code>å‘½ä»¤  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.insertMany([<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jack&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">12</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>    <span class="hljs-string">&quot;hobby&quot;</span>: <span class="hljs-string">&quot;watch tv&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mary&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">8</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>    <span class="hljs-string">&quot;hobby&quot;</span>: <span class="hljs-string">&quot;book&quot;</span><br>  &#125;<br>])<br></code></pre></td></tr></table></figure><p><code>insertMany</code>å…è®¸åŒæ—¶æ’å…¥å¤šæ¡æ•°æ®åˆ°é›†åˆä¸­<br>ä»–æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°<code>&#123; writeConcern, ordered &#125;</code>ï¼ŒwriteConcernæ„ä¹‰åŒä¸Šï¼Œorderdè¡¨ç¤ºæ˜¯å¦æŒ‰é¡ºåºå†™å…¥ï¼Œé»˜è®¤ trueï¼ŒæŒ‰é¡ºåºå†™å…¥ã€‚  </p></li></ol><ul><li>æ›´æ–°</li></ul><ol><li><p>æ‰§è¡Œ<code>updateOne</code>å‘½ä»¤<br><code>db.collection.updateOne(&#123; &quot;name&quot;: &quot;Mike&quot; &#125;, &#123; $set: &#123; &quot;age&quot;: 20 &#125; &#125;)</code><br><code>updateOne</code>å‘½ä»¤å¯ä»¥æ›´æ–°åŒ¹é…æ¡ä»¶çš„ç¬¬ä¸€æ¡æ•°æ®</p><img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/updateOne.png"  /></li><li><p>æ‰§è¡Œ<code>updateMany</code>å‘½ä»¤<br><code>db.collection.updateMany(&#123; &quot;hobby&quot;: &quot;travel&quot; &#125;, &#123; &quot;hobby&quot;: &quot;watch tv&quot; &#125;)</code><br><code>updateMany</code>å‘½ä»¤å¯ä»¥æ›´æ–°åŒ¹é…æ¡ä»¶çš„æ‰€æœ‰æ•°æ®</p></li></ol><p>è¿˜æœ‰å‡ ä¸ªå¯é€‰å‚æ•°ï¼Œå¯è‡ªè¡Œç™¾åº¦</p><h3 id="MongoDBæ“ä½œç¬¦-1"><a href="#MongoDBæ“ä½œç¬¦-1" class="headerlink" title="MongoDBæ“ä½œç¬¦"></a>MongoDBæ“ä½œç¬¦</h3><p>æ¥ä¸‹æ¥ä»‹ç»çš„æ˜¯<code>MongoDB</code>ä¸­ä¸€äº›å¸¸ç”¨çš„æ“ä½œç¬¦ï¼Œæš‚æ—¶å°†æ“ä½œç¬¦åˆ†ä¸ºæ›´æ–°å’ŒæŸ¥æ‰¾ä¸¤ç±»ã€‚</p><h4 id="æ›´æ–°æ“ä½œç¬¦"><a href="#æ›´æ–°æ“ä½œç¬¦" class="headerlink" title="æ›´æ–°æ“ä½œç¬¦"></a>æ›´æ–°æ“ä½œç¬¦</h4><h5 id="inc"><a href="#inc" class="headerlink" title="$inc"></a>$inc</h5><p>  å¯¹ä¸€ä¸ªå­—æ®µå¢åŠ æŒ‡å®šæ•°é‡ï¼Œä¸”å­—æ®µçš„å€¼ç±»å‹ä¸ºæ•°å­—<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$inc&quot;</span>: &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">100</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  å½“ç„¶å¯ä»¥é€šè¿‡æŒ‡å®šæ•°å­—å€¼ä¸º<code>è´Ÿæ•°</code>å®ç°é€’å‡æ“ä½œã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$inc.png"  /></p><h5 id="set"><a href="#set" class="headerlink" title="$set"></a>$set</h5><p>  è¿™æ˜¯ç›¸å½“å¸¸è§çš„æ“ä½œç¬¦ï¼Œè¡¨ç¤ºè®¾ç½®æŒ‡å®šçš„<code>key</code><br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$set&quot;</span>: &#123; <span class="hljs-attr">age</span>: <span class="hljs-number">1000</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å°†<code>name</code>ä¸º<code>Mike</code>çš„å­—æ®µçš„<code>age</code>å­—æ®µè®¾ç½®ä¸º<code>1000</code><br>  å¦‚æœ<code>key</code>ä¸å­˜åœ¨çš„è¯åˆ™åˆ›å»º<br>  å½“ç„¶ä¹Ÿå¯ä»¥åŒæ—¶è®¾ç½®å¤šä¸ªå€¼ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœä¿®æ”¹çš„å€¼ä¹‹å‰æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–ä¸€ä¸ªæ•°ç»„çš„è¯ä¼šæ•´ä¸ªè¦†ç›–æ‰è¯¥å€¼ã€‚å…·ä½“çš„ä¿®æ”¹æ–¹æ³•å¯ä»¥å‚ç…§ä¸‹æ–¹çš„å…·ä½“å®ä¾‹ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$set.png"  /></p><h5 id="unset"><a href="#unset" class="headerlink" title="$unset"></a>$unset</h5><p>  å°†æŸä¸€ä¸ªå­—æ®µåˆ é™¤<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$unset&quot;</span>: &#123; <span class="hljs-string">&quot;hobby&quot;</span>: <span class="hljs-string">&quot;&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å°†<code>name</code>ä¸º<code>Mike</code>çš„å­—æ®µçš„<code>hobby</code>å­—æ®µåˆ é™¤ï¼Œå¦‚æœä¸å­˜åœ¨è¯¥å­—æ®µåˆ™ä¸è¿›è¡Œæ“ä½œ<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$unset.png"  /></p><h5 id="push"><a href="#push" class="headerlink" title="$push"></a>$push</h5><p>  å¯¹æŸä¸€å­—æ®µè¿›è¡Œå†…å®¹è¿½åŠ ï¼Œåªèƒ½å¯¹æ•°ç»„å­—æ®µè¿›è¡Œæ“ä½œ(å¦åˆ™ä¼šæŠ¥é”™)ï¼Œä¸å­˜åœ¨åˆ™ç›´æ¥è®¾ç½®ä¸º<code>ç©ºæ•°ç»„</code>å¹¶æ·»åŠ <br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$push&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: <span class="hljs-string">&quot;book&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å°†<code>name</code>ä¸º<code>Mike</code>çš„å­—æ®µçš„<code>like</code>å­—æ®µè®¾ç½®ä¸º<code>[ &quot;book&quot; ]</code><br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$push.png"  /></p><h5 id="pushAll"><a href="#pushAll" class="headerlink" title="$pushAll"></a>$pushAll</h5><p>  ç±»ä¼¼ä¸Šé¢çš„<code>$push</code>æ“ä½œç¬¦ï¼Œä½†æ˜¯æ¥æ”¶çš„å€¼æ—¶ä¸€ä¸ª<code>æ•°ç»„</code>ï¼Œè¡¨ç¤ºå¯åŒæ—¶è¿½åŠ å¤šä¸ªå€¼ï¼ŒåŒæ ·æ˜¯å¯¹æ•°ç»„å­—æ®µè¿›è¡Œæ“ä½œ<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jack&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$pushAll&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: [ <span class="hljs-string">&quot;tv&quot;</span>, <span class="hljs-string">&quot;sport&quot;</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°ç´§æ¥å‰é¢çš„æ“ä½œï¼Œå‘<code>like</code>å­—æ®µä¸­ç»§ç»­è¿½åŠ äº†<code>tv</code>å’Œ<code>sport</code><br>  ä¸è¿‡ä¼¼ä¹åœ¨é«˜ç‰ˆæœ¬<code>mongodb</code>å·²ç»å–æ¶ˆäº†è¿™ä¸ªæ“ä½œç¬¦ï¼Œæœ‰å¾…è€ƒè¯ã€‚</p><h5 id="addToSet"><a href="#addToSet" class="headerlink" title="$addToSet"></a>$addToSet</h5><p>  ç±»ä¼¼ä¸Šé¢çš„<code>$pushAll</code>æ“ä½œç¬¦ï¼Œä¸åŒçš„æ˜¯ï¼Œå½“ä¸”ä»…å½“è¯¥å€¼åœ¨å­—æ®µä¸­<code>ä¸å­˜åœ¨</code>æ—¶æ·»åŠ ï¼Œç›¸å½“äºæ˜¯è‡ªåŠ¨åšäº†å»é‡ã€‚<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$addToSet&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: [ <span class="hljs-string">&quot;tv&quot;</span>, <span class="hljs-string">&quot;hamberger&quot;</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ç»§ç»­ä¸Šé¢çš„<code>like</code>æ·»åŠ æ•°æ®ï¼Œå› ä¸ºä¸Šé¢æ·»åŠ è¿‡<code>tv</code>å­—æ®µï¼Œæ‰€ä»¥å†æ¬¡æ·»åŠ è¢«å¿½ç•¥<br>  å½“ç„¶æ­¤æ“ä½œç¬¦æ·»åŠ çš„å€¼ä¸ä¸€å®šæ˜¯æ•°ç»„ï¼Œä¹Ÿå¯ä»¥è¿™æ ·<br>  <code>$addToSet: &#123; &quot;like&quot;: &quot;hamberger&quot; &#125;</code><br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$addToSet.png"  /></p><h5 id="pop"><a href="#pop" class="headerlink" title="$pop"></a>$pop</h5><p>  ä¸<code>$pop</code>æ“ä½œç¬¦ç›¸åï¼Œè¡¨ç¤ºåˆ é™¤æŒ‡å®šå­—æ®µçš„ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ªå€¼ï¼ŒåŒæ ·åªèƒ½æ˜¯æ•°ç»„<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$pop&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: <span class="hljs-number">1</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°è¡¨ç¤ºåˆ é™¤<code>like</code>å­—æ®µçš„æœ€åä¸€ä¸ªå€¼ã€‚<br>  <code>1</code>è¡¨ç¤ºæœ€åä¸€ä¸ªå€¼ï¼Œ<code>-1</code>è¡¨ç¤ºç¬¬ä¸€ä¸ªå€¼<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$pop.png"  /></p><h5 id="pull"><a href="#pull" class="headerlink" title="$pull"></a>$pull</h5><p>  è¡¨ç¤ºä»æŸä¸€å­—æ®µä¸­åˆ é™¤æŒ‡å®šçš„å€¼ï¼Œé’ˆå¯¹æ•°ç»„<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$pull&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: <span class="hljs-string">&quot;hamberger&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å°†<code>name</code>ä¸º<code>Mike</code>çš„å­—æ®µçš„<code>like</code>æ•°ç»„ä¸­çš„<code>hamberger</code>å­—æ®µåˆ é™¤<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$pull.png"  /></p><h5 id="pullAll"><a href="#pullAll" class="headerlink" title="$pullAll"></a>$pullAll</h5><p>  ç±»ä¼¼<code>$pull</code>æ“ä½œç¬¦ï¼Œä¸åŒçš„æ˜¯å¯ä»¥åŒæ—¶åˆ é™¤å¤šä¸ªå€¼<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-string">&quot;$pullAll&quot;</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: [ <span class="hljs-string">&quot;hamberger&quot;</span>, <span class="hljs-string">&quot;book&quot;</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°åˆ é™¤äº†<code>name</code>ä¸º<code>Mike</code>å­—æ®µçš„<code>like</code>ä¸­çš„<code>hamberger</code>å’Œ<code>book</code><br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$pullAll.png"  /></p><h5 id="rename"><a href="#rename" class="headerlink" title="$rename"></a>$rename</h5><p>  è¿™ä¸ªæ“ä½œç¬¦è¡¨ç¤ºå¯¹ä¹‹å‰è®¾ç½®è¿‡çš„å­—æ®µè¿›è¡Œé‡å‘½åï¼Œè®¾ç½®çš„æ˜¯<code>key</code><br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.updateOne(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>&#125;, &#123;<br>  <span class="hljs-attr">$rename</span>: &#123; <span class="hljs-string">&quot;like&quot;</span>: <span class="hljs-string">&quot;dislike&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å°†<code>like</code>å­—æ®µä¿®æ”¹ä¸ºäº†<code>dislike</code>åç§°ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$rename.png"  /></p><h4 id="æŸ¥æ‰¾æ“ä½œç¬¦"><a href="#æŸ¥æ‰¾æ“ä½œç¬¦" class="headerlink" title="æŸ¥æ‰¾æ“ä½œç¬¦"></a>æŸ¥æ‰¾æ“ä½œç¬¦</h4><p>  ä¸‹é¢ä»‹ç»çš„ï¼Œæ˜¯å¸¸ç”¨çš„æŸ¥è¯¢æ“ä½œç¬¦ğŸŒ°  </p><h5 id="all"><a href="#all" class="headerlink" title="$all"></a>$all</h5><p>  æŸ¥æ‰¾å­—æ®µä¸­åŒ…å«æŒ‡å®šå†…å®¹çš„å€¼ï¼Œä¸”éœ€è¦åŒ…å«å…¨éƒ¨æŒ‡å®šçš„å€¼ï¼Œé’ˆå¯¹æ•°ç»„å‹å­—æ®µ<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;like&quot;</span>: &#123; <span class="hljs-string">&quot;$all&quot;</span>: [ <span class="hljs-string">&quot;hamberger&quot;</span>, <span class="hljs-string">&quot;book&quot;</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°èƒ½æŸ¥æ‰¾åˆ°<code>name</code>ä¸º<code>Mike</code>å­—æ®µï¼Œä½†æ˜¯æ— æ³•æŸ¥æ‰¾åˆ°å…¶ä»–å­—æ®µï¼Œå› ä¸ºä»–ä»¬æ— æ³•å®Œå…¨æ»¡è¶³æŸ¥è¯¢æ¡ä»¶ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$all.png"  /></p><h5 id="gt"><a href="#gt" class="headerlink" title="$gt"></a>$gt</h5><p>  æŸ¥æ‰¾å¤§äº(great then)æŒ‡å®šå€¼çš„å­—æ®µ<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123; <span class="hljs-string">&quot;$gt&quot;</span>: <span class="hljs-number">18</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>age</code>å¤§äº<code>18</code>çš„å­—æ®µï¼Œä¸åŒ…å«<code>18</code><br>  <code>æ—¥æœŸ</code>ä¹Ÿå¯ç›´æ¥é‚£è¿™ä¸ªè¿›è¡Œæ¯”è¾ƒ<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$gt.png"  /></p><h5 id="gte"><a href="#gte" class="headerlink" title="$gte"></a>$gte</h5><p>  è¡¨ç¤ºä¸å°äºæŒ‡å®šå€¼ï¼Œä¹Ÿå°±æ˜¯å¤§äºç­‰äº<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123; <span class="hljs-string">&quot;$gte&quot;</span>: <span class="hljs-number">20</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>age</code>ä¸å°äº<code>20</code>çš„å­—æ®µï¼Œæ‰€ä»¥åŒ…æ‹¬ç­‰äº<code>20</code>çš„å­—æ®µ<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$gte.png"  /></p><h5 id="lt"><a href="#lt" class="headerlink" title="$lt"></a>$lt</h5><p>  ä¸ä¸Šé¢çš„<code>$gt</code>æ“ä½œç¬¦ç›¸åï¼Œè¡¨ç¤ºå°äº(less then)æŒ‡å®šå€¼<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123; <span class="hljs-string">&quot;$lt&quot;</span>: <span class="hljs-number">20</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>age</code>å°äº<code>20</code>çš„å­—æ®µï¼Œä¸”ä¸åŒ…å«<code>20</code><br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$lt.png"  /></p><h5 id="lte"><a href="#lte" class="headerlink" title="$lte"></a>$lte</h5><p>  è¡¨ç¤ºä¸å¤§äºæŒ‡å®šå€¼ï¼Œä¹Ÿå°±æ˜¯å°äºç­‰äº<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: &#123; <span class="hljs-string">&quot;$lte&quot;</span>: <span class="hljs-number">18</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>age</code>å°äº<code>18</code>çš„å­—æ®µï¼Œä¸”åŒ…å«<code>18</code><br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$lte.png"  /></p><h5 id="in"><a href="#in" class="headerlink" title="$in"></a>$in</h5><p>  æŸ¥æ‰¾å­˜åœ¨æŒ‡å®šæ•°ç»„ä¸­å€¼å¾—é¡¹ï¼Œä¸<code>$all</code>ä¸åŒçš„æ˜¯ï¼Œå­—æ®µåªéœ€è¦æ»¡è¶³å…¶ä¸­ä»»æ„ä¸€é¡¹å³å¯<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123; <span class="hljs-string">&quot;$in&quot;</span>: [ <span class="hljs-number">18</span>, <span class="hljs-number">20</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°å¯ä»¥æ‰¾åˆ°æ‰€æœ‰åœ¨<code>age</code>å­—æ®µç­‰äº<code>18</code>æˆ–<code>20</code>çš„æ•°æ®<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$in.png"  /></p><h5 id="nin"><a href="#nin" class="headerlink" title="$nin"></a>$nin</h5><p>  ä¸ä¸Šé¢çš„<code>$in</code>æ“ä½œç¬¦ç›¸åï¼Œè¡¨ç¤ºæŸ¥æ‰¾ä¸å­˜åœ¨æŒ‡å®šæ•°ç»„ä¸­çš„å€¼çš„é¡¹<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;like&quot;</span>: &#123; <span class="hljs-string">&quot;$nin&quot;</span>: [ <span class="hljs-string">&quot;tv&quot;</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>like</code>å­—æ®µä¸­ä¸å­˜åœ¨<code>tv</code>çš„é¡¹<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$nin.png"  /></p><h5 id="ne"><a href="#ne" class="headerlink" title="$ne"></a>$ne</h5><p>  æœ‰ç›¸ç­‰å°±ä¼šæœ‰ä¸ç›¸ç­‰ï¼Œè¿™ä¸ªæ“ä½œç¬¦å°±æ˜¯æŸ¥æ‰¾ä¸ç­‰äºæŒ‡å®šå€¼å¾—é¡¹ï¼Œç›¸å½“äºåªæœ‰ä¸€é¡¹çš„<code>$nin</code><br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;like&quot;</span>: &#123; <span class="hljs-string">&quot;$ne&quot;</span>: <span class="hljs-string">&quot;book&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>like</code>å­—æ®µä¸­ä¸å­˜åœ¨<code>book</code>çš„é¡¹<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$ne.png"  /></p><h5 id="and"><a href="#and" class="headerlink" title="$and"></a>$and</h5><p>  æŸ¥æ‰¾åŒæ—¶æ»¡è¶³æ‰€æœ‰æŒ‡å®šæ¡ä»¶çš„é¡¹ï¼Œå¹¶ä¸”è‡³å°‘éœ€è¦åŒ…å«<strong>ä¸¤ä¸ª</strong>æ¡ä»¶<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;$and&quot;</span>: [<br>    &#123;<br>      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">18</span><br>    &#125;<br>  ]<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>name</code>ä¸º<code>Mike</code>å¹¶ä¸”<code>age</code>ä¸º<code>20</code>çš„å­—æ®µ<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$and.png"  /></p><h5 id="nor"><a href="#nor" class="headerlink" title="$nor"></a>$nor</h5><p>  ä¸ä¸Šé¢çš„<code>$and</code>ç›¸åï¼Œè¡¨ç¤ºæŸ¥æ‰¾åŒæ—¶ä¸æ»¡è¶³æ‰€æœ‰æŒ‡å®šæ¡ä»¶çš„é¡¹ï¼ŒåŒæ ·è‡³å°‘éœ€è¦åŒ…å«<strong>ä¸¤ä¸ª</strong>æ¡ä»¶<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;$nor&quot;</span>: [<br>    &#123;<br>      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">18</span><br>    &#125;<br>  ]<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>name</code>ä¸ä¸º<code>Mike</code>å¹¶ä¸”<code>age</code>ä¸ç­‰äº<code>18</code>çš„æ•°æ®<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$nor.png"  /></p><h5 id="not"><a href="#not" class="headerlink" title="$not"></a>$not</h5><p>  æŒ‡å®šä¸èƒ½æ»¡è¶³æŒ‡å®šæ¡ä»¶çš„æ•°æ®é¡¹ï¼Œæ­¤æ“ä½œç¬¦åªèƒ½åŒ…å«<strong>ä¸€ä¸ª</strong>æ¡ä»¶ï¼Œè€Œä¸”å®ƒæ— æ³•å•ç‹¬å®ŒæˆæŸ¥è¯¢ï¼Œéœ€è¦ä¸å…¶ä»–æ“ä½œç¬¦é…åˆä¸€èµ·ä½¿ç”¨ã€‚<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;$not&quot;</span>: &#123; <span class="hljs-string">&quot;$gt&quot;</span>: <span class="hljs-number">18</span> &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>age</code>å­—æ®µå°äºç­‰äº<code>18</code>çš„æ•°æ®é¡¹ï¼Œå½“ç„¶åƒä¾‹å­è¿™æ ·çš„æƒ…å†µä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨<code>$lte</code>æ“ä½œç¬¦å®Œæˆã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$not.png"  /></p><h5 id="or"><a href="#or" class="headerlink" title="$or"></a>$or</h5><p>  è¡¨ç¤ºæŸ¥æ‰¾èƒ½è‡³å°‘æ»¡è¶³<strong>ä¸€ä¸ª</strong>æ¡ä»¶çš„é¡¹ï¼Œå¹¶ä¸”éœ€è¦è‡³å°‘åŒ…å«<strong>ä¸¤ä¸ª</strong>ç­›é€‰æ¡ä»¶<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;$or&quot;</span>: [<br>    &#123;<br>      <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span><br>    &#125;,<br>    &#123;<br>      <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">20</span><br>    &#125;<br>  ]<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°è¡¨ç¤ºæŸ¥æ‰¾<code>name</code>ä¸º<code>Mike</code>æˆ–è€…<code>age</code>ä¸º<code>20</code>çš„æ•°æ®é¡¹<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$or.png"  /></p><h5 id="exists"><a href="#exists" class="headerlink" title="$exists"></a>$exists</h5><p>  æ­¤æ“ä½œç¬¦ç”¨äºå­—æ®µçš„<code>key</code>çš„åˆ¤æ–­ï¼Œè¡¨ç¤ºæŸ¥æ‰¾æ˜¯å¦å­˜åœ¨å¦å­—æ®µ<code>key</code>çš„æ•°æ®é¡¹ï¼Œå¯é€‰å€¼ä¸º<code>true</code>å’Œ<code>false</code>ï¼Œé€‰æ‹©<strong>true</strong>è¡¨ç¤ºå­˜åœ¨ï¼Œ<strong>false</strong>åˆ™ä¸å­˜åœ¨æŒ‡å®šå­—æ®µçš„é¡¹<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: &#123; <span class="hljs-string">&quot;$exists&quot;</span>: <span class="hljs-literal">true</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾å­˜åœ¨<code>name</code>å­—æ®µçš„æ•°æ®é¡¹<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$exists.png"  /></p><h5 id="mod"><a href="#mod" class="headerlink" title="$mod"></a>$mod</h5><p>  è¡¨ç¤ºæŸ¥æ‰¾æ»¡è¶³è®¡ç®—ç»“æœçš„æ•°æ®é¡¹ï¼Œæ­¤æ“ä½œç¬¦ä¸ºå–æ¨¡<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;age&quot;</span>: &#123; <span class="hljs-string">&quot;$mod&quot;</span>: [ <span class="hljs-number">3</span>, <span class="hljs-number">0</span> ] &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°è¡¨ç¤º<code>age</code>å­—æ®µçš„å€¼å¯¹3å–æ¨¡ç­‰äº0çš„å€¼ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$mod.png"  /></p><h5 id="type"><a href="#type" class="headerlink" title="$type"></a>$type</h5><p>  è¡¨ç¤ºé€‰æ‹©æŒ‡å®šæ•°æ®ç±»å‹çš„æ•°æ®é¡¹<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: &#123; <span class="hljs-string">&quot;$type&quot;</span>: <span class="hljs-string">&quot;string&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>name</code>å­—æ®µå€¼ç±»å‹ä¸º<code>string</code>çš„æ•°æ®é¡¹<br>  æ­¤æ“ä½œç¬¦è¡¨ç¤ºèƒ½æŸ¥æ‰¾å¯¹åº”çš„æ•°æ®ç±»å‹çš„æ•°æ®é¡¹ï¼Œå®ƒä¹Ÿæœ‰å¯¹åº”çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤º</p><blockquote><p>Double: 1<br>  String<br>  Object    3<br>  Array    4<br>  Binary data    5<br>  Undefined    6    å·²åºŸå¼ƒã€‚<br>  Object id    7<br>  Boolean    8<br>  Date    9<br>  Null    10<br>  Regular Expression    11<br>  JavaScript    13<br>  Symbol    14<br>  JavaScript (with scope)    15<br>  32-bit integer    16<br>  Timestamp    17<br>  64-bit integer    18<br>  Min key    255    Query with -1.<br>  Max key    127<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$type.png"  /></p></blockquote><h5 id="regex"><a href="#regex" class="headerlink" title="$regex"></a>$regex</h5><p>  å°±æ˜¯å­—é¢æ„æ€ï¼Œä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é…å­—æ®µ<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: &#123; <span class="hljs-string">&quot;$regex&quot;</span>: <span class="hljs-regexp">/mike/</span>, <span class="hljs-string">&quot;$options&quot;</span>: <span class="hljs-string">&quot;i&quot;</span> &#125;<br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°åŒ¹é…<code>name</code>å­—æ®µå€¼åŒ…å«<code>mike</code>ï¼ˆä¸åŒºåˆ†å¤§å°å†™æ˜¯å› ä¸ºé…ç½®äº†<code>$options</code>ï¼‰çš„æ•°æ®é¡¹<br>  <code>$options</code>è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œå…¶ä»–çš„è¿˜æœ‰<code>i</code>(ä¸åŒºåˆ†å¤§å°å†™),<code>g</code>(å…¨å±€åŒ¹é…),<code>m</code>(å¤šè¡ŒåŒ¹é…),<code>s</code>(.åŒ…å«æ¢è¡Œç¬¦<code>\n</code>)<br>  å½“ç„¶ç›´æ¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$regex.png"  /></p><h5 id="where"><a href="#where" class="headerlink" title="$where"></a>$where</h5><p>  æœ‰äº›æƒ…å†µä¸‹æ™®é€šæ–¹æ³•å¾ˆéš¾åšå‡ºç­›é€‰ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ“ä½œç¬¦ç”¨<code>javascript</code>è¯­æ³•æ¥è¿›è¡Œç­›é€‰<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">db.collection.find(&#123;<br>  <span class="hljs-string">&quot;$where&quot;</span>: <span class="hljs-string">&quot;this.name=&#x27;Jack&#x27;&amp;&amp;this.like.some(key =&gt; key == &#x27;hamberger&#x27;)&quot;</span><br>&#125;)<br></code></pre></td></tr></table></figure><br>  ä¸Šè¿°æŸ¥æ‰¾<code>name</code>ä¸º<code>Jack</code>ä¸”<code>like</code>å­—æ®µåŒ…å«<code>hamberger</code>å€¼å¾—æ•°æ®é¡¹<br>  å®ƒç”šè‡³å¯ä»¥ç›´æ¥å†™ä¸€ä¸ªå‡½æ•°<code>&#123; function() &#123; return this.name == &#39;Jack&#39; &amp;&amp; this.like.some(key =&gt; key == &#39;hamberger&#39;) &#125; &#125;</code><br>  <strong>æ³¨æ„</strong><br>  è™½ç„¶è¿™ç§æ–¹æ³•å¯ä»¥æœ‰æ•ˆçš„è§£å†³ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯å°½é‡ä¸è¦ä½¿ç”¨è¿™ä¸ªæ“ä½œç¬¦ï¼Œå› ä¸ºå®ƒä¼šå°†MongoDBé‡Œé¢ä¿å­˜çš„BSONæ•°æ®å˜ä¸ºJavaScriptçš„è¯­æ³•ç»“æ„ï¼Œè¿™æ ·çš„æ–¹å¼ä¸æ–¹ä¾¿ä½¿ç”¨æ•°æ®åº“çš„ç´¢å¼•æœºåˆ¶ã€‚<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$where.png"  /></p><h5 id="elemMatch"><a href="#elemMatch" class="headerlink" title="$elemMatch"></a>$elemMatch</h5><p>  æ­¤æ“ä½œç¬¦ç”¨äºå¯¹ç±»ä¼¼ä¸€ä¸ªåµŒå¥—æ•°ç»„å¯¹è±¡æ¥è¿›è¡Œå¤šæ¡ä»¶çš„æŸ¥è¯¢<br>  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$elemMatch.png"  /><br>  ä¸Šè¿°æŸ¥æ‰¾äº†<code>like</code>å­—æ®µæ•°ç»„ä¸­<code>type</code>ä¸º<code>eat</code>å¹¶ä¸”<code>target</code>ä¸º<code>hamberger</code>çš„æ•°æ®é¡¹  </p><h5 id="slice"><a href="#slice" class="headerlink" title="$slice"></a>$slice</h5><p>  å°†æ•°æ®ä¸­çš„æ•°ç»„å­—æ®µåšåˆ‡å‰²ï¼Œé€‰å‡ºä¸€æ®µé€‰åŒº<br>  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// åŸºæœ¬æŸ¥è¯¢</span><br>db.collection.find(&#123;&#125;, &#123;<br>  <span class="hljs-attr">like</span>: &#123;<br>    <span class="hljs-attr">$slice</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>]<br>  &#125;<br>&#125;)<br><span class="hljs-comment">//èšåˆæŸ¥è¯¢</span><br>db.collection.aggregate([<br>  &#123;<br>    <span class="hljs-attr">$project</span>: &#123;<br>      <span class="hljs-attr">like</span>: &#123;<br>        <span class="hljs-attr">$slice</span>: [ <span class="hljs-string">&quot;$like&quot;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span> ]<br>      &#125;<br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure><br>  ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½èƒ½å–å‡ºå¯¹åº”çš„æ•°ç»„é¡¹çš„ç¬¬ä¸€æ¡ï¼Œä¸¤ä¸ªæ•°å­—åˆ†åˆ«ä»£è¡¨ï¼šèµ·å§‹çš„ç´¢å¼•ã€åˆ‡å‰²çš„æ•°é‡  </p><ul><li>åŸºæœ¬æŸ¥è¯¢<img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$slice-normal.jpg"  />  </li><li>èšåˆæŸ¥è¯¢  <img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/$slice-aggregate.jpg" /></li></ul><h3 id="ç›¸å…³å®ä¾‹"><a href="#ç›¸å…³å®ä¾‹" class="headerlink" title="ç›¸å…³å®ä¾‹"></a>ç›¸å…³å®ä¾‹</h3><p>è®²å®Œäº†æ“ä½œç¬¦ï¼Œè¿™é‡Œç®€å•è®²å‡ ä¸ªä¹‹å‰åœ¨å®è·µå½“ä¸­ç¢°åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠè§£å†³æ–¹æ³•ï¼Œæ¬¢è¿å„ä½å‚è€ƒã€‚  </p><h5 id="æŸ¥æ‰¾æˆ–ä¿®æ”¹æ•°ç»„ä¸­åµŒå¥—çš„å¯¹è±¡çš„å±æ€§"><a href="#æŸ¥æ‰¾æˆ–ä¿®æ”¹æ•°ç»„ä¸­åµŒå¥—çš„å¯¹è±¡çš„å±æ€§" class="headerlink" title="æŸ¥æ‰¾æˆ–ä¿®æ”¹æ•°ç»„ä¸­åµŒå¥—çš„å¯¹è±¡çš„å±æ€§"></a>æŸ¥æ‰¾æˆ–ä¿®æ”¹æ•°ç»„ä¸­åµŒå¥—çš„å¯¹è±¡çš„å±æ€§</h5><p>å‡è®¾<code>database</code>çš„<code>collection</code>ä¸­å­˜åœ¨ä»¥ä¸‹æ•°æ®  </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript">[<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Mike&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">18</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;student&quot;</span>,<br>    <span class="hljs-string">&quot;like&quot;</span>: [<br>      &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;eat&quot;</span>,<br>        <span class="hljs-string">&quot;target&quot;</span>: <span class="hljs-string">&quot;hamberger&quot;</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;sport&quot;</span>,<br>        <span class="hljs-string">&quot;target&quot;</span>: <span class="hljs-string">&quot;running&quot;</span><br>      &#125;<br>    ]<br>  &#125;,<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jack&quot;</span>,<br>    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">50</span>,<br>    <span class="hljs-string">&quot;job&quot;</span>: <span class="hljs-string">&quot;teacher&quot;</span>,<br>    <span class="hljs-string">&quot;like&quot;</span>: [<br>      &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;eat&quot;</span>,<br>        <span class="hljs-string">&quot;target&quot;</span>: <span class="hljs-string">&quot;vegetable&quot;</span><br>      &#125;,<br>      &#123;<br>        <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;sport&quot;</span>,<br>        <span class="hljs-string">&quot;target&quot;</span>: <span class="hljs-string">&quot;baseball&quot;</span><br>      &#125;<br>    ]<br>  &#125;<br>]<br></code></pre></td></tr></table></figure><p>æ™®é€šæƒ…å†µä¸‹æ— æ³•ç›´æ¥é€‰ä¸­å¯¹åº”æ•°ç»„å¯¹è±¡çš„å±æ€§ï¼Œä½†æ˜¯<code>mongodb</code>ä¸­æ”¯æŒ<code>.</code>æ¥é€‰æ‹©æ•°ç»„å¯¹è±¡ä¸­çš„å±æ€§  </p><ul><li><p><code>parent_field.child_field</code><br>æ¯”å¦‚åƒä¸Šé¢çš„<code>like</code>å­—æ®µé€‰æ‹©<code>target=vegetable</code><br><code>db.collection.find(&#123; &quot;like.target&quot;: &quot;vegetable&quot; &#125;)</code></p><img src="/images/mongodbå¸¸ç”¨æ“ä½œç¬¦/æ•°ç»„å¯¹è±¡åµŒå¥—æŸ¥è¯¢.png"  /><h5 id="ä¿®æ”¹å¤šå±‚åµŒå¥—çš„æ•°ç»„å¯¹è±¡"><a href="#ä¿®æ”¹å¤šå±‚åµŒå¥—çš„æ•°ç»„å¯¹è±¡" class="headerlink" title="ä¿®æ”¹å¤šå±‚åµŒå¥—çš„æ•°ç»„å¯¹è±¡"></a>ä¿®æ”¹å¤šå±‚åµŒå¥—çš„æ•°ç»„å¯¹è±¡</h5><p>æœ‰æ—¶å€™ä¸æ­¢ä¼šæœ‰ä¸€å±‚åµŒå¥—ï¼Œå¤šå±‚åµŒå¥—ä¸Šé¢çš„æ–¹æ³•ä¸é€‚ç”¨ï¼Œè™½ç„¶è¿™ç§å­˜å‚¨æ–¹å¼ä¸å¤ªå¸¸è§ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥è§£å†³<br>å‡è®¾æœ‰å¦‚ä¸‹çš„æ•°æ®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs javascript">[<br>  &#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Jack&quot;</span>,<br>    <span class="hljs-string">&quot;like&quot;</span>: [<br>      &#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;eat&quot;</span>,<br>        <span class="hljs-attr">target</span>: [<br>          &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;hamberger&quot;</span>,<br>            <span class="hljs-attr">price</span>: <span class="hljs-number">100</span><br>          &#125;,<br>          &#123; <br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;salad&quot;</span>,<br>            <span class="hljs-attr">price</span>: <span class="hljs-number">200</span><br>          &#125;<br>        ]<br>      &#125;<br>    ]<br>  &#125;<br>]<br><br><span class="hljs-comment">//æ‰§è¡Œæ›´æ–°æ“ä½œ</span><br>db.collection.updateOne(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Jack&quot;</span> &#125;, &#123; <span class="hljs-attr">$set</span>: &#123; <span class="hljs-string">&quot;like.$[stepone].target.$[steptwo].price&quot;</span> : <span class="hljs-number">200</span> &#125; &#125;, &#123;<br> <span class="hljs-attr">arrayFilters</span>: [<br>  &#123;<br>   <span class="hljs-string">&quot;stepone&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;$type&quot;</span>: <span class="hljs-string">&quot;object&quot;</span><br>   &#125;,<br>   <span class="hljs-string">&quot;stepone.type&quot;</span>: <span class="hljs-string">&quot;eat&quot;</span> <br>  &#125;,<br>  &#123;<br>   <span class="hljs-string">&quot;steptwo&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;$type&quot;</span>: <span class="hljs-string">&quot;object&quot;</span><br>   &#125;<br>  &#125;<br> ]<br>&#125;)<br></code></pre></td></tr></table></figure><p>ä¸Šè¿°æ“ä½œæ˜¯é€‰æ‹©ä¸Šé¢æ•°æ®ä¸­<code>like</code>å­—æ®µçš„<code>type</code>ä¸º<code>eat</code>å¹¶ä¸”<code>target</code>æ•°ç»„ä¸­çš„<code>name</code>ä¸º<code>hamberger</code>çš„ä»·æ ¼<code>price</code>æ”¹æˆäº†200<br><code>updateOne</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°ç”¨æˆ·å®šä¹‰ç¬¬äºŒå‚æ•°ä¸­ç”¨åˆ°çš„åµŒå¥—åç§°çš„ç­›é€‰æ¡ä»¶ï¼Œå¹¶ä¸”å®ƒçš„åç§°å®šä¹‰ä¸º<strong>ä»¥å°å†™å­—æ¯å¼€å¤´çš„å­—æ¯æ•°å­—å­—ç¬¦ä¸²</strong>  </p></li></ul><h3 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h3><p><code>MongoDB</code>çš„æ“ä½œç¬¦ä»¥åŠå‘½ä»¤è¿œä¸æ­¢è¿™äº›ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œå»MongoDBå®˜ç½‘æŸ¥æ‰¾å­¦ä¹ ï¼Œæœ¬äººä¹Ÿä¼šåœ¨åç»­çš„å®è·µå­¦ä¹ ä¸­ç»§ç»­æ›´æ–°ã€‚ğŸ˜¸</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®åº“</category>
      
      <category>mongodb</category>
      
      <category>node</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>database</tag>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Chai</title>
    <link href="/2020/08/28/Chai/"/>
    <url>/2020/08/28/Chai/</url>
    
    <content type="html"><![CDATA[<h2 id="Chaiä»‹ç»"><a href="#Chaiä»‹ç»" class="headerlink" title="Chaiä»‹ç»"></a>Chaiä»‹ç»</h2><p>Chai æ˜¯ä¸€ä¸ªé’ˆå¯¹ Node.js å’Œæµè§ˆå™¨çš„è¡Œä¸ºé©±åŠ¨æµ‹è¯•å’Œæµ‹è¯•é©±åŠ¨æµ‹è¯•çš„è¯Šæ–­åº“ï¼Œå¯ä¸ä»»ä½• JavaScript æµ‹è¯•æ¡†æ¶é›†æˆã€‚<br>æœ¬æ–‡ä»‹ç»çš„Chaiä¸‹çš„expect/shouldé£æ ¼å±äºBDD(è¡Œä¸ºé©±åŠ¨å¼€å‘)<br>å› ä¸ºæœ¬èº«è¯­æ³•ç›¸å¯¹ç®€å•ï¼Œæ‰€ä»¥æœ¬æ–‡æ˜¯ç±»ä¼¼äºapiçš„ä¸­æ–‡æ–‡æ¡£ï¼Œå…¶ä¸­æœ‰è®¸å¤šä¸è¶³ï¼Œè§è°…ã€‚</p><h2 id="æ­£ç‰‡å¼€å§‹"><a href="#æ­£ç‰‡å¼€å§‹" class="headerlink" title="æ­£ç‰‡å¼€å§‹"></a>æ­£ç‰‡å¼€å§‹</h2><ul><li><code>to</code></li><li><code>be</code></li><li><code>been</code></li><li><code>is</code></li><li><code>that</code></li><li><code>which</code></li><li><code>and</code></li><li><code>has</code></li><li><code>have</code></li><li><code>with</code></li><li><code>at</code></li><li><code>of</code></li><li><code>same</code><br>ä»¥ä¸Šä»…åšè¯­ä¹‰åŒ–ç”¨ï¼Œæ— å®é™…ä½œç”¨</li></ul><h3 id="å…·ä½“apiä»‹ç»"><a href="#å…·ä½“apiä»‹ç»" class="headerlink" title="å…·ä½“apiä»‹ç»"></a>å…·ä½“apiä»‹ç»</h3><p><span id="top"></span></p><ul><li><a href="#not">not</a><br>å¯¹ä¹‹åçš„æ–­è¨€å–å</li><li><a href="#deep">deep</a><br>é’ˆå¯¹å¯¹è±¡ã€æ•°ç»„ç­‰è¿›è¡Œæ·±å±‚æ¬¡çš„é”®å€¼å¯¹åˆ¤æ–­</li><li><a href="#any">any</a><br>ä¸<code>keys</code>ä¸€åŒä½¿ç”¨æ—¶è¡¨ç¤ºè‡³å°‘æ»¡è¶³ä¸€é¡¹</li><li><a href="#all">all</a><br>ä¸keysä¸€åŒä½¿ç”¨æ—¶è¡¨ç¤ºè‡³å°‘å…¨éƒ¨æ»¡è¶³</li><li><a href="#a">a | an</a><br>æ—¢å¯åšé“¾å¼è°ƒç”¨ä¹Ÿå¯åšæ–­è¨€</li><li><a href="#include">include | contains</a><br>æ˜¯å¦åŒ…å«æŒ‡å®šçš„å€¼ æ—¢å¯åšé“¾å¼è°ƒç”¨ä¹Ÿå¯åšæ–­è¨€</li><li><a href="#nested">nested</a><br>ç”¨äºåœ¨<code>property</code>ã€<code>include</code>ç­‰ç”¨<code>.</code>è¯­æ³•è·å–æ·±å±‚æ¬¡å±æ€§</li><li><a href="#ok">ok</a><br>çœŸå€¼</li><li><a href="#true">true</a><br>true</li><li><a href="#false">false</a><br>false</li><li><a href="#null">null</a><br>null</li><li><a href="#undefined">undefined</a><br>undefined</li><li><a href="#NaN">NaN</a><br>NaN</li><li><a href="#exist">exist</a><br>énull éundefined</li><li><a href="#finite">finite</a><br>é<code>NaN</code> é<code>Infinity</code></li><li><a href="#empty">empty</a><br>åˆ¤æ–­å€¼é•¿åº¦ä¸º<code>0 [] &#39;&#39; &#123;&#125;</code></li><li><a href="#arguments">arguments</a><br>æ˜¯å¦ä¸ºargumentså¯¹è±¡</li><li><a href="#equal">equal</a><br><code>===</code></li><li><a href="#eql">eql</a><br>ç›¸å½“äº<code>deep</code>å’Œ<code>equal</code>çš„ç®€å†™</li><li><a href="#above">above</a><br>å¤§äº</li><li><a href="#least">least</a><br>å¤§äºç­‰äº</li><li><a href="#below">below</a><br>å°äº</li><li><a href="#most">most</a><br>å°äºç­‰äº</li><li><a href="#within">within</a><br>åŒºé—´å†…(æ•°å­—)</li><li><a href="#instanceof">instanceof</a><br>æ˜¯å¦ä¸ºè¯¥å®ä¾‹</li><li><a href="#property">property</a><br>æ˜¯å¦æ‹¥æœ‰æŒ‡å®šå±æ€§</li><li><a href="#ownProperty">ownProperty</a><br>æ˜¯å¦æ‹¥æœ‰è‡ªèº«çš„å±æ€§</li><li><a href="#ownPropertyDescriptor">ownPropertyDescriptor</a><br>å±æ€§æè¿°å¯¹è±¡</li><li><a href="#lengthOf">length</a><br>lengthå±æ€§</li><li><a href="#lengthOf">lengthOf</a><br>æ˜¯å¦ä¸ºæŒ‡å®šé•¿åº¦å€¼</li><li><a href="#match">match</a><br>æ˜¯å¦åŒ¹é…æŒ‡å®šæ­£åˆ™</li><li><a href="#string">string</a><br>æ˜¯å¦åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²</li><li><a href="#keys">keys</a><br>é…åˆå…¶ä»–å­—æ®µä½¿ç”¨ï¼Œæ˜¯å¦åŒ…å«æˆ–ä¸åŒ…å«æŒ‡å®šçš„key</li><li><a href="#throw">throw</a><br>æ˜¯å¦æŠ›å‡ºæŒ‡å®šé”™è¯¯æˆ–å­—ç¬¦ä¸²æˆ–åŒ¹é…æŒ‡å®šé”™è¯¯ä¿¡æ¯</li><li><a href="#respondTo">respondTo</a><br>æ–­è¨€æ˜¯å¦ä¼šå“åº”ä¸€ä¸ªæ–¹æ³•</li><li><a href="#itself">itself</a><br>é…åˆ<code>respondTo</code>ç”¨æ¥åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªèº«çš„æ–¹æ³•</li><li><a href="#satisfy">satisfy</a><br>è¿”å›ä¸€ä¸ªå‡½æ•°ä¸”å‚æ•°ä¸ºç›®æ ‡å€¼ä¸”è¿”å›å€¼ä¸º<code>boolean</code>ï¼Œç”¨æ¥æŒ‡å®šæ˜¯å¦é€šè¿‡æ£€æµ‹</li><li><a href="#closeTo">closeTo</a><br>åˆ¤æ–­å€¼æ˜¯å¦åœ¨æœŸæœ›å€¼æ¥æ”¶èŒƒå›´å†…</li><li><a href="#members">members</a><br>ç±»ä¼¼äº<code>contains</code>ã€<code>include</code>ï¼Œä½†æ˜¯èƒ½æ¥æ”¶æ•°ç»„ï¼Œä¸»è¯­åªèƒ½æ˜¯æ•°ç»„</li><li><a href="#oneOf">oneOf</a><br>åˆ¤æ–­å€¼æ˜¯å¦å‡ºç°åœ¨æŒ‡å®šæ•°ç»„ä¸­ </li><li><a href="#change">change</a><br>åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šæ”¹å˜æŒ‡å®šå¯¹è±¡çš„æŒ‡å®šå±æ€§çš„å€¼ </li><li><a href="#increase">increase</a><br>åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šå¢åŠ æŒ‡å®šå¯¹è±¡çš„å±æ€§çš„å€¼</li><li><a href="#decrease">decrease</a><br>åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šå‡å°‘æŒ‡å®šå¯¹è±¡çš„å±æ€§çš„å€¼</li><li><a href="#extensible">extensible</a><br>åˆ¤æ–­æŒ‡å®šå€¼æ˜¯å¦å¯æ‰©å±•(å¯ä»¥æ·»åŠ æ–°å±æ€§)</li><li><a href="#sealed">sealed</a><br>åˆ¤æ–­æŒ‡å®šå€¼æ˜¯å¦å°é—­(ä¸å¯æ·»åŠ æ–°å±æ€§ã€ä¸å¯åˆ é™¤æ—§å±æ€§ã€å¯ä¿®æ”¹æ—§å±æ€§)</li><li><a href="#frozen">frozen</a><br>åˆ¤æ–­å€¼æ˜¯å¦å†»ç»“(ä¸å¯æ·»åŠ æ–°å±æ€§ã€ä¸å¯åˆ é™¤æ—§å±æ€§ã€ä¸å¯ä¿®æ”¹æ—§å±æ€§)</li><li><a href="#own">own</a><br>åˆ¤æ–­å€¼æ˜¯å¦æ‹¥æœ‰æŒ‡å®šçš„å±æ€§ï¼Œä¸åŒ…å«ä¸Šå±‚å±æ€§</li><li><a href="#by">by</a><br>é…åˆ<code>descrease</code> æˆ– <code>increase</code>ã€ <code>change</code>ç­‰æ¥åˆ¤æ–­æ–­è¨€å€¼æ˜¯å¦å‘ç”Ÿå˜åŒ–åœ¨æŒ‡å®šèŒƒå›´å†…</li><li><a href="#fail">fail</a><br>åˆ¤æ–­æ˜¯å¦ä¼šå¤±è´¥</li><li><a href="#ordered">ordered</a><br>é…åˆ<code>members</code>ç”¨äºæŒ‡å®š<code>members</code>å‚æ•°æ•°ç»„çš„é¡ºåºä¸ä¸»è¯­æ•°ç»„çš„é¡ºåºä¸€è‡´</li></ul><p><span id="not"></span></p><p><strong>.not</strong><br>å¯¹ä¹‹åçš„æ–­è¨€å–å</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(&#123;<span class="hljs-attr">a</span>: <span class="hljs-number">1</span>&#125;).to.not.equal(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.not.have.a.keys(<span class="hljs-string">&#x27;b&#x27;</span>)<br>expect([<span class="hljs-number">100</span>, <span class="hljs-number">200</span>]).to.be.not.lengthOf(<span class="hljs-number">3</span>)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.length.not.within(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="deep"></span></p><p><strong>.deep</strong><br>æ™®é€šçš„å¯¹è±¡æˆ–æ•°ç»„æ¯”è¾ƒæ˜¯æ¯”è¾ƒå®ƒä»¬çš„æ•´ä½“æ˜¯å¦ç›¸ç­‰ã€‚<br>æ¯”å¦‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.not.equal(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.not.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.deep.equal(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.deep.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])<br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125; &#125; &#125;).to.be.deep.equal(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125; &#125; &#125;)<br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.have.nested.deep.property(<span class="hljs-string">&#x27;a.b&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç›¸å½“äºæ˜¯ä¸¥æ ¼ç›¸ç­‰ <code>===</code><br><a href="#top">é¡¶</a></p><p><span id="any"></span></p><p><strong>.any</strong><br>ä¸<code>keys</code>ä½¿ç”¨æ—¶è‡³å°‘æ»¡è¶³ä¸€é¡¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect([<span class="hljs-number">100</span>, <span class="hljs-number">200</span>]).to.have.any.keys(<span class="hljs-number">0</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">200</span> &#125;).to.have.any.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="all"></span></p><p><strong>.all</strong><br>ä¸<code>any</code>ç±»ä¼¼ï¼Œä½†æ˜¯è‡³å°‘æ»¡è¶³æ‰€æœ‰é¡¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect([<span class="hljs-number">100</span>, <span class="hljs-number">200</span>]).to.has.all.keys(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br>expect([<span class="hljs-number">100</span>, <span class="hljs-number">200</span>]).to.not.has.all.keys(<span class="hljs-number">0</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">200</span> &#125;).to.has.all.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;).to.not.has.all.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br></code></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚ä¸Šæœ€åä¸€æ¡æ–­è¨€æ‰€ç¤ºï¼Œå½“<code>all</code>å’Œ<code>keys</code>ä¸€åŒä½¿ç”¨æ—¶ï¼Œæ–­è¨€å¯¹è±¡çš„<code>key</code>å¿…é¡»å’Œ<code>keys</code>å®Œå…¨ä¸€æ ·æ‰èƒ½é€šè¿‡<br><a href="#top">é¡¶</a></p><p><span id="a"></span></p><p><strong>.a .an</strong><br>æ—¢å¯ä»¥ç”¨åšé“¾å¼åˆ¤æ–­ä¹Ÿå¯ç”¨äºæ–­è¨€<br>ç”¨ä½œåˆ¤æ–­æ—¶æ— å®é™…ä½œç”¨ï¼Œä»…ç”¨äºè¯­ä¹‰åŒ–<br>ç”¨åšæ–­è¨€æ—¶ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦ä¸ºæŸä¸€ç±»å‹<br>æ–¹æ³•<code>type a = (type: &#39;string&#39; | &#39;object&#39; | &#39;null&#39; | &#39;undefined&#39; | &#39;array&#39; | &#39;number&#39; | &#39;symbol&#39; | &#39;error&#39; | &#39;promise&#39;/*è¿˜æœ‰åˆ«çš„ç±»å‹...*/, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.a(<span class="hljs-string">&#x27;number&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">100</span> &#125;).to.has.a.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(<span class="hljs-built_in">Symbol</span>()).to.be.a(<span class="hljs-string">&#x27;symbol&#x27;</span>)<br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>()).to.be.a(<span class="hljs-string">&#x27;error&#x27;</span>)<br><span class="hljs-comment">//è‡ªå®šä¹‰ç±»å‹</span><br><span class="hljs-keyword">const</span> object = &#123;<br>  [<span class="hljs-built_in">Symbol</span>.toStringTag]: <span class="hljs-string">&#x27;diyObj&#x27;</span><br>&#125;<br>expect(object).to.be.a(<span class="hljs-string">&#x27;diyObj&#x27;</span>)<br><span class="hljs-comment">//ç»§ç»­æ–­è¨€</span><br>expect(<span class="hljs-number">100</span>).to.be.a(<span class="hljs-string">&#x27;number&#x27;</span>).and.to.equal(<span class="hljs-number">100</span>)<br><span class="hljs-comment">//è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</span><br>expect(<span class="hljs-number">100</span>).to.be.a(<span class="hljs-string">&#x27;number&#x27;</span>, <span class="hljs-string">&#x27;it is not impossible&#x27;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¯ç”¨äºè‡ªå®šä¹‰ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚ä¸Šä½¿ç”¨<code>Symbol.toStringTag</code>è¿›è¡Œè‡ªå®šä¹‰ç±»å‹å®šä¹‰</li><li>ç”±<code>a</code>å’Œ<code>an</code>æ–­è¨€ä¼šè¿”å›æ–­è¨€çš„å€¼ï¼Œå¯ä»¥ç»§ç»­åšé“¾å¼è°ƒç”¨ç»§ç»­åšå…¶ä»–åˆ¤æ–­</li><li><code>a</code>å’Œ<code>an</code> æœ‰å¯é€‰çš„ç¬¬äºŒå‚æ•°å¯ä»¥æŒ‡å®šå‡ºé”™æ—¶çš„é”™è¯¯ä¿¡æ¯<br><a href="#top">é¡¶</a></li></ul><p><span id="include"></span></p><p><strong>.include .contains</strong><br>ç”¨äºåˆ¤æ–­æ–­è¨€å€¼æ˜¯å¦åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼ï¼Œä½†æ˜¯åªèƒ½æŒ‡å®šä¸€ä¸ªå€¼<br><code>includes</code> ã€ <code>contains</code> <code>contain</code> åŒä¹‰<br>æ—¢å¯ä»¥ç”¨åšé“¾å¼åˆ¤æ–­ä¹Ÿå¯ç”¨äºæ–­è¨€<br>æ–¹æ³• <code>type include = (value: any, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//å­—ç¬¦ä¸²åŒ…å«</span><br>expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.be.include(<span class="hljs-string">&#x27;iel&#x27;</span>)<br><span class="hljs-comment">//æ•°ç»„</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.a(<span class="hljs-string">&#x27;array&#x27;</span>).and.include(<span class="hljs-number">1</span>)<br><span class="hljs-comment">//ä¸¥æ ¼ç›¸ç­‰</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;2&#x27;</span>]).to.not.be.include(<span class="hljs-number">2</span>)<br><span class="hljs-comment">//å¯¹è±¡</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;).to.be.include(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br><span class="hljs-comment">//mapå€¼åŒ…å«</span><br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>]])).to.be.include(<span class="hljs-number">2</span>)<br><span class="hljs-comment">//setå€¼åŒ…å«</span><br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])).to.be.include(<span class="hljs-number">3</span>)<br><span class="hljs-comment">//æ·±å±‚æ¬¡ä¸¥æ ¼ç›¸ç­‰</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.be.not.include(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;)<br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.be.deep.include(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;)<br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.be.nested.deep.include(&#123; <span class="hljs-string">&#x27;a.b&#x27;</span>: <span class="hljs-number">2</span> &#125;)<br><span class="hljs-comment">//è‡ªå®šä¹‰æ–­è¨€é”™è¯¯ä¿¡æ¯</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.not.include(<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;it is not impossible&#x27;</span>)<br><span class="hljs-comment">//é…åˆmembersé“¾å¼è°ƒç”¨</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.include.members([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])<br><span class="hljs-comment">//é…åˆkeys</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;).to.be.include.any.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;).to.be.include.all.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br><span class="hljs-comment">//å¯¹è±¡å¯ä»¥è·å–ä¸Šå±‚å±æ€§</span><br><span class="hljs-built_in">Object</span>.prototype.say = <span class="hljs-string">&#x27;Daniel&#x27;</span><br>expect(&#123;&#125;).to.be.include(&#123; <span class="hljs-attr">say</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span> &#125;).but.not.own.include(&#123; <span class="hljs-attr">say</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span> &#125;)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="nested"></span></p><p><strong>.nested</strong><br>ç”¨äºåœ¨<code>property</code>ã€<code>include</code>ç­‰ç”¨<code>.</code>è¯­æ³•è·å–æ·±å±‚æ¬¡å±æ€§<br>æœ‰æ—¶å€™å¯¹äºæ·±å±‚æ¬¡çš„å¯¹è±¡æˆ–æ•°ç»„æ— æ³•ç›´æ¥åˆ¤æ–­è¯¥å†…å®¹ï¼Œå¯ä»¥é€šè¿‡<code>nested</code>æ¥å®ç°æ·±å±‚æ¬¡çš„å€¼è·å–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ·±å±‚æ¬¡åµŒå¥—è·å–</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">1</span> &#125; &#125; &#125;).to.be.nested.have.a.property(<span class="hljs-string">&#x27;a.b.c&#x27;</span>)<br><span class="hljs-comment">//è½¬ä¹‰</span><br>expect(&#123; <span class="hljs-string">&#x27;.a&#x27;</span>: &#123; <span class="hljs-string">&#x27;..b&#x27;</span>: &#123; <span class="hljs-string">&#x27;[c]&#x27;</span>: <span class="hljs-number">1</span> &#125; &#125; &#125;).to.be.nested.have.a.property(<span class="hljs-string">&#x27;\\.a.\\.\\.b.\\[c\\]&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="ok"></span></p><p><strong>.ok</strong><br>è¡¨ç¤ºçœŸå€¼ï¼Œå¦‚<code>true</code> <code>[]</code> <code>&#123;&#125;</code>ç­‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect([]).to.be.ok<br>expect(&#123;&#125;).to.be.ok<br><span class="hljs-comment">//è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</span><br>expect(<span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;it is not impossible&#x27;</span>).to.be.not.ok<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬æƒ…å†µä¸‹ä¸å¤ªéœ€è¦ä½¿ç”¨æ­¤å±æ€§<br>å…³äºå…¶ä»–è±¡å¾æ€§çš„å€¼ç›´æ¥ä½¿ç”¨å¯¹åº”çš„å±æ€§å°±å¯ä»¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">0</span>).to.be.equal(<span class="hljs-number">0</span>)<br>expect(<span class="hljs-literal">true</span>).to.be.true<br>expect(<span class="hljs-literal">null</span>).to.be.null<br>expect(<span class="hljs-literal">undefined</span>).to.be.undefined<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="true"></span></p><p><strong>.true</strong><br>åŒä¸Šè¡¨ç¤ºçœŸå€¼ï¼Œä½†ä¸è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥åªæœ‰<code>true</code>èƒ½é€šè¿‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-literal">true</span>).to.be.true<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="false"></span></p><p><strong>false</strong><br>ä¸<code>true</code>ç›¸åï¼Œè¡¨ç¤ºå‡å€¼ï¼Œä¸è¿›è¡Œç±»å‹è½¬æ¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-literal">false</span>).to.be.false<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="null"></span></p><p><strong>.null</strong><br>ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦ä¸º<code>null</code>å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-literal">false</span>).to.be.false<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="undefined"></span></p><p><strong>.undefined</strong><br>ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦ä¸º<code>undefined</code>å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-literal">undefined</span>).to.be.undefined<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="NaN"></span></p><p><strong>.NaN</strong><br>ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦ä¸º<code>NaN</code>å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä¸æ¨èä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒå­—ç¬¦ä¸²ç­‰ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨equal</span><br><span class="hljs-comment">//expect(&#x27;Daniel&#x27;).to.be.NaN</span><br>expect(<span class="hljs-number">100</span>).to.be.not.NaN<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="exist"></span></p><p><strong>.exist</strong><br>ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨ï¼Œå³é<code>null</code> ä¸” é<code>undefined</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.exist<br>expect(<span class="hljs-literal">null</span>).to.be.not.exist<br>expect([]).to.be.exist<br>expect(<span class="hljs-literal">undefined</span>).to.be.not.exist<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="finite"></span></p><p><strong>.finite</strong><br>è¡¨ç¤ºæœ‰é™æ•°ç»„ï¼Œå³é<code>NaN</code> ä¸” é<code>Infinity</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">200</span>).to.be.finite<br>expect(<span class="hljs-literal">Infinity</span>).to.be.not.finite<br>expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.be.not.finite<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="empty"></span></p><p><strong>.empty</strong><br>åˆ¤æ–­å€¼å¾—é•¿åº¦æ˜¯å¦ä¸º<code>0</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//å­—ç¬¦ä¸²çš„é•¿åº¦</span><br>expect(<span class="hljs-string">&#x27;&#x27;</span>).to.be.empty<br><span class="hljs-comment">//æ•°ç»„é•¿åº¦</span><br>expect([]).to.be.empty<br><span class="hljs-comment">//å¯¹è±¡åˆ™æ˜¯åˆ¤æ–­å¯æšä¸¾çš„å±æ€§çš„æ•°é‡(Object.keys(obj).length)</span><br>expect(&#123;&#125;).to.be.empty<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="arguments"></span></p><p><strong>.arguments</strong><br>åˆ¤æ–­å€¼æ˜¯å¦ä¸º<code>arguments</code>å¯¹è±¡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-built_in">arguments</span>).to.be.arguments<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="equal"></span></p><p><strong>.equal</strong><br>åˆ¤æ–­å€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œç›¸å½“äº<code>===</code><br><code>type equal = (value: any, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ¯”è¾ƒå€¼çš„ç›¸ç­‰</span><br>expect(<span class="hljs-number">1</span>).to.be.equal(<span class="hljs-number">1</span>)<br><span class="hljs-comment">//æ•°ç»„å’Œå¯¹è±¡åˆ™æ— æ³•ä¸¥æ ¼ç›¸ç­‰</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.not.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br><span class="hljs-comment">//æ•°ç»„å’Œå¯¹è±¡æ¯”è¾ƒå¯ä»¥ç”¨ä¹‹å‰ä»‹ç»çš„deep</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.deep.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.deep.equal(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br><span class="hljs-comment">//è‡ªå®šä¹‰é”™è¯¯æç¤ºä¿¡æ¯</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.not.equal([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>], <span class="hljs-string">&#x27;it is not impossible&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="eql"></span></p><p><strong>.eql</strong><br>å¯ä»¥å½“åšæ˜¯<code>deep</code> å’Œ <code>equal</code>çš„ç»„åˆ<br><code>type eql = (value: any, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ•°ç»„å¯¹è±¡ç­‰å€¼å†…å®¹ç›¸ç­‰</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.eql([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.eql(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;)<br><span class="hljs-comment">//ç»§ç»­æ–­è¨€</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.eql(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).and.not.be.empty<br></code></pre></td></tr></table></figure><ul><li>å¦‚ä¸Šæ‰€ä¾‹ğŸŒ°ï¼Œeqlè¿”å›å€¼æœ¬èº«ï¼Œå¯ä»¥ç»§ç»­å‘ååšæ–­è¨€<br><a href="#top">é¡¶</a></li></ul><p><span id="above"></span></p><p><strong>.above</strong><br>åˆ¤æ–­å€¼æ˜¯å¦<code>å¤§äº</code>æŒ‡å®šå€¼<br><code>type above = (value: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.above(<span class="hljs-number">10</span>)<br>expect(<span class="hljs-number">100</span>).to.be.not.above(<span class="hljs-number">101</span>)<br></code></pre></td></tr></table></figure><ul><li>å¯¹äºå­—ç¬¦ä¸²ï¼Œæ•°ç»„ç­‰é•¿åº¦çš„æ¯”è¾ƒå»ºè®®ç›´æ¥ä½¿ç”¨<code>lengthOf</code><br><a href="#top">é¡¶</a></li></ul><p><span id="least"></span></p><p><strong>.least</strong><br>åˆ¤æ–­å€¼æ˜¯å¦<code>ä¸å°äºï¼ˆå¤§äºç­‰äºï¼‰</code>æŒ‡å®šå€¼<br><code>type least = (value: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.least(<span class="hljs-number">100</span>)<br>expect(<span class="hljs-number">100</span>).to.be.least(<span class="hljs-number">99</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><strong>.below</strong><br>åˆ¤æ–­å€¼æ˜¯å¦<code>å°äº</code>æŒ‡å®šå€¼<br><code>type below = (value: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.below(<span class="hljs-number">101</span>)<br>expect(<span class="hljs-number">100</span>).to.be.not.below(<span class="hljs-number">99</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="most"></span></p><p><strong>.most</strong><br>åˆ¤æ–­å€¼æ˜¯å¦<code>ä¸å¤§äºï¼ˆå°äºç­‰äºï¼‰</code>æŒ‡å®šå€¼<br><code>type most = (value: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-number">100</span>).to.be.most(<span class="hljs-number">100</span>)<br>expect(<span class="hljs-number">100</span>).to.be.most(<span class="hljs-number">101</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="within"></span></p><p><strong>.within</strong><br>åˆ¤æ–­å€¼æ˜¯å¦åœ¨æŒ‡å®šåŒºé—´å†…<br><code>type within = (start: number, end: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//åŒ…å«å¼€å§‹å’Œç»“æŸ</span><br>expect(<span class="hljs-number">100</span>).to.be.within(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)<br>expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.have.a.lengthOf.within(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.have.a.lengthOf.within(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure><ul><li>ä¸æ¨èä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå®ç°çš„æµ‹è¯•åŸºæœ¬éƒ½å¯ä»¥é€šè¿‡<code>equal</code>æˆ–æ˜¯<code>lengthOf</code>æ¥å®ç°<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä½¿ç”¨equalå’ŒlengthOfå®ç°æµ‹è¯•</span><br>expect(<span class="hljs-number">100</span>).to.be.equal(<span class="hljs-number">100</span>)<br>expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.have.a.lengthOf(<span class="hljs-number">6</span>)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.have.a.lengthOf(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><a href="#top">é¡¶</a></li></ul><p><span id="instanceof"></span></p><p><strong>.instanceof</strong><br>åˆ¤æ–­å€¼æ˜¯å¦ä¸ºæŒ‡å®šå€¼çš„å®ä¾‹<br><code>type instanceof = (constructor: object, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Father</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br><span class="hljs-keyword">const</span> father = <span class="hljs-keyword">new</span> Father()<br>expect(father).to.be.instanceof(Father)<br>expect([]).to.be.instanceof(<span class="hljs-built_in">Array</span>)<br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Number</span>(<span class="hljs-number">100</span>)).to.be.instanceof(<span class="hljs-built_in">Number</span>)<br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">String</span>(<span class="hljs-string">&#x27;Daniel&#x27;</span>)).to.be.instanceof(<span class="hljs-built_in">String</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="property"></span></p><p><strong>.property</strong><br>åˆ¤æ–­å€¼æ˜¯å¦åŒ…å«æŒ‡å®šå±æ€§<br><code>type property = (key: string, value?: any, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ç®€å•åˆ¤æ–­æ˜¯å¦æ‹¥æœ‰è¯¥å±æ€§</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.a.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br><span class="hljs-comment">//å¹¶ä¸”åˆ¤æ–­æ˜¯å¦ä¸ºè¯¥å€¼</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.a.property(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">1</span>)<br><span class="hljs-comment">//é’ˆå¯¹æ·±å±‚æ¬¡çš„å€¼æ¯”è¾ƒéœ€è¦ deep å‚ä¸</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> &#125; &#125;).to.be.not.have.a.property(<span class="hljs-string">&#x27;a&#x27;</span>, &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> &#125;)<br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> &#125; &#125;).to.be.have.a.deep.property(<span class="hljs-string">&#x27;a&#x27;</span>, &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">1</span> &#125;)<br><span class="hljs-comment">//é…åˆ own ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºå½“å‰æ‰€æœ‰çš„å®ä¾‹å®è¡Œ</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.a.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.a.property(<span class="hljs-string">&#x27;toString&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.a.own.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.not.have.a.own.property(<span class="hljs-string">&#x27;toString&#x27;</span>)<br><span class="hljs-comment">//é…åˆ nested è¿›è¡Œæ·±å±‚æ¬¡çš„æ¯”è¾ƒ</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.be.have.nested.deep.property(<span class="hljs-string">&#x27;a.b&#x27;</span>, <span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="own"></span></p><p><strong>.own</strong><br>åˆ¤æ–­å€¼æ˜¯å¦æ‹¥æœ‰æŒ‡å®šçš„å±æ€§ï¼Œä¸åŒ…å«ä¸Šå±‚å±æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ç»“åˆpropertyä½¿ç”¨</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.own.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.not.have.own.property(<span class="hljs-string">&#x27;toString&#x27;</span>)<br><span class="hljs-comment">//é…åˆ deep å’Œ propertyè¿›è¡Œæ·±å±‚æ¬¡çš„æ¯”è¾ƒ</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; &#125;).to.be.have.own.deep.property(<span class="hljs-string">&#x27;a&#x27;</span>, &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="ownProperty"></span></p><p><strong>.ownProperty</strong><br>åˆ¤æ–­æ˜¯å¦ä¸ºæœ¬èº«å±æ€§ï¼Œç›¸å½“äºæ˜¯ <code>.own.property</code>çš„ç»“åˆ<br><code>type ownProperty = (key: string, value?: any, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.own.property(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.ownProperty(<span class="hljs-string">&#x27;a&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="ownPropertyDescriptor"></span></p><p><strong>.ownPropertyDescriptor</strong><br>ç±»ä¼¼äºä¸Šé¢çš„æ–¹æ³•ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºæœ¬èº«çš„å±æ€§<br>ä½†æ˜¯å®ƒå¯ä»¥ä¼ é€’ç¬¬äºŒå‚æ•°ï¼Œè¡¨ç¤ºè¯¥å±æ€§çš„æè¿°å¯¹è±¡ï¼Œä¸çŸ¥é“ä»€ä¹ˆæ˜¯æè¿°å¯¹è±¡çš„è‡ªè¡Œç™¾åº¦<br><code>type ownPropertyDescriptor = (key: string, value?: &#123; get?: (undifiend || () =&gt; any)=undefined, set?: (undefined || () =&gt; any)=undefined, configurable?: boolean=false, enumerable?: boolean=false, value?: any=undefined, writable?: boolean=false &#125;, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> object = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span><br>&#125;<br><span class="hljs-keyword">const</span> descriper = &#123;<br>  <span class="hljs-comment">//æ˜¯å¦å¯æšä¸¾</span><br>  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">//å€¼</span><br>  <span class="hljs-comment">//value: &#x27;hello world&#x27;,</span><br>  <span class="hljs-comment">//æ˜¯å¦å¯å†™</span><br>  <span class="hljs-comment">//writable: false,</span><br>  <span class="hljs-comment">//æ˜¯å¦å¯ä¿®æ”¹æè¿°ç¬¦å¯¹è±¡</span><br>  <span class="hljs-comment">//æ³¨æ„å¦‚æœè®¾ç½®ä¸ºfalseï¼Œåç»­å°†æ— æ³•å†ä¿®æ”¹å…¶æè¿°å¯¹è±¡</span><br>  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">//è·å–å€¼æ‹¦æˆª</span><br>  <span class="hljs-comment">//è®¾ç½®äº†æ‹¦æˆªå°±ä¸èƒ½è®¾ç½®writableå’Œvalue</span><br>  <span class="hljs-function"><span class="hljs-title">get</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;I love China&#x27;</span><br>  &#125;,<br>  <span class="hljs-comment">//è®¾ç½®å€¼æ‹¦æˆª</span><br>  <span class="hljs-function"><span class="hljs-title">set</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.value<br>  &#125;<br>&#125;<br><span class="hljs-built_in">Object</span>.defineProperty(object, <span class="hljs-string">&#x27;name&#x27;</span>, descriper)<br><br>expect(object).to.be.ownPropertyDescriptor(<span class="hljs-string">&#x27;name&#x27;</span>)<br>expect(object).to.be.ownPropertyDescriptor(<span class="hljs-string">&#x27;name&#x27;</span>, descriper)<br><span class="hljs-comment">//è‡ªå®šä¹‰é”™è¯¯</span><br>expect(object).to.be.ownPropertyDescriptor(<span class="hljs-string">&#x27;name&#x27;</span>, descriper, <span class="hljs-string">&#x27;it is impossible&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="lengthOf"></span></p><p><strong>.lengthOf .length</strong><br>åˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨<code>length</code>å±æ€§ä¸”ä¸ºæŒ‡å®šå€¼<br>æ–¹æ³• <code>type lengthOf = (value: number, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.lengthOf(<span class="hljs-number">3</span>)<br><span class="hljs-comment">//ç”¨äºé“¾å¼è°ƒç”¨ï¼Œä½†æ˜¯ä¸æ¨è</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.have.a.lengthOf.below(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="match"></span></p><p><strong>.match</strong><br>åˆ¤æ–­å€¼æ˜¯å¦ä¸æŒ‡å®š<code>æ­£åˆ™</code>åŒ¹é…<br>å’Œæ™®é€š<code>match</code>æ–¹æ³•ä¸€æ ·ï¼Œæ‰€ä»¥ä¸»è¯­å°±æ˜¯<code>string</code><br><code>matches</code>æ•ˆæœä¸<code>match</code>ç›¸åŒ<br><code>type match = (reg: Regexp, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.be.match(<span class="hljs-regexp">/^D.+l$/</span>)<br>expect(<span class="hljs-string">&#x27;2020-08-10&#x27;</span>).to.be.match(<span class="hljs-regexp">/^\d&#123;4&#125;-\d&#123;2&#125;-\d&#123;2&#125;$/</span>)<br>expect(<span class="hljs-string">&#x27;13456787654&#x27;</span>).to.be.match(<span class="hljs-regexp">/^1[^12]\d&#123;9&#125;$/</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="string"></span></p><p><strong>.string</strong><br>åˆ¤æ–­å€¼æ˜¯å¦åŒ…å«æŒ‡å®šçš„å­—ç¬¦ä¸²<br><code>type string = (value: string, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">expect(<span class="hljs-string">&#x27;Daniel&#x27;</span>).to.be.have.a.string(<span class="hljs-string">&#x27;iel&#x27;</span>)<br>expect(<span class="hljs-string">&#x27;hello&#x27;</span>).to.be.not.have.a.string(<span class="hljs-string">&#x27;world&#x27;</span>)<br><span class="hljs-comment">//å¿…é¡»æ˜¯è¿ç»­å­ä¸²</span><br>expect(<span class="hljs-string">&#x27;world&#x27;</span>).to.be.not.have.a.string(<span class="hljs-string">&#x27;rd&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="keys"></span></p><p><strong>.keys</strong><br>ç”¨äºåˆ¤æ–­<code>æ•°ç»„</code>ã€<code>å¯¹è±¡</code>ã€<code>Set</code>ã€<code>Map</code>ç­‰æ˜¯å¦åŒ…å«ç›¸åº”çš„<code>key</code><br><code>type keys = (...args: Array&lt;string | number&gt;) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ™®é€šä½¿ç”¨éœ€è¦å°†æ‰€æœ‰keyå…¨éƒ¨ä¼ å…¥</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;).to.be.have.keys(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>]).to.be.have.keys(<span class="hljs-string">&#x27;0&#x27;</span>, <span class="hljs-string">&#x27;1&#x27;</span>)<br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>])).to.be.have.keys(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>expect(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([[ <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-number">1</span> ]])).to.be.have.keys(<span class="hljs-string">&#x27;a&#x27;</span>)<br><span class="hljs-comment">//é…åˆall å’Œ any ä½¿ç”¨</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;).to.be.have.any.keys(<span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;).to.be.be.have.all.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br><span class="hljs-comment">//åŒ…å«</span><br>expect(&#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125;).to.be.include.keys(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>)<br><span class="hljs-comment">//æ·±å±‚æ¬¡æ¯”è¾ƒ</span><br>expect(&#123; <span class="hljs-attr">a</span>: &#123; <span class="hljs-attr">b</span>: &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125; &#125; &#125;).to.be.have.deep.keys(<span class="hljs-string">&#x27;a.b&#x27;</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="throw"></span></p><p><strong>.throw</strong><br>åˆ¤æ–­å€¼æ˜¯å¦æŠ›å‡ºæŒ‡å®šçš„é”™è¯¯ã€é”™è¯¯ä¿¡æ¯ç­‰ã€‚<br>.throw(errConstructor | string | reg) æ˜¯å¦æŠ›å‡ºæŒ‡å®šé”™è¯¯æˆ–å­—ç¬¦ä¸²æˆ–åŒ¹é…æŒ‡å®šé”™è¯¯ä¿¡æ¯<br><code>type throw = (errorLike?: Error | Construcotr, errMsgMatcher?: string | Regexp, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">new</span> <span class="hljs-built_in">TypeError</span>(<span class="hljs-string">&#x27;oops&#x27;</span>)<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">error</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">throw</span> errors &#125;<br><span class="hljs-comment">//å½“ä¸ç¡®å®šä¼šæŠ›å‡ºå“ªä¸€ç§é”™è¯¯æ—¶ï¼Œç›´æ¥ä¸ä¼ å‚æ•°</span><br>expect(error).to.be.throw()<br><span class="hljs-comment">//ä¼ é€’å…·ä½“çš„é”™è¯¯ç±»å‹</span><br>expect(error).to.be.throw(<span class="hljs-built_in">TypeError</span>)<br><span class="hljs-comment">//ä¼ é€’é”™è¯¯å®ä¾‹</span><br>expect(error).to.be.throw(errors, <span class="hljs-string">&#x27;oops&#x27;</span>)<br><span class="hljs-comment">//ç¬¬äºŒå‚æ•°å¯ä¸ºå­—ç¬¦ä¸²ï¼Œä¸”è¡¨ç¤ºä¸ºå­ä¸²</span><br>expect(error).to.be.throw(errors, <span class="hljs-string">&#x27;oop&#x27;</span>)<br><span class="hljs-comment">//ä¹Ÿæ”¯æŒæ­£åˆ™</span><br>expect(error).to.be.throw(<span class="hljs-built_in">TypeError</span>, <span class="hljs-regexp">/.+/</span>)<br><span class="hljs-comment">//å¯ç›´æ¥ä¼ é€’å­—ç¬¦ä¸²è¡¨ç¤ºæŠ›å‡ºçš„é”™è¯¯å†…å®¹</span><br>expect(error).to.be.throw(<span class="hljs-string">&#x27;oop&#x27;</span>)<br><span class="hljs-comment">//åŒæ ·æ”¯æŒæ­£åˆ™</span><br>expect(error).to.be.throw(<span class="hljs-regexp">/^o.+s$/</span>)<br><span class="hljs-comment">//æ–­è¨€åçš„ä¸»è¯­æ›´æ”¹ä¸ºé”™è¯¯å¯¹è±¡</span><br>errors.code = <span class="hljs-number">404</span><br>expect(error).to.be.throw(errors).and.that.have.a.property(<span class="hljs-string">&#x27;code&#x27;</span>, <span class="hljs-number">404</span>)<br></code></pre></td></tr></table></figure><p><code>throws</code> å’Œ <code>Throw</code>åŒä¹‰ğŸ™†<br><a href="#top">é¡¶</a></p><p><span id="respondTo"></span></p><p><strong>.respondTo</strong><br>ç”¨äºåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æˆ–æ„é€ å‡½æ•°æ˜¯å¦æœ‰ç›¸å…³çš„æ–¹æ³•<br><code>type respondTo = (methodName: string ,errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Father</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br>Father.prototype.sayFather = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br>Father.saySon = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;&#125;<br><span class="hljs-comment">//æ­£å¸¸å“åº”æ‰€æœ‰æ–¹æ³•</span><br>expect(<span class="hljs-keyword">new</span> Father()).to.be.respondTo(<span class="hljs-string">&#x27;sayFather&#x27;</span>)<br><span class="hljs-comment">//å®ä¾‹æ— æ³•è·å–è¶…é›†é™æ€å±æ€§</span><br>expect(<span class="hljs-keyword">new</span> Father()).to.be.not.respondTo(<span class="hljs-string">&#x27;saySon&#x27;</span>)<br>expect(&#123;&#125;).to.be.respondTo(<span class="hljs-string">&#x27;toString&#x27;</span>)<br><span class="hljs-comment">//æ·»åŠ itselfåªèƒ½å“åº”è‡ªèº«çš„æ–¹æ³•</span><br>expect(Father).to.be.itself.respondTo(<span class="hljs-string">&#x27;saySon&#x27;</span>).but.not.respondTo(<span class="hljs-string">&#x27;sayFather&#x27;</span>)<br></code></pre></td></tr></table></figure><p><code>respondsTo</code>ä¸æ­¤æ–¹æ³•åŒä¹‰<br><a href="#top">é¡¶</a></p><p><span id="itself"></span></p><p><strong>.itself</strong><br>é…åˆä¸Šè¿°çš„<code>respondTo</code>æ–¹æ³•åˆ¤æ–­å€¼æ˜¯å¦å“åº”æŒ‡å®šçš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸ºè‡ªèº«çš„æ–¹æ³•ï¼Œä¸åŒ…å«<code>prototype</code>ä¸Šçš„æ–¹æ³•<br>å…·ä½“äº‹ä¾‹å¯ä»¥çœ‹ä¸Šé¢çš„<code>respondTo</code><br><a href="#top">é¡¶</a></p><p><span id="satisfy"></span></p><p><strong>.satisfy</strong><br>æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°å‚æ•°ä¸ºæ–­è¨€ç›®æ ‡å€¼ï¼Œè¿”å›å€¼ä¸ºbooleanï¼Œåˆ¤æ–­æ˜¯å¦é€šè¿‡æ–­è¨€  </p><ul><li><code>type satisfy = (method: (target: any) =&gt; boolean, errmsg?: string) =&gt; any</code>  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ç›®æ ‡å€¼åœ¨[0, 100]å†…</span><br>expect(<span class="hljs-number">100</span>).to.be.satisfy(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> target &gt;= <span class="hljs-number">0</span> &amp;&amp; target &lt;= <span class="hljs-number">100</span><br>&#125;)<br>expect(<span class="hljs-number">100</span>).to.be.satisfies(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">target</span>) </span>&#123;<br>  <span class="hljs-keyword">return</span> target &gt;= <span class="hljs-number">0</span> &amp;&amp; target &lt;= <span class="hljs-number">100</span><br>&#125;)<br></code></pre></td></tr></table></figure><code>satisfies</code>ä¸æ­¤æ–¹æ³•åŒä¹‰<br><a href="#top">é¡¶</a></li></ul><p><span id="closeTo"></span></p><p><strong>.closeTo</strong><br>æŒ‡å®šå€¼ï¼ˆä»…<code>æ•°å­—</code>ï¼‰æ˜¯å¦åœ¨æœŸæœ›å€¼çš„æ¥æ”¶èŒƒå›´å†…<br>æ­¤æ–¹æ³•ä¸<code>within</code>çš„åŒºåˆ«å°±æ˜¯withinæ¥æ”¶çš„ä¸¤ä¸ªå‚æ•°æ˜¯ä¸Šé™å’Œä¸‹é™<br><code>closeTo</code>çš„å‚æ•°ï¼Œç¬¬ä¸€å‚æ•°ä¸ºæœŸæœ›çš„ä¸­é—´å€¼ï¼Œç¬¬äºŒå‚æ•°ä¸ºä¸Šä¸‹é™ï¼ˆç¬¬ä¸€å‚æ•°åŠ å‡ç¬¬äºŒå‚æ•°ï¼‰</p><ul><li><code>type closeTo = (expected: number, delta: number, errmsg?: string) =&gt; any</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æŒ‡å®šå€¼åœ¨[-90, 110]ä¹‹é—´</span><br>expect(<span class="hljs-number">100</span>).to.be.closeTo(<span class="hljs-number">10</span>, <span class="hljs-number">100</span>)<br><span class="hljs-comment">//åŒ…å«ä¸´ç•Œå€¼</span><br>expect(<span class="hljs-number">110</span>).to.be.closeTo(<span class="hljs-number">10</span>, <span class="hljs-number">100</span>)<br>expect(-<span class="hljs-number">90</span>).to.be.closeTo(<span class="hljs-number">10</span>, <span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure>è™½ç„¶æ­¤æ–¹æ³•å¯ä»¥ç”¨äºåˆ¤æ–­å€¼æ˜¯å¦åœ¨ä¸€ä¸ªåŒºé—´å†…ï¼Œä½†æ˜¯ç›´æ¥ä½¿ç”¨<code>equal</code>è¿›è¡Œç›¸ç­‰åˆ¤æ–­ä¸€æ ·å¯ä»¥<br><a href="#top">é¡¶</a></li></ul><p><span id="members"></span></p><p><strong>.members</strong><br>ç±»ä¼¼äºcontainsã€includeï¼Œä½†æ˜¯æ¥æ”¶å‚æ•°ä¸ºæ•°ç»„ï¼Œä¸»è¯­åªèƒ½æ˜¯æ•°ç»„<br><code>type members = (target: Array&lt;any&gt;, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä¸»è¯­å¿…é¡»ä¸ºæ•°ç»„</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.have.members([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br><span class="hljs-comment">//éç®€å•ç±»å‹æ•°ç»„éœ€é…åˆdeep</span><br>expect([ &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125; ]).to.be.have.deep.members([ &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125; ])<br><span class="hljs-comment">//é…åˆorderdæ¥å¼ºåˆ¶æ•°ç»„é¡ºåºä¸ä¸»è¯­ä¸€è‡´</span><br>expect([ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ]).to.be.have.ordered.members([ <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span> ])<br><span class="hljs-comment">//é…åˆincludeé“¾å¼è°ƒç”¨å¯ä»¥å¯¹ä¸å¿…è¦çš„æ•°ç»„é¡¹ä¸è¿›è¡ŒéªŒè¯</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.include.members([ <span class="hljs-number">1</span>, <span class="hljs-number">2</span> ])<br><span class="hljs-comment">//ç›¸å¯¹äºéªŒè¯ä¸å­˜åœ¨çš„æ•°ç»„é¡¹æ¨èä½¿ç”¨include</span><br>expect([<span class="hljs-number">1</span>]).to.be.not.include(<span class="hljs-number">2</span>).and.not.include(<span class="hljs-number">3</span>)<br><span class="hljs-comment">//å¤åˆä½¿ç”¨</span><br>expect([ &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;, &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125;, &#123; <span class="hljs-attr">c</span>: <span class="hljs-number">3</span> &#125; ]).to.be.include.deep.ordered.members([ &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;, &#123; <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> &#125; ])<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="oneOf"></span></p><p><strong>.oneOf</strong><br>åˆ¤æ–­å€¼æ˜¯å¦å‡ºç°åœ¨æŒ‡å®šæ•°ç»„ä¸­<br><code>type oneOf = (list: Array&lt;any&gt;, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ–­è¨€å€¼åœ¨æŒ‡å®šæ•°ç»„ä¸­</span><br>expect(<span class="hljs-number">100</span>).to.be.oneOf([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">100</span>])<br><span class="hljs-comment">//æ¨èç›´æ¥ä½¿ç”¨equal</span><br>expect(<span class="hljs-number">100</span>).to.be.equal(<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="change"></span></p><p><strong>.change</strong><br>åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šæ”¹å˜æŒ‡å®šçš„å€¼ï¼Œä¸»è¯­æ¥æ”¶çš„æ˜¯ä¸€ä¸ªæ”¹å˜åˆ¤å®šå¯¹è±¡çš„å€¼çš„æ–¹æ³•<br>å¯ä»¥æŠŠå®ƒå½“åšæ˜¯<code>increase</code>å’Œ<code>decrease</code>çš„ç»“åˆ<br>ä½†æ˜¯æ¨èç›´æ¥ä½¿ç”¨ä¸Šè¿°ä¸¤ä¸ªæ–¹æ³•<br><code>type change = (value: ((value: any) =&gt; any) | any, prop?: string, errmsg?: string) =&gt; any</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ™®é€šå€¼</span><br><span class="hljs-keyword">let</span> number = <span class="hljs-number">0</span><br><span class="hljs-keyword">let</span> string = <span class="hljs-string">&#x27;0&#x27;</span><br><span class="hljs-keyword">let</span> array = [ <span class="hljs-number">0</span> ]<br><span class="hljs-keyword">let</span> object = &#123; <span class="hljs-number">0</span>: <span class="hljs-number">0</span> &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeNumber</span>(<span class="hljs-params"></span>) </span>&#123; number ++ &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeString</span>(<span class="hljs-params"></span>) </span>&#123; string += <span class="hljs-number">1</span> &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeArray</span>(<span class="hljs-params"></span>) </span>&#123; array[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span> &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeObject</span>(<span class="hljs-params"></span>) </span>&#123; object[<span class="hljs-number">0</span>] += <span class="hljs-number">1</span> &#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNumber</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> number &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getString</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> string &#125;<br><br><span class="hljs-comment">//æ™®é€šå€¼éœ€è¦å€ŸåŠ©å‡½æ•°</span><br><span class="hljs-comment">//æ•°å­—</span><br>expect(changeNumber).to.be.change(getNumber)<br><span class="hljs-comment">//å­—ç¬¦ä¸²</span><br>expect(changeString).to.be.change(getString)<br><span class="hljs-comment">//å¤åˆå€¼åˆ™éœ€æ·»åŠ ç¬¬äºŒå‚æ•°ï¼Œæ”¹å˜çš„å±æ€§å</span><br><span class="hljs-comment">//æ•°ç»„</span><br>expect(changeArray).to.be.change(array, <span class="hljs-string">&#x27;0&#x27;</span>)<br><span class="hljs-comment">//å¯¹è±¡</span><br>expect(changeObject).to.be.change(object, <span class="hljs-string">&#x27;0&#x27;</span>)<br><br><span class="hljs-comment">//ç»“åˆbyå…·ä½“æ–­è¨€æ”¹å˜çš„èŒƒå›´</span><br>expect(changeNumber).to.be.change(getNumber).by(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="increase"></span><br><span id="decrease"></span></p><p><strong>.increase | .decrease</strong><br><code>increase</code> åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šå¢åŠ æŒ‡å®šå¯¹è±¡çš„å±æ€§æˆ–è€…æ™®é€šå€¼çš„å€¼<br><code>decrease</code> åˆ¤æ–­æ–¹æ³•æ˜¯å¦ä¼šå‡å°‘æŒ‡å®šå¯¹è±¡çš„å±æ€§æˆ–è€…æ™®é€šå€¼çš„å€¼<br><code>const increase = (value: any, prop?: string, errmsg?: string)</code><br><code>const decrease = (value: any, prop?: string, errmsg?: string)</code><br>å¹¶ä¸”åªèƒ½æ˜¯æ•°ç»„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//æ™®é€šå€¼</span><br><span class="hljs-keyword">let</span> number = <span class="hljs-number">0</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">increase</span>(<span class="hljs-params"></span>) </span>&#123; number ++ &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decrease</span>(<span class="hljs-params"></span>) </span>&#123; number -- &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-keyword">return</span> number &#125;<br>expect(increase).to.be.increase(get)<br>expect(decrease).to.be.decrease(get)<br><br><span class="hljs-comment">//å¯¹è±¡</span><br><span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objIncrease</span>(<span class="hljs-params"></span>) </span>&#123; obj.a ++ &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">objDecrease</span>(<span class="hljs-params"></span>) </span>&#123; obj.a -- &#125;<br>expect(objIncrease).to.be.increase(obj, <span class="hljs-string">&#x27;a&#x27;</span>)<br>expect(objDecrease).to.be.decrease(obj, <span class="hljs-string">&#x27;a&#x27;</span>)<br><br><span class="hljs-comment">//æ•°ç»„</span><br><span class="hljs-keyword">let</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayIncrease</span>(<span class="hljs-params"></span>) </span>&#123; arr[<span class="hljs-number">0</span>] += <span class="hljs-number">2</span> &#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">arrayDecrease</span>(<span class="hljs-params"></span>) </span>&#123; arr[<span class="hljs-number">0</span>] -= <span class="hljs-number">2</span> &#125;<br>expect(arrayIncrease).to.be.increase(arr, <span class="hljs-string">&#x27;0&#x27;</span>).by(<span class="hljs-number">2</span>)<br>expect(arrayDecrease).to.be.decrease(arr, <span class="hljs-string">&#x27;0&#x27;</span>).by(<span class="hljs-number">2</span>)<br><br><span class="hljs-comment">//é€šè¿‡byåˆ¤æ–­å¢åŠ çš„å¹…åº¦</span><br>expect(objIncrease).to.be.increase(obj, <span class="hljs-string">&#x27;a&#x27;</span>).by(<span class="hljs-number">1</span>)<br>expect(objDecrease).to.be.decrease(obj, <span class="hljs-string">&#x27;a&#x27;</span>).by(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="extensible"></span></p><p><strong>.extensible</strong><br>åˆ¤æ–­æŒ‡å®šå€¼æ˜¯å¦å¯æ‰©å±•(ä¸å¯ä»¥æ·»åŠ æ–°å±æ€§)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> object = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span>,<br>  <span class="hljs-attr">sayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name<br>  &#125;<br>&#125;<br><span class="hljs-comment">//è®¾ç½®å¯¹è±¡ä¸ºä¸å¯æ‰©å±•</span><br><span class="hljs-built_in">Object</span>.preventExtensions(object)<br><span class="hljs-comment">//å¯ä¿®æ”¹</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.name = <span class="hljs-string">&#x27;Mike&#x27;</span><br><span class="hljs-built_in">console</span>.log(object)<br><span class="hljs-comment">//å¯åˆ é™¤</span><br><span class="hljs-built_in">console</span>.log(object)<br><span class="hljs-keyword">delete</span> object.name<br><span class="hljs-built_in">console</span>.log(object)<br><span class="hljs-comment">//ä¸å¯æ–°å¢</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.age = <span class="hljs-number">18</span><br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä½¿ç”¨</span><br>expect(object).to.be.extensible<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="sealed"></span></p><p><strong>.sealed</strong><br>åˆ¤æ–­æŒ‡å®šå€¼æ˜¯å¦å°é—­(ä¸å¯æ·»åŠ æ–°å±æ€§ã€ä¸å¯åˆ é™¤æ—§å±æ€§ã€å¯ä¿®æ”¹æ—§å±æ€§)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> object = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span>,<br>  <span class="hljs-attr">sayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name<br>  &#125;<br>&#125;<br><span class="hljs-comment">//è®¾ç½®å¯¹è±¡ä¸ºå°é—­</span><br><span class="hljs-built_in">Object</span>.seal(object)<br><br><span class="hljs-comment">//ä¸å¯æ–°å¢</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.age = <span class="hljs-number">18</span><br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//å¯ä¿®æ”¹</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.name = <span class="hljs-string">&#x27;Mike&#x27;</span><br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä¸å¯åˆ é™¤</span><br><span class="hljs-built_in">console</span>.log(object)<br><span class="hljs-keyword">delete</span> object.name<br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä½¿ç”¨</span><br>expect(object).to.be.sealed<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="frozen"></span></p><p><strong>.frozen</strong><br>åˆ¤æ–­å€¼æ˜¯å¦å†»ç»“(ä¸å¯æ·»åŠ æ–°å±æ€§ã€ä¸å¯åˆ é™¤æ—§å±æ€§ã€ä¸å¯ä¿®æ”¹æ—§å±æ€§)</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> object = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Daniel&#x27;</span>,<br>  <span class="hljs-attr">sayName</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.name<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//è®¾ç½®å¯¹è±¡ä¸ºå†»ç»“</span><br><span class="hljs-built_in">Object</span>.freeze(object)<br><br><span class="hljs-comment">//ä¸å¯æ–°å¢</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.age = <span class="hljs-number">18</span><br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä¸å¯ä¿®æ”¹</span><br><span class="hljs-built_in">console</span>.log(object)<br>object.name = <span class="hljs-string">&#x27;Mike&#x27;</span><br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä¸å¯åˆ é™¤</span><br><span class="hljs-built_in">console</span>.log(object)<br><span class="hljs-keyword">delete</span> object.name<br><span class="hljs-built_in">console</span>.log(object)<br><br><span class="hljs-comment">//ä½¿ç”¨</span><br>expect(object).to.be.frozen<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><p><span id="by"></span></p><p><strong>.by</strong><br>é…åˆ<code>descrease</code> æˆ– <code>increase</code>ã€ <code>change</code>ç­‰æ¥åˆ¤æ–­æ–­è¨€å€¼æ˜¯å¦å‘ç”Ÿå˜åŒ–åœ¨æŒ‡å®šèŒƒå›´å†…<br>å…·ä½“äº‹ä¾‹ğŸŒ°å¯ä»¥ç›´æ¥æŸ¥çœ‹ä¸Šè¿°ä¸‰ä¸ªæ–¹æ³•çš„ä¾‹å­ğŸ‘†<br><a href="#top">é¡¶</a></p><p><span id="fail"></span></p><p><strong>.fail</strong><br>åˆ¤æ–­æ˜¯å¦ä¼šå¤±è´¥<br>æœ‰ä¸¤ç§å‚æ•°ä¼ é€’æ–¹å¼</p><ol><li><code>type fail = (message?: string) =&gt; any</code></li><li><code>type fail = (actual: any, expected: any, message?: string, operator: string) =&gt; any</code><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//ä»¥ä¸‹å‡ä¼šå‡ºé”™</span><br><span class="hljs-comment">//ç›´æ¥ä½¿ç”¨</span><br>expect.fail()<br>expect.fail(<span class="hljs-string">&#x27;it is error&#x27;</span>)<br><span class="hljs-comment">//å€¼åˆ¤æ–­</span><br>expect.fail(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;it is impossible&#x27;</span>)<br>expect.fail(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;it is impossible&#x27;</span>, <span class="hljs-string">&#x27;&gt;&#x27;</span>)<br></code></pre></td></tr></table></figure><a href="#top">é¡¶</a></li></ol><p><span id="ordered"></span></p><p><strong>.ordered</strong><br>é…åˆ<code>members</code>ç”¨äºæŒ‡å®š<code>members</code>å‚æ•°æ•°ç»„çš„é¡ºåºä¸ä¸»è¯­æ•°ç»„çš„é¡ºåºä¸€è‡´</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">//memberså‚æ•°å¿…é¡»æŒ‰é¡ºåº</span><br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.ordered.members([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>])<br>expect([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]).to.be.not.ordered.members([<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>])<br></code></pre></td></tr></table></figure><p><a href="#top">é¡¶</a></p><h2 id="å®Œç»“"><a href="#å®Œç»“" class="headerlink" title="å®Œç»“"></a>å®Œç»“</h2><p>ğŸ˜Š<br>å¦‚æœæœ‰ä»€ä¹ˆä¸å¯¹çš„åœ°æ–¹ï¼Œè¯·æŒ‡å‡ºã€‚</p>]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•</category>
      
      <category>node</category>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Chai</tag>
      
      <tag>BDD</tag>
      
      <tag>expect</tag>
      
      <tag>test</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰è¶£çš„csså±æ€§content</title>
    <link href="/2020/08/13/%E6%9C%89%E8%B6%A3%E7%9A%84css%E5%B1%9E%E6%80%A7content/"/>
    <url>/2020/08/13/%E6%9C%89%E8%B6%A3%E7%9A%84css%E5%B1%9E%E6%80%A7content/</url>
    
    <content type="html"><![CDATA[<p>ä»Šå¤©è¯´ä¸€ä¸ªéå¸¸æœ‰è¶£çš„<code>css</code>å±æ€§<code>content</code>ï¼Œå¯èƒ½å¾ˆå¤šäººéƒ½ä¼šè¯´ï¼Œè¿™ä¸ªå±æ€§è°ä¼šä¸çŸ¥é“ï¼Œå¯¹äºä¸€äº›è€æ‰‹æ¥è¯´ï¼Œè¿™ä¸ªå±æ€§ç¡®å®å¯èƒ½æ˜¯ç»å¸¸ä¼šç”¨åˆ°ï¼Œä½†æ˜¯æ€»ä¼šæœ‰ä½ æ²¡æœ‰å‘ç°çš„åœ°æ–¹ï¼Œä»Šå¤©å°±æ¥å¥½å¥½çš„è®²è®²è¿™ä¸ªæœ‰è¶£çš„<code>css</code>å±æ€§ã€‚<br>ä»¥ä¸‹çŸ¥è¯†å†…å®¹å‡æ¥è‡ªäº<a href="https://www.zhangxinxu.com/">å¼ é‘«æ—­çš„ã€Šcssä¸–ç•Œã€‹</a>ï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»çœ‹çœ‹ã€‚</p><h2 id="content-ä»‹ç»"><a href="#content-ä»‹ç»" class="headerlink" title="content ä»‹ç»"></a>content ä»‹ç»</h2><p><code>content</code>ç”¨äºå…ƒç´ å†…å®¹çš„å±•ç¤ºï¼Œå¹³å¸¸ç”¨çš„å¤šçš„åœ°æ–¹åœ¨äºå†…å®¹å‰åçš„å…·ä½“æ–‡å­—å†…å®¹æˆ–è€…æ˜¯å›¾ç‰‡ã€‚å›¾ç‰‡å…¶å®æ²¡æœ‰å¾ˆå¤šå¥½ä»‹ç»ï¼Œä½†æ˜¯å…³äºæ–‡å­—æ–¹é¢ï¼Œå®ƒæœ‰å¾ˆå¤šç§çš„ç±»å‹ï¼Œä¸‹é¢å°±ä¸€ä¸€å°†<code>content</code>çš„å€¼ç±»å‹è¿›è¡Œä»‹ç»ã€‚</p><h3 id="content-å±æ€§"><a href="#content-å±æ€§" class="headerlink" title="content å±æ€§"></a>content å±æ€§</h3><ol><li><strong>normal</strong>  </li></ol><p>è¿™æ˜¯<code>content</code>å±æ€§çš„é»˜è®¤å€¼ï¼Œåœ¨ä¼ªå…ƒç´ ä¸­ä¼šè¢«è®¤å®šä¸º<code>none</code></p><ol start="2"><li><strong>none</strong> </li></ol><p>æŒ‡å®šä¸äº§ç”Ÿä¼ªå…ƒç´ </p><ol start="3"><li><strong>url</strong>  </li></ol><p>å¯ä»¥ä½¿ç”¨å›¾ç‰‡æ¥è¿›è¡Œå±•ç¤ºï¼Œæ¯”å¦‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-tag">div</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">text-align</span>: center;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&#x27;/images/æœ‰è¶£çš„csså±æ€§content/cssä¸–ç•Œ.jpg&#x27;</span>);</span><br><span class="css">    <span class="hljs-attribute">display</span>: block;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹å›¾</p><img src="/images/æœ‰è¶£çš„csså±æ€§content/url-show.png" width="188" height="334" /><p><code>url</code>çš„å‚æ•°æœ‰å¾ˆå¤šç§ï¼Œæœ€å¸¸ç”¨çš„å°±æ˜¯è·¯å¾„<br>ç„¶åå°±æ˜¯<code>icon</code>ã€<code>svg</code>ã€<code>base64</code>ç¼–ç çš„å›¾ç‰‡ï¼Œä½†æ˜¯ä¸æ”¯æŒ<code>css3æ¸å˜</code>èƒŒæ™¯å›¾ã€‚  </p><p>è™½ç„¶æœ‰è¿™ç§æ–¹æ³•å¯ä»¥ç”Ÿæˆå›¾ç‰‡ï¼Œä½†æ˜¯å®é™…ä¸­å¹¶æ— å¤ªå¤§ç”¨å¤„ï¼ŒåŸå› å°±åœ¨äºæ— æ³•é€šè¿‡è®¾ç½®å®½é«˜æ¥æ”¹å˜å›¾ç‰‡çš„å›ºæœ‰å°ºå¯¸ã€‚  </p><p>ä¸€èˆ¬éƒ½æ˜¯ä½¿ç”¨<code>background-image</code>æ¥å®ç°ç›¸å…³çš„åŠŸèƒ½ã€‚</p><p>ä¸è¿‡<code>base64</code>å½¢å¼å´èƒ½è§£å†³ä¸Šé¢çš„é—®é¢˜<br>ä¸€èˆ¬æƒ…å†µä¸‹å›¾ç‰‡åœ¨åŠ è½½è¿‡ç¨‹ä¸­éƒ½ä¼šå­˜åœ¨å°ºå¯¸ä¸º<code>0</code>çš„æ—¶å€™ï¼Œæ‰€ä»¥åœ¨åŠ è½½å®Œæˆæ—¶é¡µé¢ä¼šå­˜åœ¨å›¾ç‰‡æ™ƒåŠ¨çš„æƒ…å†µã€‚<br><code>base64</code>å›¾ç‰‡æ²¡æœ‰è¿™ä¸ªè¿‡ç¨‹ã€‚<br>ä½†æ˜¯<code>base64</code>ä¹Ÿæœ‰ä¸å¥½çš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼Œ<code>base64</code>ç¼–ç åçš„å›¾ç‰‡ä½“ç§¯æ¯”ä¹‹å‰è¦å¤§ä¸Š1/3å·¦å³ã€‚</p><ol start="4"><li><strong>attr</strong>  </li></ol><p><code>attr</code>å’Œå®ƒåå­—ä¸€æ ·ï¼Œå®ƒèƒ½å¤Ÿé€‰æ‹©åˆ°è¯¥å…ƒç´ èº«ä¸Šçš„å±æ€§ã€‚<br>æ¯”å¦‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css"><span class="hljs-selector-tag">img</span>&#123;</span><br><span class="css">  <span class="hljs-attribute">text-align</span>:center;</span><br><span class="css">&#125;</span><br><span class="css"><span class="hljs-selector-tag">img</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">  <span class="hljs-attribute">content</span>: <span class="hljs-built_in">attr</span>(width);  </span><br><span class="css">&#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;å›¾ç‰‡&quot;</span> /&gt;</span><br></code></pre></td></tr></table></figure><img src="/images/æœ‰è¶£çš„csså±æ€§content/attr-show.png" width="188" height="334" /><p>è¿™æ ·å¯ä»¥æ˜¾ç¤ºåˆ°<code>img</code>å…ƒç´ çš„<code>width</code>å±æ€§çš„å€¼ã€‚<br>å¹¶ä¸”ï¼Œå®ƒè¿˜èƒ½å¤Ÿè·å–åˆ°è‡ªå®šä¹‰å±æ€§çš„å€¼ï¼Œæ¯”å¦‚<code>attr(data-name)</code></p><p>æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œçš„å±æ€§åç§°æ˜¯ä¸éœ€è¦<strong>å¼•å·</strong>çš„ã€‚</p><ol start="5"><li><strong>string</strong>  </li></ol><p>è¿™ä¸ªçš„è¯æˆ‘æƒ³åº”è¯¥ä¸ç”¨å¤šè¯´ï¼Œå¤§å®¶ç”¨çš„ä¹Ÿæ˜¯ç›¸å½“ç†Ÿç»ƒçš„ã€‚ä½†æ˜¯ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ä½¿ç”¨è¿‡<code>Unicode</code>å­—ç¬¦ï¼Ÿ<br>åœ¨ä¹¦ä¸­å‘ç°äº†ä¸€ä¸ªåˆ©ç”¨æ­¤ç‰¹æ€§çš„å°æ —å­ğŸŒ°ï¼Œæ„Ÿè§‰éå¸¸å¥½ç”¨ï¼Œè¿™é‡Œå†™å‡ºæ¥ç»™å¤§å®¶å‚è€ƒä¸€ä¸‹ã€‚<br>ä¸‹é¢å®ç°äº†ä¸€ä¸ªåŠ¨æ€loadingåŠ è½½çš„æ•ˆæœã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  dot&#123;</span><br><span class="css">    <span class="hljs-attribute">display</span>:inline-block;</span><br><span class="css">    <span class="hljs-attribute">height</span>:<span class="hljs-number">1em</span>;</span><br><span class="css">    <span class="hljs-attribute">line-height</span>:<span class="hljs-number">1</span>;</span><br><span class="css">    <span class="hljs-attribute">overflow</span>:hidden;</span><br><span class="css">    <span class="hljs-attribute">text-align</span><span class="hljs-selector-pseudo">:left</span>;</span><br><span class="css">    <span class="hljs-attribute">vertical-align</span>: -.<span class="hljs-number">25em</span>;</span><br><span class="css">  &#125;</span><br><span class="css">  dot<span class="hljs-selector-pseudo">::before</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-string">&#x27;...\A..\A.&#x27;</span>;</span><br><span class="css">    <span class="hljs-attribute">animation</span>: loading <span class="hljs-number">3s</span> infinite step-start both;</span><br><span class="css">    <span class="hljs-attribute">display</span>:block;</span><br><span class="css">    <span class="hljs-attribute">white-space</span>: pre-wrap;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-keyword">@keyframes</span> loading &#123;</span><br><span class="css">    <span class="hljs-number">33%</span> &#123; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">2em</span>); &#125;</span><br><span class="css">    <span class="hljs-number">66%</span> &#123; <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateY</span>(-<span class="hljs-number">1em</span>); &#125;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>åŠ è½½ä¸­<br>  <span class="hljs-tag">&lt;<span class="hljs-name">dot</span>&gt;</span>...<span class="hljs-tag">&lt;/<span class="hljs-name">dot</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æ•ˆæœï¼Œå¯èƒ½å›¾ç‰‡çœ‹èµ·æ¥æœ‰äº›ä¸æµç•…ï¼Œä½†æ˜¯å®é™…æ•ˆæœæ˜¯æµç•…çš„ã€‚   </p><img src="/images/æœ‰è¶£çš„csså±æ€§content/loading.GIF" width="376" height="668" /><p>è¿™ä¸€æ–¹æ³•çš„å¥½å¤„å°±æ˜¯ç›¸å½“å¥½çš„å…¼å®¹æ€§ï¼Œå®ƒåˆ©ç”¨ä¸Šè¿°ç‰¹æ€§å’Œ<code>css3</code>çš„åŠ¨ç”»æ•ˆæœæ¥å®ç°ã€‚ </p><p>å¹¶ä¸”åœ¨ä½ç‰ˆæœ¬æµè§ˆå™¨ä¸‹è™½ç„¶æ”¯æŒä¸äº†<code>animation</code>å±æ€§ï¼Œä½†æ˜¯å®ƒä¹Ÿèƒ½è‰¯å¥½çš„å±•ç¤ºé™æ€æ•ˆæœã€‚</p><ol start="6"><li><strong>open-quoteã€close-quote</strong>  </li></ol><p>å…³äºè¿™ä¸ªå±æ€§ï¼Œç®—æ˜¯ä¸€ä¸ªå¥½ç”¨å´åˆä¸å®ç”¨çš„å±æ€§å§ï¼Œå®ƒæœ¬èº«è‰¯å¥½çš„ç‰¹æ€§å¯ä»¥å®Œæˆå¹³å¸¸çš„è®¸å¤šä¸šåŠ¡é—®é¢˜ï¼Œä½†æ˜¯å´åˆæ˜¾å¾—æ²¡æœ‰é‚£ä¹ˆå¿…è¦ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-pseudo">:nth-of-type</span>(<span class="hljs-number">1</span>)&#123;</span><br><span class="css">    <span class="hljs-attribute">quotes</span>: <span class="hljs-string">&#x27;æé—®: &quot;&#x27;</span> <span class="hljs-string">&#x27;&quot;&#x27;</span>;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-pseudo">:nth-of-type</span>(<span class="hljs-number">1</span>)&#123;</span><br><span class="css">    <span class="hljs-attribute">quotes</span>: <span class="hljs-string">&#x27;å›ç­”: &quot;&#x27;</span> <span class="hljs-string">&#x27;&quot;&#x27;</span>;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-pseudo">::before</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: open-quote;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span> <span class="hljs-selector-tag">p</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: close-quote;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ques&quot;</span>&gt;</span>ä¸ºä»€ä¹ˆæˆ‘è¿™ä¹ˆå¸…ï¼Ÿ<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;answ&quot;</span>&gt;</span>å¤©ç”Ÿçš„ï¼<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><img src="/images/æœ‰è¶£çš„csså±æ€§content/quotes-show.png" width="188" height="334" /><p>è¿˜æœ‰<code>no-open-quote</code> <code>no-close-quote</code>ï¼Œå’Œåå­—ä¸€ä¸‹ï¼Œå°±æ˜¯åœ¨å¼€å§‹å’Œç»“æŸä¸éœ€è¦è¯¥å†…å®¹ã€‚</p><ol start="7"><li><strong>counter</strong>  </li></ol><p>æ¥ä¸‹æ¥æœ€åè¦ç€é‡ä»‹ç»çš„ä¸€ä¸ªå±æ€§ï¼Œ<code>counter</code>ã€‚è®¡æ•°å™¨ã€‚  </p><p>å¤§å®¶åº”è¯¥æœ‰è§è¿‡<code>word</code>æ–‡æ¡£ä¸­çš„é‚£ç§æ ‡é¢˜å§ï¼Œå…¶å®é‚£ç§æ ·å¼å¯ä»¥é€šè¿‡<code>css</code>æ¥è‡ªåŠ¨ç”Ÿæˆã€‚<br>æ²¡æœ‰é”™ï¼Œç”¨åˆ°çš„å°±æ˜¯ç°åœ¨ä»‹ç»çš„è¿™ä¸ªå±æ€§ã€‚<br>å®ƒåªéœ€è¦å‡ è¡Œcssä»£ç å°±èƒ½å®ç°é‚£æ ·çš„æ•ˆæœã€‚  </p><p>é¦–å…ˆæ˜¯ç›¸å…³çš„å‡ ä¸ªå±æ€§ã€‚<br><code>counter-reset</code> <code>counter-increment</code> <code>counter()</code> <code>counters()</code>  </p><p>ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li><strong>å®šä¹‰è®¡æ•°å™¨åç§° counter-reset</strong>  </li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-tag">div</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">counter-reset</span>: counter-name <span class="hljs-number">2</span>;  </span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-built_in">counter</span>(counter-name);</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>è¿™æ˜¯counterè®¡æ•°å™¨çš„åˆå§‹å€¼: <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªè®¡æ•°å™¨ï¼Œåç§°å«<code>counter-name</code> å¹¶ä¸”èµ·å§‹ä¸º2<br><img src="/images/æœ‰è¶£çš„csså±æ€§content/counter-init-show.png" width="188" height="334" /></p><p>å…³äºåé¢<code>èµ·å§‹æ•°å­—</code>çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>è´Ÿæ•°</code>ï¼Œä¹Ÿå¯ä»¥å†™æˆ<code>å°æ•°</code>ã€‚<br>ä¸è¿‡å¯¹äº<code>ie</code>å’Œ<code>firefox</code>æ˜¯ç›´æ¥æ— è§†çš„ï¼Œé»˜è®¤ä¸º<code>0</code>ï¼Œè€Œå¯¹äº<code>chrome</code>æ¥è¯´åˆ™æ˜¯å¤„ç†æˆå‘ä¸‹å–æ•´ã€‚  </p><p>ä½ ä¹Ÿå¯ä»¥åŒæ—¶å®šä¹‰å¤šä¸ªè®¡æ•°å™¨ã€‚å¦‚ä¸‹<br><code>counter-reset: coutner-name1 3 counter-name2 4</code>  </p><ul><li><strong>é€’å¢</strong>  </li></ul><p>ç¬¬ä¸€æ­¥ä¸­å®ç°çš„æ˜¯æ˜¾ç¤ºè®¡æ•°å™¨çš„å€¼ï¼Œè€Œæ­¤æ­¥éª¤åˆ™æ˜¯çœŸæ­£èƒ½è®©è®¡æ•°å™¨å¼€å§‹è®¡æ•°çš„å…³é”®ã€‚  </p><p><code>counter-increment</code> ç”¨æ¥è®©è®¡æ•°å™¨ç´¯åŠ ï¼Œå¦‚ä¸‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-tag">div</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">counter-reset</span>: counter;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">::before</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-string">&#x27;é€’å¢å‰æˆ‘æ˜¯: &#x27;</span> <span class="hljs-built_in">counter</span>(counter);</span><br><span class="css">    <span class="hljs-attribute">display</span>:block;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">counter-increment</span>: counter <span class="hljs-number">2</span>;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-string">&#x27;é€’å¢åæˆ‘æ˜¯: &#x27;</span> <span class="hljs-built_in">counter</span>(counter);</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤º  </p><img src="/images/æœ‰è¶£çš„csså±æ€§content/counter-increment-show.png" width="188" height="334" />  <p>ä¸Šé¢æŒ‡å®šäº†<code>counter</code>è®¡æ•°å™¨å¢åŠ äº†<code>2</code>ï¼Œåé¢çš„æ•°å­—ä¹Ÿå¯ä»¥æ˜¯<code>è´Ÿå€¼</code>ï¼Œè¿™æ ·å°±å®ç°äº†é€’å‡çš„æ•ˆæœã€‚  </p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶åœ¨ä¸åŒå…ƒç´ ä¸Šè®¡æ•°å™¨å¹¶ä¸ä¼šäº§ç”Ÿæ•ˆæœï¼Œä½†æ˜¯å¦‚æœåœ¨å…¶ä¸­ä½¿ç”¨äº†<code>counter-increment</code>é‚£ä¹ˆå®ƒå°±ä¼šäº§ç”Ÿæ•ˆæœã€‚  </p><p><code>counter()</code>å’Œ<code>counters()</code>è¿˜æœ‰ä¸€äº›å‚æ•°å¯ä»¥é€‰æ‹©  </p><blockquote><p>counter(name, style)<br>counters(name, string)<br>counters(name, string, style)  </p></blockquote><p><code>strig</code>å°±æ˜¯è¿æ¥ç¬¦  </p><p><code>style</code>çš„è¯ï¼Œå®ƒçš„å€¼å’Œ<code>list-style</code>çš„å€¼ç›¸åŒ<br>æ‰€ä»¥åœ¨å±•ç¤ºæ—¶ï¼Œå¯ä»¥ä¸ä¸€å®šæ˜¾ç¤ºæ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºå…¶ä»–çš„å­—ç¬¦ã€‚<br>å…·ä½“å¯ä»¥å‚è€ƒ <a href="https://www.w3school.com.cn/css/pr_list-style-type.asp">list-style</a>  </p><p>æ¯”å¦‚ä¸‹é¢  </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="css"></span><br><span class="css">  <span class="hljs-selector-class">.box</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">counter-reset</span>: counter;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-class">.box</span><span class="hljs-selector-pseudo">::before</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">content</span>: <span class="hljs-string">&#x27;æˆ‘æœ‰å¤šå¸…?&#x27;</span>;</span><br><span class="css">  &#125;</span><br><span class="css">  <span class="hljs-selector-class">.counter</span><span class="hljs-selector-pseudo">::after</span>&#123;</span><br><span class="css">    <span class="hljs-attribute">counter-increment</span>: counter;</span><br><span class="css">    <span class="hljs-attribute">quotes</span>: <span class="hljs-string">&#x27;ç»å¯¹&quot;&#x27;</span> <span class="hljs-string">&#x27;+&quot;å•Š&#x27;</span>;</span><br><span class="css">    <span class="hljs-attribute">content</span>: open-quote <span class="hljs-built_in">counters</span>(counter, <span class="hljs-string">&#x27;-&#x27;</span>, upper-latin) close-quote;</span><br><span class="css">  &#125;</span><br><span class="css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;box&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;counter&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>  <br></code></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹å›¾<br><img src="/images/æœ‰è¶£çš„csså±æ€§content/quotes-show.png" width="188" height="334" />  </p><p>å…³äºå‰é¢è¯´çš„<code>word</code>æ–‡æ¡£æ ‡é¢˜çš„çº§è”æ•ˆæœï¼Œç”¨åˆ°çš„å°±æ˜¯<code>counters()</code>è¿™ä¸ªæ–¹æ³•  </p><p>ä¸‹é¢æ˜¯ç®€å•çš„æ•ˆæœã€‚  </p><pre><code class="html"><span class="tag">&lt;<span class="name">style</span>&gt;</span>  .reset&#123;    counter-reset: counter;  &#125;  .counter::after&#123;    counter-increament: counter;    content: couters(counter, '-') '.';  &#125;<span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"reset"</span>&gt;</span>  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>    ç¬¬ä¸€    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"reset"</span>&gt;</span>      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>ç¬¬ä¸€ä¸€<span class="tag">&lt;/<span class="name">div</span>&gt;</span>      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>ç¬¬ä¸€äºŒ<span class="tag">&lt;/<span class="name">div</span>&gt;</span>    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>  <span class="tag">&lt;/<span class="name">div</span>&gt;</span>  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>    ç¬¬äºŒ    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"reset"</span>&gt;</span>      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>        ç¬¬äºŒä¸€        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"reset"</span>&gt;</span>          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>ç¬¬äºŒä¸€<span class="tag">&lt;/<span class="name">div</span>&gt;</span>          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>ç¬¬äºŒäºŒ<span class="tag">&lt;/<span class="name">div</span>&gt;</span>        <span class="tag">&lt;/<span class="name">div</span>&gt;</span>      <span class="tag">&lt;/<span class="name">div</span>&gt;</span>      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>ç¬¬äºŒäºŒ<span class="tag">&lt;/<span class="name">div</span>&gt;</span>    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>  <span class="tag">&lt;/<span class="name">div</span>&gt;</span>    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"counter"</span>&gt;</span>    ç¬¬ä¸‰  <span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></code></pre><p>æ•ˆæœå¦‚ä¸‹å›¾  </p><img src="/images/æœ‰è¶£çš„csså±æ€§content/counters.png" width="188" height="334" />  <h2 id="å®Œç»“"><a href="#å®Œç»“" class="headerlink" title="å®Œç»“"></a>å®Œç»“</h2><p>åˆç†çš„ä½¿ç”¨csså±æ€§å¯ä»¥è®©ä½ åœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­å‡å°‘å¾ˆå¤šçš„å·¥ä½œï¼Œä½¿ç”¨csså®Œæˆçš„æ•ˆæœæ€»æ¯”ç”¨csså®Œæˆæ€§èƒ½è¦å¥½çš„å¤šã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CSS</category>
      
      <category>å‰ç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CSS</tag>
      
      <tag>content</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Reactæ—¥å†ç»„ä»¶</title>
    <link href="/2020/07/26/React%E6%97%A5%E5%8E%86%E7%BB%84%E4%BB%B6/"/>
    <url>/2020/07/26/React%E6%97%A5%E5%8E%86%E7%BB%84%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<p>è¿™æ˜¯æœ¬äººå†™çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæ¬¢è¿å„ä½è§‚çœ‹çš„æœ‹å‹ğŸ‘­ã€‚<br><img src="/images/Reactæ—¥å†ç»„ä»¶/2de9716fa4db0bdb643f6a0e87ad6819.JPG" width=100 height=100 /><br>å…ˆä»‹ç»ä¸€ä¸‹è‡ªå·±ï¼Œæœ¬äººæ˜¯ä¸€ä¸ªåˆšåˆšè¿›å…¥ç¤¾ä¼šçš„å‰ç«¯èœé¸Ÿï¼Œç›®å‰æœåŠ¡äºä¸€å®¶å…¬å¸ğŸ­ã€‚</p><h2 id="1-æ•…äº‹èƒŒæ™¯"><a href="#1-æ•…äº‹èƒŒæ™¯" class="headerlink" title="1 æ•…äº‹èƒŒæ™¯"></a>1 æ•…äº‹èƒŒæ™¯</h2><p>äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œæœ€è¿‘åœ¨å…¬å¸çš„h5é¡¹ç›®ä¸­ç¢°åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œé¡µé¢ä¸­éœ€è¦æœ‰ä¸€ä¸ªç”¨äºæ˜¾ç¤ºæœ€è¿‘è®¢å•çš„æ—¥å†æ ·å¼ï¼Œä½ æ²¡æœ‰çœ‹é”™ï¼Œä¸€ä¸ªæ—¥å†ï¼Œè¿™ç»™æˆ‘éš¾åˆ°äº†ï¼Œæœ¬æ¥æƒ³ç€ä¸å°±æ˜¯æ˜¯ä¸€ä¸ªæ—¥å†å—ï¼Œè¿™æœ‰ä»€ä¹ˆéš¾çš„ï¼Œåæ¥æˆ‘å‘ç°å¥½åƒä¼¼ä¹æ˜¯é«˜ä¼°äº†è‡ªå·±ã€‚ </p><p>å…ˆä»‹ç»ä¸‹å…³äºè¿™ä¸ªæ—¥å†çš„æ ·å¼ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œè„‘è¡¥ä¸€ä¸‹è‹¹æœä¸­è‡ªå¸¦çš„æ—¥å†æˆ–çœ‹ä¸‹å›¾ï¼ŒåŸºæœ¬å’Œå®ƒå·®ä¸å¤šã€‚å¤šäº†ä¸€ç‚¹éœ€æ±‚æ˜¯ï¼Œåœ¨ç‚¹å‡»æŸä¸€ä¸ªæ—¥æœŸæˆ–è€…æ˜¯æ‰‹æŒ‡æ»‘åŠ¨è¿‡ç¨‹ä¸­ï¼Œæ—¥å†ä¸‹æ–¹çš„è®¢å•åˆ—è¡¨ä¼šæ ¹æ®æ—¥æœŸçš„å˜åŠ¨è‡ªåŠ¨è·³è½¬åˆ°å½“å‰æ—¥æœŸçš„è®¢å•ã€‚<br><img src="/images/Reactæ—¥å†ç»„ä»¶/IMG_0144.PNG" width=188 height=334 /><br><img src="/images/Reactæ—¥å†ç»„ä»¶/IMG_0145.PNG" width=188 height=334 /> </p><p>å› ä¸ºé¡¹ç›®ç”¨çš„æŠ€æœ¯æ ˆæ˜¯Reactï¼Œä¼¼ä¹ç†æ‰€åº”å½“è¯¥ç”¨ Ant Design æ¥å®Œæˆï¼Œå°±pcç«¯è€Œè¨€ï¼ŒAnt Design çš„<a href="https://ant.design/components/calendar-cn/">æ—¥å†ç»„ä»¶</a>ç›¸å¯¹äºæ¥è¯´ç®—æ˜¯éå¸¸ä¸é”™ä¸”è¿˜ç®—å¥‘åˆçš„ï¼Œå¥ˆä½•h5ä½¿ç”¨çš„æ˜¯Ant Design Mobileï¼Œç›¸å¯¹äºæ¥è¯´çš„è¯ï¼Œä»¥ä¸ªäººä¹‹è§ï¼Œç¡®å®è¿˜æœ‰è®¸å¤šå¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Œmobileä¸­çš„<a href="https://mobile.ant.design/components/calendar-cn/">æ—¥å†ç»„ä»¶</a>å¾ˆå¤šåœ°æ–¹è¡¨ç°çš„è¿˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œæœ‰äº›åœ°æ–¹è¿˜æ˜¯è¿‡äºå®šåˆ¶åŒ–ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥å®Œå–„ã€‚</p><p>æ‰€ä»¥ï¼Œç»è¿‡è‡ªå·±å†ä¸‰çš„å¯¹mobileçš„Calendarç»„ä»¶çš„ä¿®æ”¹ï¼ˆç78ä¹±æï¼‰ä»¥åŠæ€æƒ³æ–—äº‰ï¼ˆä¸æƒ³æäº†ï¼‰ä¹‹åã€‚ç»ˆäºï¼Œé€‰æ‹©è‡ªå·±åšå°è£…ï¼Œåœ¨å°è£…çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿè®©æœ¬äººå­¦ä¹ åˆ°äº†ä¸€äº›ä¹‹å‰è¿˜æ²¡æœ‰æ³¨æ„çš„ä¸œè¥¿ã€‚ä»Šå¤©ä¹Ÿä¸€å¹¶ä½œä»‹ç»ï¼Œè¿™ä¹Ÿæ˜¯å¯¹æ–°çŸ¥è¯†çš„å†ä¸€æ¬¡å¤ä¹ ã€‚</p><h2 id="2-æ­£ç‰‡å¼€å§‹"><a href="#2-æ­£ç‰‡å¼€å§‹" class="headerlink" title="2 æ­£ç‰‡å¼€å§‹"></a>2 æ­£ç‰‡å¼€å§‹</h2><p>è¿™é‡Œå…ˆä¸ä»‹ç»å…·ä½“ä¸šåŠ¡ä¸Šå…³äºåˆ—è¡¨è·³è½¬æ–¹é¢çš„å†…å®¹ã€‚åªå¯¹æ—¥å†ç›¸å…³ä½œä»‹ç»ğŸ™‚ã€‚</p><h3 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h3><p>é¦–å…ˆæ˜¯ä¸æ—¥å†æœ‰é‡è¦å…³ç³»çš„API Dateã€‚å¯èƒ½å¾ˆå¤šäººä¼šè¯´ï¼Œä¸ä¼šå§ï¼Œä¸ä¼šå§ï¼Œä¸ä¼šè¿˜æœ‰äººä¼šå»ç”¨åŸç”ŸDateå§ã€‚ç°åœ¨ç¡®å®åœ¨momentjså’Œdayjsé¢å‰ï¼ŒåŸç”ŸDateçš„æ“ä½œç¡®å®æ˜¾å¾—æœ‰äº›å¤æ‚ï¼Œä½†æ˜¯æ€»å½’æ¥è¯´è¿˜æ˜¯è¦å¥½å¥½å­¦ä¹ åŸç”Ÿjsçš„çŸ¥è¯†ï¼Œè¿™æ ·æ‰èƒ½æœ‰æ›´å¥½çš„æå‡ã€‚æ€»çš„æ¥è¯´ï¼Œå¤šå­¦æ€»ä¸ä¼šé”™ï¼ˆè™½ç„¶è¿˜æ˜¯å¾ˆæ‡’ï¼‰ã€‚</p><ol><li>æ—¥æœŸåˆ›å»º<br><code>new Date()</code>  </li></ol><ul><li>é»˜è®¤ä¸ä¼ å‚æ•°æ—¶ï¼Œè¿”å›çš„å½“å‰çš„æ—¶é—´ <code>new Date()</code></li><li>ä¼ é€’æ—¶é—´æˆ³ <code>new Date(19999009090)</code></li><li>æˆ–è€…å†æ”¾ä¸€ä¸ªDateå®ä¾‹ <code>new Date(new Date())</code></li><li>ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æŒ‰é¡ºåº å¹´ã€æœˆã€æ—¥â€¦ <code>new Date(2020, 6, 1)</code><ul><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äºæœˆä»½çš„å‚æ•°ï¼ŒèŒƒå›´æ˜¯0-11ã€‚  </li></ul></li></ul><p>æœ‰äº›æƒ…å†µä¸‹åœ¨éœ€è¦åšç›¸å…³è®¡ç®—æ—¶ï¼Œä¼ é€’å‚æ•°ä¼šç»™æˆ‘ä»¬çœä¸‹å¾ˆå¤šåŠŸå¤«<br>æ¯”å¦‚ï¼š<br> <strong>è·å–å½“å‰æœˆä»½çš„å¤©æ•°</strong><br> æ¯”å¦‚ç°åœ¨æ˜¯7æœˆä»½ï¼Œä½ æƒ³è®¡ç®—ä¸Šä¸€æœˆä»½çš„å¤©æ•°ï¼Œä½ å¯ä»¥è¿™æ ·<br><code>new Date(2020, 6, 0).getDate() //30</code><br>å½“å‚æ•°dayä¸º0æ—¶ï¼Œmonthä¼šè‡ªåŠ¨-1ï¼Œç›¸å½“äº<code>new Date(2020, 6, 30)</code><br> <strong>è·å–å½“å‰æœˆç¬¬ä¸€å¤©æˆ–è€…æœ€åä¸€å¤©çš„ä¿¡æ¯</strong><br>åŸç†åŒä¸Šï¼Œå¯ä»¥è¿™æ ·<code>new Date(2020, 6).getDay()</code>ï¼Œè¡¨ç¤º7æœˆç¬¬ä¸€å¤©æ˜ŸæœŸå‡ <br>2. æ—¥æœŸè®¾ç½®<br><code>setDate()</code> è®¾ç½®å‡ å·<br><code>setMonth()</code> è®¾ç½®å‡ æœˆï¼Œæ³¨æ„å’Œä¹‹å‰è¯´çš„ä¸€æ ·ï¼ŒèŒƒå›´æ˜¯0-11<br><code>setFullYear()</code> è®¾ç½®å¹´ä»½ï¼ŒsetYearçš„æ›¿ä»£ç‰ˆ<br>3. æ—¥æœŸè·å–<br><code>getTime()</code> è¿”å›è‡ª1970å¹´1æœˆ1æ—¥åˆ°ç°åœ¨çš„æ¯«ç§’æ•°<br><code>getDay()</code> æ˜ŸæœŸå‡ ï¼ˆèŒƒå›´æ˜¯0-6ï¼Œä¸€ä¸ªæ˜ŸæœŸä»æ˜ŸæœŸå¤©å¼€å§‹ï¼‰<br><code>getDate()</code> å‡ å·<br><code>getMonth()</code> å‡ æœˆ<br><code>getFullYear()</code> å“ªä¸€å¹´  </p><p>æœ‰äº†è¿™å‡ ä¸ªAPIçš„æ”¯æŒï¼Œåœ¨åšä¸€äº›æ—¥æœŸè®¡ç®—æ—¶ä¼šæ˜¾å¾—éå¸¸çš„æ–¹ä¾¿ã€‚</p><h3 id="Grid"><a href="#Grid" class="headerlink" title="Grid"></a>Grid</h3><p>ç¬¬äºŒä¸ªä»‹ç»çš„ä¸jsæ— å…³ï¼Œä¸cssç›¸å…³ï¼Œæ˜¯å…³äºæ—¥å†çš„å¸ƒå±€é—®é¢˜ã€‚Gridæ …æ ¼å¸ƒå±€ï¼Œå¬è¯´è¿™ç©æ„å„¿è€æ—©å°±å‡ºäº†ï¼Œå¥ˆä½•æœ¬äººçœ¼ç•Œçª„å±…ç„¶ç°åœ¨æ‰çŸ¥é“ï¼Œç”¨äº†ä¹‹åå‘ç°è¿™ä¸ªä¸œè¥¿çœŸçš„å¥½é¦™ï¼Œæœ¬äººè®¤ä¸ºæ˜¯éå¸¸é€‚åˆåšåƒæ—¥å†è¿™æ ·çš„ç»„ä»¶å·¥å…·çš„å¸ƒå±€ã€‚</p><p>ç›¸å…³ç”¨åˆ°APIæœ‰å¦‚ä¸‹ï¼ˆåé¢çš„å›¾åŸºæœ¬éƒ½æ¥è‡ªå·±<a href="http://www.ruanyifeng.com/home.html">é˜®ä¸€å³°è€å¸ˆ</a>çš„åšå®¢ï¼‰</p><p><strong>å®¹å™¨æ ·å¼</strong></p><ol><li><p>display<br>å¯ä»¥æ˜¯å—çº§æ …æ ¼ <img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032504.png" alt="grid"><br>ä¹Ÿå¯ä»¥æ˜¯è¡Œå†…æ …æ ¼ <img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032505.png" alt="inline-grid"><br>å’Œæ™®é€šçš„è¡Œå†…å—çº§æ„æ€ä¸€æ ·ï¼Œè¡Œå†…èƒ½æœ‰å¤šä¸ªæ …æ ¼å¸ƒå±€å¹¶æ’<br>å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯åœ¨girdå¸ƒå±€ä¸‹ï¼Œæœ‰ä¸€äº›æ ·å¼çš„è®¾ç½®æ— æ³•äº§ç”Ÿæ•ˆæœï¼Œæ¯”å¦‚:  </p><blockquote><p>floatã€display: inline-blockã€display: table-cellã€vertical-alignå’Œcolumn-*  </p></blockquote></li><li><p>grid-template-columns &amp; grid-template-rows<br>ç”¨äºå®šä¹‰gridå¸ƒå±€ä¸‹è¡Œå’Œåˆ—çš„æ•°é‡ï¼Œå®ƒçš„å€¼æœ‰å¾ˆå¤šç§  </p></li></ol><ul><li>é•¿åº¦å•ä½<br><code>grid-template-columns: 100px 100px 100px;</code><br><code>grid-template-rows: 100px 100px 100px;</code><br>è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ª 3è¡Œä¸‰åˆ—çš„å¸ƒå±€<br><img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032506.png" alt=""></li><li>fr<br>æ„æ€å¤§æ¦‚å°±æ˜¯ä¸€ä¸ªç‰‡æ®µï¼Œæ¯”å¦‚<br><code>grid-template-columns: 1fr 1fr;</code><br>æ„æ€æ˜¯å°†æ•´ä½“å¸ƒå±€åˆ†å‰²æˆç›¸ç­‰çš„ä¸¤åˆ—<br><img src="https://www.wangbase.com/blogimg/asset/201903/1_bg2019032509.png" alt=""><br><code>grid-template-columns: 150px 1fr 2fr;</code><br>æ„æ€æ˜¯ç¬¬äºŒä¸ªç‰‡æ®µæ˜¯ç¬¬ä¸€ä¸ªçš„ä¸¤å€<img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032510.png" alt="">  </li><li>repeatå‡½æ•°<br>æœ‰æ—¶å€™ä½ ä¼šè§‰å¾—ä¸€ä¸ªä¸ªè®¾ç½®å—çš„å®½åº¦å¾ˆéº»çƒ¦ï¼Œrepeatå‡½æ•°å¯ä»¥å°†ä½ è®¾å®šçš„å—æ•°æ®è¿›è¡ŒæŒ‡å®šçš„é‡å¤<br><code>grid-template-columns: repeat(3, 100px);</code><br>ç­‰åŒäº<br><code>grid-template-columns: 100px 100px 100px;</code><br>è¿˜å¯ä»¥ä½¿ç”¨å…³é”®å­— <code>auto-fill</code><br><code>grid-template-columns: repeat(auto-fill, 100px);</code><br>å®ƒä¼šæŒç»­å¹³é“º100pxå®½çš„å—ç›´åˆ°å½“å‰è¡Œå®½åº¦ä¸è¶³æ—¶ï¼Œæ¢è¡Œ  </li><li>minmaxå‡½æ•°<br><code>grid-template-columns: 100px minmax(100px, 200px) 100px;</code><br>è¡¨ç¤ºä¸­é—´åˆ—çš„å®½åº¦èŒƒå›´åœ¨100px å’Œ 200pxä¹‹é—´<br>å‚æ•°ä¹Ÿæ”¯æŒ fr å…³é”®å­—  </li><li>auto<br>å½“ä½ æŒ‡å®šäº†3åˆ—ï¼Œå¹¶è®¾ç½®äº†ä¸¤åˆ—çš„å®½åº¦ï¼Œä¸”å¸Œæœ›å¦ä¸€åˆ—å®½åº¦è‡ªé€‚åº”æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ­¤å…³é”®å­—ã€‚å¦‚<br><code>grid-template-columns: 100px auto 100px;</code>ä¸­é—´åˆ—ä¼šè‡ªåŠ¨è‡ªé€‚åº”</li></ul><ol start="3"><li><p>grid-row-gap &amp; grid-columns-gap &amp; grid-gap<br>è®¾ç½®å„ä¸ªå•å…ƒæ ¼ä¹‹é—´çš„é—´è·<br><code>grid-row-gap: 20px;</code><br><code>grid-column-gap: 20px;</code><br><img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032511.png" alt=""><br>grid-gapåˆ™æ˜¯å‰ä¸¤ä¸ªçš„æ··åˆå†™æ³•  </p></li><li><p>justify-items &amp; align-items &amp; place-items<br>å€¼ï¼š<code>start | end | center | stretch</code><br>è®¾ç½®å•å…ƒæ ¼çš„æ°´å¹³å‚ç›´å¯¹é½æ–¹å¼ï¼Œå‚æ•°å’Œflexå·®ä¸å¤šå°±ä¸è¯´äº†ï¼ˆæ‡’ï¼‰  </p></li><li><p>justify-content &amp; align-content &amp; place-content<br>å€¼ï¼š<code>start | end | center | stretch | space-around | space-between | space-evenly</code><br>å®¹æ˜“çš„æ°´å¹³å‚ç›´å¯¹é½æ–¹å¼ï¼Œå‚æ•°å’Œflexå·®ä¸å¤šå°±ä¸è¯´äº†ï¼ˆæ‡’ï¼‰  </p></li></ol><p><strong>é¡¹ç›®æ ·å¼</strong></p><ol><li>grid-column-start &amp; grid-column-end &amp; grid-row-start &amp; grid-row-end<br>å°±å’Œåå­—å·®ä¸å¤šçš„æ„æ€ï¼Œä»–å¯ä»¥è®©å•å…ƒæ ¼çš„æ”¾ç½®ä½ç½®å‘ç”Ÿåç§»ï¼Œæœ‰äº†è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥è®©æœ¬é¡¹ç›®ä¸­æ—¥å†çš„æœˆå¼€å¤´å‘ç”Ÿåç§»è€Œä¸å¿…åšå…¶ä»–çš„jsæ“ä½œã€‚<br>æŒ‰ç…§é˜®è€å¸ˆä¸Šé¢è¯´çš„å¯èƒ½æ›´å®¹æ˜“ç†è§£ï¼Œå®¹å™¨åˆ†æˆäº†æŒ‡å®šçš„è¡Œå’Œåˆ—ï¼Œä¹Ÿä¼šéšå³ç”Ÿæˆç±»ä¼¼è¡¨æ ¼çš„è¾¹æ¡†çº¿ï¼Œä½†æ˜¯ä¸ä¼šæ˜¾ç¤ºã€‚æ‰€ä»¥åç§»çš„æŒ‰ç…§ç½‘æ ¼çº¿çš„ç´¢å¼•è¿›è¡Œåç§»ã€‚<br><img src="https://www.wangbase.com/blogimg/asset/201903/1_bg2019032503.png" alt=""><br>æ¯”å¦‚<br><code>grid-column-start: 2;</code> è¡¨ç¤ºæŸä¸€å•å…ƒæ ¼çš„èµ·å§‹ä½ç½®æ˜¯å®¹å™¨çš„åˆ—ç½‘æ ¼çº¿çš„ç¬¬äºŒæ ¹ã€‚<br><code>grid-column-end: 4;</code> è¡¨ç¤ºæŸä¸€ä½†äº‘å“¥çš„ç»“æŸä½ç½®æ˜¯å®¹å™¨çš„åˆ—ç½‘æ ¼çº¿çš„ç¬¬å››æ ¹ã€‚<br><img src="https://www.wangbase.com/blogimg/asset/201903/bg2019032526.png" alt=""></li></ol><p><strong>å…¶ä»–å±æ€§</strong></p><p><code>grid-column-end</code> å•å…ƒæ ¼çš„åˆ—ç»“æŸä½ç½®<br><code>grid-row-start</code> å•å…ƒæ ¼çš„è¡Œèµ·å§‹ä½ç½®<br><code>grid-row-end</code> å•å…ƒæ ¼çš„è¡Œç»“æŸä½ç½®  </p><ol start="2"><li><p>justify-self &amp; align-self &amp; place-self<br>è®¾ç½®å•å…ƒæ ¼çš„æ°´å¹³å‚ç›´å¯¹é½æ–¹å¼ï¼Œå’Œä¸Šé¢å®¹å™¨çš„<code>justify-items</code>ç­‰æ•ˆæœç›¸åŒï¼Œåªæ˜¯æ­¤å±æ€§æ˜¯é’ˆå¯¹å•ä¸ªå•å…ƒæ ¼çš„ã€‚<br>ã€å…·ä½“ç»†èŠ‚ç›¸å…³çš„APIå¯ä»¥å‚è€ƒ<a href="http://www.ruanyifeng.com/blog/2019/03/grid-layout-tutorial.html">é˜®ä¸€å³°è€å¸ˆçš„åšå®¢</a>æˆ–è€…è‡ªè¡ŒæŸ¥çœ‹<a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/grid">MDN</a>è¿›è¡Œäº†è§£ã€‘</p><h3 id="Calendar"><a href="#Calendar" class="headerlink" title="Calendar"></a>Calendar</h3><p>å…·ä½“æ ·å¼æŸ¥çœ‹ä¸‹å›¾  </p></li><li><p>å•æ—¥ç€é‡  </p><img src="/images/Reactæ—¥å†ç»„ä»¶/1595859653524_95CA67F7-E00E-4AA0-A51C-85895C099433.png" width="200" height="100" /></li><li><p>å‘¨ç€é‡  </p><img src="/images/Reactæ—¥å†ç»„ä»¶/1595859783955_DE771404-5E95-4876-BA63-44D01118D2EF.png" width="200" height="100" /></li><li><p>è‰²è°ƒæ›´æ”¹  </p><img src="/images/Reactæ—¥å†ç»„ä»¶/1595859830441_DBC34DF0-2308-4DBB-90F7-A70B70795B82.png" width="200" height="100" /></li><li><p>æ˜¾ç¤ºå•å‘¨  </p><img src="/images/Reactæ—¥å†ç»„ä»¶/1595860081764_790B7081-F485-487D-9B74-5E88C13FD5FF.png" width="200" height="100" /></li><li><p>è®¾ç½®é¢å¤–å†…å®¹  </p><img src="/images/Reactæ—¥å†ç»„ä»¶/15938957-5F8F-4A7A-9F91-544D239677EC.png" width="200" height="100" /></li></ol><p>å› ä¸ºæ¯ä¸€ä¸ªå•å…ƒæ ¼å¤–å±‚è®¾ç½®äº†ç›¸å¯¹å®šä½<code>relative</code>ï¼Œæ‰€ä»¥å¦‚æœä¸å¸Œæœ›é¢å¤–å†…å®¹å¯¼è‡´ä¸ªåˆ«å•å…ƒæ ¼ä½ç½®ä¸ç»Ÿä¸€ï¼Œå¯ä»¥å°†å†…å®¹è®¾ç½®ä¸º<code>position: absolute;</code>  </p><p>å…·ä½“çš„å…¶ä»–åŠŸèƒ½å¯æŸ¥çœ‹ä¸‹æ–¹API  </p><p><strong>API</strong></p><table><thead><tr><th align="center">props</th><th align="center">è¯´æ˜</th><th align="center">ç±»å‹</th><th align="center">é»˜è®¤å€¼</th></tr></thead><tbody><tr><td align="center">collapse</td><td align="center"><div style="width:300pt">æ˜¯å¦æŠ˜å ï¼ŒæŠ˜å æ—¶åªæ˜¾ç¤ºä¸€å‘¨çš„æ—¥æœŸ</div></td><td align="center">boolean</td><td align="center">false</td></tr><tr><td align="center">lunerVisible</td><td align="center">æ˜¯å¦æ˜¾ç¤ºå†œå†æ—¶é—´</td><td align="center">boolean</td><td align="center">false</td></tr><tr><td align="center">showToday</td><td align="center">æ˜¯å¦ç€é‡æ˜¾ç¤ºå½“å¤©ï¼Œå¯¹å½“å¤©æ—¶é—´ç€é‡è¡¨ç¤º</td><td align="center">boolean</td><td align="center">true</td></tr><tr><td align="center">showWeek</td><td align="center">æ˜¯å¦ç€é‡æ˜¾ç¤ºå½“å‰å‘¨ï¼Œå¯¹æœ¬å‘¨æ—¶é—´ç€é‡è¡¨ç¤ºï¼Œå½“showTodayå’ŒshowWeekåŒæ—¶å­˜åœ¨æ—¶ï¼ŒshowWeekç”Ÿæ•ˆ</td><td align="center">boolean</td><td align="center">false</td></tr><tr><td align="center">activeStyle</td><td align="center">ç€é‡æ˜¾ç¤ºçš„æ ·å¼ï¼Œå¯ä»¥è‡ªå®šä¹‰ç€é‡æ˜¾ç¤ºçš„æ ·å¼</td><td align="center">Object</td><td align="center">{}</td></tr><tr><td align="center">value</td><td align="center">å½“å‰æ—¶é—´ï¼Œå¯é…åˆrc-formè¿›è¡Œä½¿ç”¨ï¼Œä¸ä¼ é€’æ­¤å‚æ•°æ—¶ç”±å†…éƒ¨æ§åˆ¶çŠ¶æ€å˜åŒ–</td><td align="center">Date</td><td align="center">false</td></tr><tr><td align="center">onChange</td><td align="center">ç›‘å¬æ—¥æœŸæ—¶é—´å˜åŒ–</td><td align="center">(date: Date) =&gt; any</td><td align="center">æ— </td></tr><tr><td align="center">hot</td><td align="center">æ—¥æœŸä¸‹ç€é‡ç‚¹</td><td align="center">æ˜¯å¦æ˜¾ç¤ºå†œå†æ—¶é—´</td><td align="center">Array<Date></td></tr><tr><td align="center">renderHeader</td><td align="center">æ—¥å†çš„header</td><td align="center">(date: Date) =&gt; ReactNode</td><td align="center">false</td></tr><tr><td align="center">renderFooter</td><td align="center">æ—¥å†çš„footer</td><td align="center">(date: Date) =&gt; ReactNode</td><td align="center">false</td></tr><tr><td align="center">renderDateFooter</td><td align="center">æ¯æ—¥çš„footer</td><td align="center">(date: Date) =&gt; ReactNode &#124; ReactNode</td><td align="center">false</td></tr><tr><td align="center">colorStyle</td><td align="center">æ—¥å†çš„æ•´ä½“é¢œè‰²é£æ ¼</td><td align="center">é¢œè‰²ï¼ˆç›®å‰åªæ”¯æŒåå…­è¿›åˆ¶é¢œè‰²ï¼‰</td><td align="center">#00CC73</td></tr><tr><td align="center">showLastNext</td><td align="center">æ˜¯å¦æ˜¾ç¤ºä¸Šä¸‹æœˆä»½çš„æ—¶é—´ä»¥å¡«å……æœˆå‰å’Œæœˆåçš„ç©ºç¼º</td><td align="center">boolean</td><td align="center">false</td></tr></tbody></table><p>è¿˜æœ‰ä¸€äº›æ–¹æ³•ä¾›è°ƒç”¨ï¼Œå¯åˆ©ç”¨<code>ref</code>æ¥è·å–ç›¸å…³æ–¹æ³•  </p><table><thead><tr><th align="center">name</th><th align="center">è¯´æ˜</th><th align="center">ä½¿ç”¨</th></tr></thead><tbody><tr><td align="center">getMonthStart</td><td align="center">å½“æœˆç¬¬ä¸€å¤©</td><td align="center">getMonthStart(month?, year?) =&gt; Date</td></tr><tr><td align="center">getMonthEnd</td><td align="center">å½“æœˆæœ€åä¸€å¤©</td><td align="center">getMonthEnd(month?, year?) =&gt; Date</td></tr><tr><td align="center">getMonthDays</td><td align="center">è·å–å½“æœˆå¤©æ•°</td><td align="center">getMonthDays(month?, year?) =&gt; number</td></tr><tr><td align="center">getThisWeek</td><td align="center">æœ¬å‘¨å¼€å§‹å’Œç»“æŸ</td><td align="center">getThisWeek(date) =&gt; [start:Date, end:Date]</td></tr><tr><td align="center">lastYear</td><td align="center">å»å¹´</td><td align="center">lastYear(date?) =&gt; Date</td></tr><tr><td align="center">lastMonth</td><td align="center">ä¸Šä¸ªæœˆ</td><td align="center">lastMonth(date?) =&gt; Date</td></tr><tr><td align="center">lastWeek</td><td align="center">ä¸Šå‘¨</td><td align="center">lastWeek(date?) =&gt; Date</td></tr><tr><td align="center">lastDay</td><td align="center">æ˜¨å¤©</td><td align="center">lastDay(date?) =&gt; Date</td></tr><tr><td align="center">nextYear</td><td align="center">æ˜å¹´</td><td align="center">nextYear(date) =&gt; Date</td></tr><tr><td align="center">nextMonth</td><td align="center">ä¸‹ä¸ªæœˆ</td><td align="center">nextMonth(date?) =&gt; Date</td></tr><tr><td align="center">nextWeek</td><td align="center">ä¸‹å‘¨</td><td align="center">nextWeek(date?) =&gt; Date</td></tr><tr><td align="center">nextDay</td><td align="center">æ˜å¤©</td><td align="center">nextDay(date?) =&gt; Date</td></tr></tbody></table><p>ä»<code>lastYear</code>å¼€å§‹çš„åé¢å‡ ä¸ªæ–¹æ³•ï¼Œåœ¨ä¼ å…¥Dateå‚æ•°æ—¶åªä¼šè¿”å›ç»“æœï¼Œè‹¥æœªä¼ å‚æ•°åˆ™ç»„ä»¶çŠ¶æ€ç”±å¤–éƒ¨æ§åˆ¶æˆ–ç”±å†…éƒ¨æ§åˆ¶ä¼šè§¦å‘<code>onChange</code>å›è°ƒã€‚</p><h2 id="3-ç»“æŸ"><a href="#3-ç»“æŸ" class="headerlink" title="3 ç»“æŸ"></a>3 ç»“æŸ</h2><p>è¿™å°±æ˜¯æ­¤æ¬¡æ‰€è¦è¯´çš„æ‰€æœ‰ï¼Œå¦‚æœ‰ä»»ä½•é—®é¢˜å¯ç›´æ¥è”ç³»æˆ‘ã€‚å¦‚æœè§‰å¾—ä¸œè¥¿å¾ˆçƒ‚å¯ä»¥ç›´æ¥æŒ‡å‡ºã€‚å¦‚æœå¯¹æ­¤ç»„ä»¶æ„Ÿå…´è¶£å¯ä»¥å»<a href="https://github.com/food-billboard/React-Component-Calendar">github</a>ä¸Šç»™ä¸€ä¸ªstarâœ¨ï¼Œå¦‚æœè§‰å¾—æ–‡ç« å†…å®¹å¯¹ä½ æœ‰ç”¨ï¼Œå¯ä»¥ç»™ä¸€ä¸ªèµğŸ‘æˆ–ä¸€ä¸ªè¯„è®ºğŸ“šã€‚</p>]]></content>
    
    
    <categories>
      
      <category>React</category>
      
      <category>å‰ç«¯</category>
      
      <category>CSS</category>
      
      <category>ç»„ä»¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>React</tag>
      
      <tag>Component</tag>
      
      <tag>Calendar</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
