

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  <meta name="description" content="技术交易系统新概念笔记 介绍 本文是本人在阅读了《技术交易系统新概念》所作的笔记。 开始 目录 记录一下目录：  第一章 基本概念 第二章 抛物式时间&#x2F;价格交易系统 第三章 波动交易系统 第四章 动向指标 第五章 动量概念-趋势平衡点交易系统 第六章 相对强弱指数 第七章 趋势-回调交易系统 第八章 摆动指标-短线交易系统 第九章 期货品种选择指标CSI 第十章 资金管理 基本概念 这里用到的一些">
<meta property="og:type" content="article">
<meta property="og:title" content="技术交易系统新概念笔记">
<meta property="og:url" content="http://yoursite.com/2022/11/28/%E6%8A%80%E6%9C%AF%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%96%B0%E6%A6%82%E5%BF%B5%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Food-Billboard">
<meta property="og:description" content="技术交易系统新概念笔记 介绍 本文是本人在阅读了《技术交易系统新概念》所作的笔记。 开始 目录 记录一下目录：  第一章 基本概念 第二章 抛物式时间&#x2F;价格交易系统 第三章 波动交易系统 第四章 动向指标 第五章 动量概念-趋势平衡点交易系统 第六章 相对强弱指数 第七章 趋势-回调交易系统 第八章 摆动指标-短线交易系统 第九章 期货品种选择指标CSI 第十章 资金管理 基本概念 这里用到的一些">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/基本概念-LOP-HIP.png">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/基本概念-SIP.png">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/波动交易系统-ATR.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/动向指标-DM.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/动向指标-DI.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/动向指标-DI14.png">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/动向指标-DI14-next.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/期货品种选择指标CSI-CSI公式.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/动量概念-趋势平衡点交易系统-动量因子.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/相对强弱指数-RSI.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/相对强弱指数-RSI顶部.jpg">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/相对强弱指数-RSI底部.png">
<meta property="og:image" content="http://yoursite.com/images/技术交易系统新概念笔记/摆动指数-短线交易系统-SI.jpg">
<meta property="article:published_time" content="2022-11-28T01:13:00.000Z">
<meta property="article:modified_time" content="2023-06-08T01:20:17.000Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="trade finance">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://yoursite.com/images/技术交易系统新概念笔记/基本概念-LOP-HIP.png">
  
  <title>技术交易系统新概念笔记 - Food-Billboard</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<!-- hexo injector head_end start -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/toubudaziji.css"></link>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css"></link>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/project">
                <i class="iconfont icon-books"></i>
                项目
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/images/%E6%8A%80%E6%9C%AF%E4%BA%A4%E6%98%93%E7%B3%BB%E7%BB%9F%E6%96%B0%E6%A6%82%E5%BF%B5%E7%AC%94%E8%AE%B0/background.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="技术交易系统新概念笔记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-11-28 09:13" pubdate>
        2022年11月28日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      25k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      79 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">技术交易系统新概念笔记</h1>
            
            <div class="markdown-body">
              <h1>技术交易系统新概念笔记</h1>
<h2 id="介绍">介绍</h2>
<p>本文是本人在阅读了《技术交易系统新概念》所作的笔记。</p>
<h2 id="开始">开始</h2>
<h3 id="目录">目录</h3>
<p>记录一下目录：</p>
<blockquote></blockquote>
<p>第一章 基本概念<br>
第二章 抛物式时间/价格交易系统<br>
第三章 波动交易系统<br>
第四章 动向指标<br>
第五章 动量概念-趋势平衡点交易系统<br>
第六章 相对强弱指数<br>
第七章 趋势-回调交易系统<br>
第八章 摆动指标-短线交易系统<br>
第九章 期货品种选择指标CSI<br>
第十章 资金管理</p>
<h3 id="基本概念">基本概念</h3>
<p>这里用到的一些概念会贯穿所有章节使用，需要提前记好。</p>
<h4 id="LOP-HIP">LOP | HIP</h4>
<ul>
<li>LOP<br>
其相邻的两根K线的最低价都高于其最低价</li>
<li>HIP<br>
其相邻的两根K线的最高价均低于其最高价</li>
</ul>
<img src="/images/技术交易系统新概念笔记/基本概念-LOP-HIP.png" srcset="/img/loading.gif" lazyload />
<h4 id="SIP-HI-SIP-LO-SIP">SIP(HI SIP | LO SIP)</h4>
<p>简单来说应该就是最高和最低价格的意思吧。</p>
<img src="/images/技术交易系统新概念笔记/基本概念-SIP.png" srcset="/img/loading.gif" lazyload />
<h4 id="SIC">SIC</h4>
<p>表示交易中最有利的<strong>收盘价</strong>。<br>
多头表示最高价。<br>
空头表示最低价。</p>
<h4 id="SAR">SAR</h4>
<p>停止反转点，表示停止现有头寸，反方向操作。</p>
<h4 id="TR">TR</h4>
<p>真实价格范围<br>
去下列值中的最大值</p>
<ol>
<li>最高价与最低价的差</li>
<li>最高价与昨日收盘价的差</li>
<li>最低价与昨日收盘价的差</li>
</ol>
<h4 id="MOCK模板">MOCK模板</h4>
<p>这里简单记录一下<code>javascript</code>实现的一个代码任务运行模板（其实就是怕自己忘记😁 ）</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">const</span> DATA_SOURCE = []<br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-comment">// mock </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span><br>  &#125;]<br>&#125;<br><br><span class="hljs-comment">// 获取真实价格范围</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTR</span>(<span class="hljs-params">currentData, yestodayData</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> abs = <span class="hljs-built_in">Math</span>.abs<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(abs(currentData.high - currentData.low), abs(currentData.high - yestodayData.close), abs(currentData.low - yestodayData.close))<br>&#125;<br><br><span class="hljs-comment">// 定时任务执行</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="抛物式时间-价格交易系统">抛物式时间/价格交易系统</h3>
<p>个人认为：<br>
非常偏向数学方法的趋势跟踪系统。<br>
只要记住他的计算功能，就非常容易完成整个系统。<br>
马上就可以尝试使用代码完成系统。</p>
<p>记住几个关键的参数：</p>
<ul>
<li>AF<br>
加速因子[0.02-0.2]<br>
当日创下价格新高则<code>AF+0.02</code>(多头为新高，空头为新低)</li>
<li>SAR<br>
停止反转点</li>
<li>SIP<br>
价格极值</li>
<li>EP<br>
此次交易开始的最极值（多头为最高，空头为最低）。</li>
</ul>
<p><code>明日SAR = 今日SAR + AF(今日最高价 - 今日SAR)</code></p>
<h4 id="规则">规则</h4>
<ul>
<li>入市时机<br>
价格突破<code>SAR</code></li>
<li>建仓第一天<br>
SAR = 前一次交易SIP</li>
<li>第一天之后<br>
多头：<code>明日SAR = 今日SAR + AF(最高价 - 今日SAR)</code><br>
空头：<code>明日SAR = 今日SAR - AF(最低价 - 今日SAR)</code></li>
<li>SAR不允许出现在前一日或今日价格区域<br>
多头：明日SAR不能大于昨日或今日最低价，大于则<code>明日SAR = min(今日最低价，明日最低价)</code><br>
空头：明日SAR不能小于昨日或今日最高价，小于则<code>明日SAR = max(今日最高价，明日最高价)</code></li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">let</span> DATASOURCE: &#123;<br>  <span class="hljs-attr">state</span>: <span class="hljs-number">1</span> | -<span class="hljs-number">1</span> <span class="hljs-comment">// 1 多头 -1 空头</span><br>  <span class="hljs-attr">dailyData</span>: &#123; <span class="hljs-comment">// 每日的交易数据</span><br>    <span class="hljs-attr">date</span>: <span class="hljs-built_in">string</span> <span class="hljs-comment">// 日期</span><br>    <span class="hljs-attr">open</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 开盘价</span><br>    <span class="hljs-attr">high</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 最高价</span><br>    <span class="hljs-attr">low</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 最低价</span><br>    <span class="hljs-attr">close</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 收盘价</span><br>    <span class="hljs-attr">SAR</span>: <span class="hljs-built_in">number</span> <br>    <span class="hljs-attr">EP</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 此次交易的极值</span><br>    <span class="hljs-attr">EP_SAR</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// EP+-SAR 当前最高价和今日SAR 的差值</span><br>    <span class="hljs-attr">AF</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 加速因子</span><br>    <span class="hljs-attr">AF_DIFF</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// EP_SAR * AF  </span><br>  &#125;[]<br>&#125; = []<br><br><span class="hljs-comment">// 模拟交易</span><br><span class="hljs-comment">// 用于下面的首次入市前的准备工作</span><br><span class="hljs-keyword">let</span> MOCK_DATASOURCE = []<br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span><br>  &#125;]<br>&#125;<br><br><span class="hljs-comment">// 之前从未做过交易</span><br><span class="hljs-comment">// 需要先找出前几周前的 最高|最低 点  </span><br><span class="hljs-comment">// 基于是上升还是下跌趋势  </span><br><span class="hljs-comment">// 当前设置为3周前  </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBeforeWeekPeak</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-comment">// 获取3周的时间间隔</span><br>  <span class="hljs-keyword">let</span> startDate<br>  <span class="hljs-keyword">let</span> endDate <br><br>  <span class="hljs-comment">// 第一天启用程序</span><br>  <span class="hljs-keyword">if</span>(!MOCK_DATASOURCE.length) &#123;<br>    <span class="hljs-keyword">const</span> historyData = getHistoryData()<br>    <span class="hljs-comment">// TODO </span><br>    <span class="hljs-comment">// 判断前几周的趋势</span><br>    <br>    <span class="hljs-keyword">let</span> peakData <br>    <span class="hljs-keyword">let</span> peakIndex <br>    <span class="hljs-comment">// 如果是上升</span><br>    <span class="hljs-keyword">if</span>(<span class="hljs-literal">true</span>) &#123;<br>      <span class="hljs-comment">// 找出前三周的最高点</span><br>      historyData.forEach(<span class="hljs-function">(<span class="hljs-params">history, index</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span>(!peakData || history.high &gt; peakData.high) &#123;<br>          peakData = history <br>          peakIndex = index <br>        &#125;<br>      &#125;)<br>      <span class="hljs-comment">// 找出最高点后4天的最低点</span><br>      <span class="hljs-comment">// 作为入市点</span><br>      <span class="hljs-keyword">const</span> enterDate = historyData.slice(peakIndex, peakIndex + <span class="hljs-number">4</span>)<br>      <span class="hljs-keyword">const</span> SAR = peakData.high<br>      <span class="hljs-keyword">const</span> EP = enterDate.low<br>      <span class="hljs-keyword">const</span> EP_SAR = <span class="hljs-built_in">Math</span>.abs(SAR - EP)<br>      MOCK_DATASOURCE.push(&#123;<br>        <span class="hljs-attr">state</span>: -<span class="hljs-number">1</span>,<br>        <span class="hljs-attr">dailyData</span>: [<br>          date: enterDate.date,<br>          <span class="hljs-attr">open</span>: enterDate.open,<br>          <span class="hljs-attr">high</span>: enterDate.high,<br>          <span class="hljs-attr">low</span>: enterDate.low,<br>          <span class="hljs-attr">close</span>: enterDate.close,<br>          SAR, <br>          EP,<br>          EP_SAR,<br>          <span class="hljs-attr">AF</span>: <span class="hljs-number">0.02</span>,<br>          <span class="hljs-attr">AF_DIFF</span>: EP_SAR * <span class="hljs-number">0.02</span><br>        ]<br>      &#125;)<br>    &#125;<br>    <span class="hljs-comment">// 下跌</span><br>    <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// 找出前三周的最低点</span><br>      historyData.forEach(<span class="hljs-function">(<span class="hljs-params">history, index</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span>(!peakData || history.low &lt; peakData.low) &#123;<br>          peakData = history <br>          peakIndex = index <br>        &#125;<br>      &#125;)<br>      <span class="hljs-comment">// 找出最低点后4天的最高点</span><br>      <span class="hljs-comment">// 作为入市点</span><br>      <span class="hljs-keyword">const</span> enterDate = historyData.slice(peakIndex, peakIndex + <span class="hljs-number">4</span>)<br><br>      <span class="hljs-keyword">const</span> SAR = peakData.low<br>      <span class="hljs-keyword">const</span> EP = enterDate.high<br>      <span class="hljs-keyword">const</span> EP_SAR = <span class="hljs-built_in">Math</span>.abs(SAR - EP)<br>      MOCK_DATASOURCE.push(&#123;<br>        <span class="hljs-attr">state</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">dailyData</span>: [<br>          date: enterDate.date,<br>          <span class="hljs-attr">open</span>: enterDate.open,<br>          <span class="hljs-attr">high</span>: enterDate.high,<br>          <span class="hljs-attr">low</span>: enterDate.low,<br>          <span class="hljs-attr">close</span>: enterDate.close,<br>          SAR, <br>          EP,<br>          EP_SAR,<br>          <span class="hljs-attr">AF</span>: <span class="hljs-number">0.02</span>,<br>          <span class="hljs-attr">AF_DIFF</span>: EP_SAR * <span class="hljs-number">0.02</span><br>        ]<br>      &#125;)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// TODO </span><br>  <span class="hljs-comment">// 持续进行模拟记录数据</span><br>  <span class="hljs-comment">// 但是这里有一点还没有弄清楚</span><br>  <span class="hljs-comment">// 先暂时卡着吧</span><br><br>&#125;<br><br><span class="hljs-comment">// 每日需要执行的函数</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params">options=&#123;</span></span><br><span class="hljs-params"><span class="hljs-function">  mock: <span class="hljs-literal">false</span>,</span></span><br><span class="hljs-params"><span class="hljs-function">  date: <span class="hljs-literal">null</span> </span></span><br><span class="hljs-params"><span class="hljs-function">&#125;</span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> &#123; mock, date &#125; = options <br>  <span class="hljs-keyword">const</span> _DATASOURCE = mock ? MOCK_DATASOURCE : DATASOURCE<br><br>  <span class="hljs-comment">// 初始化今日数据</span><br>  <span class="hljs-keyword">const</span> todayData = getHistoryData(date, date)<br>  <span class="hljs-keyword">const</span> newDailyData = &#123;<br>    ...todayData,<br>  &#125;<br><br>  <span class="hljs-comment">// 之前未做过交易</span><br>  <span class="hljs-comment">// 可以选择以下方法</span><br>  <span class="hljs-comment">// 也可以选择使用后面说到的第四章的方法（动向指数）</span><br>  <span class="hljs-keyword">if</span>(!_DATASOURCE.length) &#123;<br>    <span class="hljs-keyword">return</span> getBeforeWeekPeak()<br>  &#125;<br><br>  <span class="hljs-comment">// 是否今日开启交易</span><br>  <span class="hljs-keyword">const</span> lastTradeNote = _DATASOURCE[_DATASOURCE.length - <span class="hljs-number">2</span>]<br>  <span class="hljs-keyword">const</span> currentTradeNote = _DATASOURCE[_DATASOURCE.length - <span class="hljs-number">1</span>]<br>  <span class="hljs-keyword">const</span> &#123; dailyData, state &#125; = currentTradeNote<br><br>  <span class="hljs-comment">// 第一天</span><br>  <span class="hljs-keyword">if</span>(!dailyData.length) &#123;<br>    <span class="hljs-comment">// 之前存在交易</span><br>    <span class="hljs-keyword">if</span>(!!lastTradeNote &amp;&amp; <span class="hljs-built_in">Array</span>.isArray(lastTradeNote.dailyData) &amp;&amp; lastTradeNote.dailyData.length) &#123;<br>      <span class="hljs-keyword">const</span> &#123; dailyData, state &#125; = lastTradeNote<br>      <span class="hljs-comment">// 多头则获取前一次交易的最低价</span><br>      <span class="hljs-comment">// 空头则获取前一次交易的最高价</span><br>      <span class="hljs-comment">// 这里只需要取前一次交易的最后一天的极值EP即可</span><br>      newDailyData.SAR = dailyData[dailyData.length - <span class="hljs-number">1</span>].EP<br>      newDailyData.EP = state === <span class="hljs-number">1</span> ? newDailyData.high : newDailyData.low<br>    &#125;<br>  &#125;<br>  <span class="hljs-comment">// 非第一天</span><br>  <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// 前一天的数据</span><br>    <span class="hljs-keyword">const</span> yestodayData = dailyData[dailyData.length - <span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">const</span> beforeYestodayData = dailyData[dailyData.length - <span class="hljs-number">2</span>] || &#123;<br>      <span class="hljs-attr">low</span>: <span class="hljs-number">999999</span>,<br>      <span class="hljs-attr">high</span>: -<span class="hljs-number">1</span><br>    &#125;<br>    <br>    <span class="hljs-keyword">if</span>(state === <span class="hljs-number">1</span>) &#123;<br>      newDailyData.SAR = yestodayData.SAR + yestodayData.AF_DIFF<br>      <span class="hljs-comment">// 多头 SAR 不得大于前一日或今日最低价，大于则选择当日或昨日最低价</span><br>      <span class="hljs-keyword">const</span> lessThenPrize = <span class="hljs-built_in">Math</span>.min(yestodayData.low, beforeYestodayData.low)<br>      newDailyData.SAR = newDailyData.SAR === <span class="hljs-built_in">Math</span>.min(lessThenPrize, newDailyData.SAR) ? newDailyData.SAR : lessThenPrize<br><br>      newDailyData.EP = <span class="hljs-built_in">Math</span>.max(yestodayData.EP, newDailyData.high)<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>      newDailyData.SAR = yestodayData.SAR - yestodayData.AF_DIFF<br>      <span class="hljs-comment">// 空头 SAR 不得小于前一日或今日最高价，小于则选择党日或昨日最高价</span><br>      <span class="hljs-keyword">const</span> greatThenPrize = <span class="hljs-built_in">Math</span>.max(yestodayData.high, beforeYestodayData.high)<br>      newDailyData.SAR = newDailyData.SAR === <span class="hljs-built_in">Math</span>.max(lessThenPrize, newDailyData.SAR) ? newDailyData.SAR : lessThenPrize<br><br>      newDailyData.EP = <span class="hljs-built_in">Math</span>.min(yestodayData.EP, newDailyData.low)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// 获取 EP 和 SAR 的差值</span><br>  newDailyData.EP_SAR = <span class="hljs-built_in">Math</span>.abs(newDailyData.SAR - newDailyData.EP)<br>  newDailyData.AF = newDailyData.AF || <span class="hljs-number">0.02</span> <br>  <span class="hljs-comment">// 创新高或新低则增加AF值</span><br>  <span class="hljs-keyword">if</span>(state === <span class="hljs-number">1</span>) &#123;<br>    newDailyData.AF += newDailyData.high &gt; newDailyData.EP ? <span class="hljs-number">0.02</span> : <span class="hljs-number">0</span><br>  &#125;<span class="hljs-keyword">else</span> &#123;<br>    newDailyData.AF += newDailyData.low &lt; newDailyData.EP ? <span class="hljs-number">0.02</span> : <span class="hljs-number">0</span><br>  &#125;<br>  newDailyData.AF = <span class="hljs-built_in">Math</span>.min(<span class="hljs-number">0.2</span>, newDailyData.AF)<br>  newDailyData.AF_DIFF = newDailyData.AF * newDailyData.EP_SAR<br><br>  <span class="hljs-comment">// 多头发生价格突破</span><br>  <span class="hljs-keyword">const</span> isMultiBreak = state === <span class="hljs-number">1</span> &amp;&amp; newDailyData.low &lt; newDailyData.SAR<br>  <span class="hljs-comment">// 空头发生价格突破</span><br>  <span class="hljs-keyword">const</span> isEmptyBreak = state === -<span class="hljs-number">1</span> &amp;&amp; newDailyData.high &gt; newDailyData.SAR<br><br>  <span class="hljs-keyword">if</span>(isMultiBreak || isEmptyBreak) &#123;<br>    newDailyData.AF = <span class="hljs-number">0.02</span> <br>    newDailyData.SAR = newDailyData.EP <br>    newDailyData.EP = state === <span class="hljs-number">1</span> ? newDailyData.low : newDailyData.high <br>    newDailyData.EP_SAR = <span class="hljs-built_in">Math</span>.abs(newDailyData.SAR - newDailyData.EP)<br>    newDailyData.AF_DIFF = newDailyData.EP_SAR * newDailyData.AF<br><br>    <span class="hljs-built_in">console</span>.log((state === <span class="hljs-number">1</span> ? <span class="hljs-string">&#x27;多头&#x27;</span> : <span class="hljs-string">&#x27;空头&#x27;</span>) + <span class="hljs-string">&#x27;价格发生突破&#x27;</span>)<br><br>    _DATASOURCE.push(&#123;<br>      <span class="hljs-attr">state</span>: -<span class="hljs-number">1</span>,<br>      <span class="hljs-attr">dailyData</span>: [<br>        &#123;<br>          ...newDailyData,<br>        &#125;<br>      ]<br>    &#125;)<br>  &#125;<br>  <span class="hljs-comment">// 记录今日数据</span><br>  <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;今日价格数据:&#x27;</span> + <span class="hljs-built_in">JSON</span>.stringify(newDailyData))<br>    _DATASOURCE[_DATASOURCE.length - <span class="hljs-number">1</span>].dailyData.push(newDailyData)<br>  &#125;<br><br>&#125;<br><br><span class="hljs-comment">// 数据清空</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearData</span>(<span class="hljs-params"></span>) </span>&#123;<br>  DATASOURCE = &#123;<br>    <span class="hljs-attr">state</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">dailyData</span>: []<br>  &#125;<br>  MOCK_DATASOURCE = &#123;<br>    <span class="hljs-attr">state</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">dailyData</span>: []<br>  &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>
<h3 id="波动交易系统">波动交易系统</h3>
<p>也是一个趋势跟踪的系统。<br>
根据市场的波动性来作出相应的操作。</p>
<ul>
<li><code>ATR</code>计算<br>
<img src="/images/技术交易系统新概念笔记/波动交易系统-ATR.jpg" srcset="/img/loading.gif" lazyload /></li>
</ul>
<p><code>ATR_t</code>是当日平均真实价格范围，<code>ATR_p</code>是前一日的平均真实价格范围。<br>
<code>TR</code>是当日真实价格范围。</p>
<p>上述计算是根据七个交易日为标的做的计算。<br>
<code>ATR_p</code>即将加上今日以及前6个交易日的真实价格范围相加，并除7得出的，之后每一日的计算只要简单得将<strong>前一日的平均真实价格范围</strong>带入上述公式即可。</p>
<ul>
<li>
<p>ARC<br>
<code>ARC = ATR * C</code><br>
C是一个[2.8, 3.1]之间的常数（一般为3）。</p>
</li>
<li>
<p>系统交易规则</p>
<p>计算出七天的<code>ARC</code>，找出七天最高收盘价<code>SIC</code>，<code>SAR = SIC - ARC</code><br>
若第二日的收盘价低于<code>SAR</code>，平仓建立空头。</p>
</li>
</ul>
<h4 id="真实价格范围">真实价格范围</h4>
<p>取以下三种的最大值。</p>
<ol>
<li>当日最高价到当日最低价的范围。</li>
<li>昨日收盘价到当日最高价的范围。</li>
<li>昨日收盘价到当日最低价的范围。</li>
</ol>
<h4 id="代码实现">代码实现</h4>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><br><span class="hljs-comment">// 常数C </span><br><span class="hljs-keyword">const</span> C = <span class="hljs-number">3</span> <span class="hljs-comment">// [2.8, 3]</span><br><br><span class="hljs-keyword">const</span> DATA_SOURCE: &#123;<br>  <span class="hljs-attr">state</span>: <span class="hljs-number">1</span> | -<span class="hljs-number">1</span> <span class="hljs-comment">// 当前是空头(-1)还是多头(1)</span><br>  <span class="hljs-attr">TR</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 当日的真实价格范围</span><br>  <span class="hljs-attr">ATR</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 当日的平均真实价格范围</span><br>  <span class="hljs-attr">ARC</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// ATR * C</span><br>  <span class="hljs-attr">SAR</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 停止反转点  </span><br>  <span class="hljs-attr">SIC</span>: <span class="hljs-built_in">number</span> <span class="hljs-comment">// 最低收盘价</span><br>  <span class="hljs-attr">high</span>: <span class="hljs-built_in">number</span> <br>  <span class="hljs-attr">close</span>: <span class="hljs-built_in">number</span> <br>  <span class="hljs-attr">low</span>: <span class="hljs-built_in">number</span> <br>  <span class="hljs-attr">open</span>: <span class="hljs-built_in">number</span> <br>  <span class="hljs-attr">date</span>: <span class="hljs-built_in">string</span> <br>&#125; = []<br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span><br>  &#125;]<br>&#125;<br><br><span class="hljs-comment">// 获取真实价格范围</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTR</span>(<span class="hljs-params">currentData, yestodayData</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> abs = <span class="hljs-built_in">Math</span>.abs<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(abs(currentData.high - currentData.low), abs(currentData.high - yestodayData.close), abs(currentData.low - yestodayData.close))<br>&#125;<br><br><span class="hljs-comment">// 每日定时执行方法</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> currentDateData = getHistoryData()<br><br>  <span class="hljs-comment">// 之前未做过任何交易</span><br>  <span class="hljs-keyword">if</span>(DATA_SOURCE.length &lt; <span class="hljs-number">7</span>) &#123;<br>    <span class="hljs-comment">// 简单从空头位置开始准备进入市场</span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length &lt; <span class="hljs-number">6</span>) &#123;<br>      DATA_SOURCE.push(&#123;<br>        ...currentDateData,<br>        <span class="hljs-attr">TR</span>: getTR()<br>      &#125;)<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">const</span> TR = getTR()<br>      <span class="hljs-keyword">const</span> ATR = DATA_SOURCE.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.TR).reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> acc + cur, <span class="hljs-number">0</span>) / <span class="hljs-number">7</span><br>      DATA_SOURCE.push(&#123;<br>        ...currentDateData,<br>        TR,<br>        ATR,<br>        <span class="hljs-attr">ARC</span>: ATR * C<br>      &#125;)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> [lastDayData] = DATA_SOURCE.slice(-<span class="hljs-number">1</span>)<br><br>  <span class="hljs-keyword">const</span> todayTR = getTR(currentDateData, lastDayData)<br>  <span class="hljs-keyword">const</span> todayATR = (<span class="hljs-number">6</span> * lastDayData.ATR + todayTR) / <span class="hljs-number">7</span><br>  <span class="hljs-keyword">const</span> ARC = todayATR * C<br>  <span class="hljs-keyword">let</span> SIC <br>  <span class="hljs-keyword">let</span> SAR <br>  <span class="hljs-keyword">let</span> state <br>  <span class="hljs-comment">// 空头</span><br>  <span class="hljs-keyword">if</span>(lastDayData.state == -<span class="hljs-number">1</span>) &#123;<br>    SIC = <span class="hljs-built_in">Math</span>.min(lastDayData.SIC, currentDateData.close)<br>    SAR = lastDayData.SIC + lastDayData.ARC<br>    <span class="hljs-comment">// 收盘价上穿SAR 变为多头</span><br>    state = currentDateData.close &gt; SAR ? <span class="hljs-number">1</span> : -<span class="hljs-number">1</span><br>    <span class="hljs-comment">// 变为多头更改SIC为当日收盘价</span><br>    <span class="hljs-keyword">if</span>(state === <span class="hljs-number">1</span>) &#123;<br>      SIC = currentDateData.close<br>    &#125;<br>  &#125;<br>  <span class="hljs-comment">// 多头</span><br>  <span class="hljs-keyword">else</span> &#123;<br>    SIC = <span class="hljs-built_in">Math</span>.max(lastDayData.SIC, currentDateData.close)<br>    SAR = lastDayData.SIC - lastDayData.ARC<br>    <span class="hljs-comment">// 收盘价下穿SAR 变为空头</span><br>    state = currentDateData.close &lt; SAR ? -<span class="hljs-number">1</span> : <span class="hljs-number">1</span><br>    <span class="hljs-comment">// 变为空头更改SIC为当日收盘价</span><br>    <span class="hljs-keyword">if</span>(state === <span class="hljs-number">1</span>) &#123;<br>      SIC = currentDateData.close<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">const</span> newData = &#123;<br>    ...currentDateData,<br>    <span class="hljs-attr">TR</span>: todayTR,<br>    <span class="hljs-attr">ATR</span>: todayATR,<br>    ARC,<br>    SIC,<br>    SAR,<br>    state<br>  &#125;<br><br>  <span class="hljs-comment">// 上面state改变则触发交易操作</span><br>  DATA_SOURCE.push(newData)<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<h3 id="动向指标">动向指标</h3>
<p>根据一个<code>0-100</code>的指标来跟踪产品趋势。</p>
<h4 id="几个指标概念">几个指标概念</h4>
<h5 id="DM和-DM">+DM和-DM</h5>
<p>今日的价格范围与昨日价格返回的差值<br>
比如：昨天的价格范围是<code>[100 200]</code>，今日的价格范围是<code>[150, 300]</code>，则使用<code>+DM</code>表示为<code>300 - 200 = 100</code><br>
<img src="/images/技术交易系统新概念笔记/动向指标-DM.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>当今日与昨日是<strong>包含</strong>关系时，DM为<code>0</code>。<br>
<code>+DM</code>和<code>-DM</code>始终是<strong>正数</strong>。</p>
<blockquote>
<p>计算规则<br>
党日价格范围超出昨日价格范围中的较大部分。</p>
</blockquote>
<h5 id="DI和-DI">+DI和-DI</h5>
<p>方向指数，相对于真实价格范围，变动的百分比。<br>
<img src="/images/技术交易系统新概念笔记/动向指标-DI.jpg" srcset="/img/loading.gif" lazyload /></p>
<p>价格<strong>上涨</strong>用<code>+DI</code>，<strong>下跌</strong>用<code>-DI</code>。</p>
<img src="/images/技术交易系统新概念笔记/动向指标-DI14.png" srcset="/img/loading.gif" lazyload />  
<blockquote>
<p>求出<code>14</code>天的平均值来作为指标，<br>
计算出14天的值以后便可以用简便方法进行计算。</p>
</blockquote>
<img src="/images/技术交易系统新概念笔记/动向指标-DI14-next.jpg" srcset="/img/loading.gif" lazyload />  
<h5 id="DX">DX</h5>
<p>动向指标<br>
<code>DX = DIDiff / DISum</code>（参数详见下表）<br>
<code>DX</code>值越大，运动越<strong>强</strong>；<code>DX</code>值月销，运动越<strong>弱</strong>。<br>
无论价格向上或向下运动，不会影响数值，即向上或向下运动幅度大，那么他的值都很<strong>大</strong>。</p>
<h5 id="ADX">ADX</h5>
<p>14天<code>DX</code>的平均值</p>
<h5 id="ADXR">ADXR</h5>
<p>方向运动的坐标系上用于量度期货、货币、股票等等的价格变化的一个指标<br>
<code>ADXR = (当日ADX + 14天前的ADX14) / 2</code></p>
<h5 id="CSI-K">CSI &amp; K</h5>
<ul>
<li>CSI<br>
根据相关关联参数计算而得来的产品选择指标</li>
<li>K<br>
与<code>CIS</code>相关的常量系数</li>
</ul>
<h4 id="数据记录">数据记录</h4>
<table>
<thead>
<tr>
<th>date</th>
<th>open</th>
<th>high</th>
<th>low</th>
<th>close</th>
<th>TR</th>
<th>DMHigh</th>
<th>DMLow</th>
<th>TR14</th>
<th>DI14High</th>
<th>DI14Low</th>
<th>DIDiff</th>
<th>DISum</th>
<th>DX</th>
<th>ADX</th>
</tr>
</thead>
<tbody>
<tr>
<td>日期</td>
<td>开盘价</td>
<td>最高价</td>
<td>最低价</td>
<td>收盘价</td>
<td>真实价格范围</td>
<td>+DM</td>
<td>-DM</td>
<td>TR14</td>
<td>+DI14</td>
<td>-DI14</td>
<td>+DI14 - (-DI14)</td>
<td>+DI14 + (-DI14)</td>
<td>DIDiff / DISum</td>
<td>14天DX的平均值</td>
</tr>
</tbody>
</table>
<h4 id="js实现">js实现</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment">  &#123;</span><br><span class="hljs-comment">    // 日期</span><br><span class="hljs-comment">    date: &#x27;2022-02-25&#x27;,</span><br><span class="hljs-comment">    // 开盘价</span><br><span class="hljs-comment">    open: 100,</span><br><span class="hljs-comment">    // 最高价</span><br><span class="hljs-comment">    high: 100,</span><br><span class="hljs-comment">    // 最低价</span><br><span class="hljs-comment">    low: 100,</span><br><span class="hljs-comment">    // 收盘价</span><br><span class="hljs-comment">    close: 100,</span><br><span class="hljs-comment">    // TR  </span><br><span class="hljs-comment">    TR: 10,</span><br><span class="hljs-comment">    // +DM </span><br><span class="hljs-comment">    DMHigh: 10, </span><br><span class="hljs-comment">    // -DM  </span><br><span class="hljs-comment">    DMLow: 0,</span><br><span class="hljs-comment">    // TR14  </span><br><span class="hljs-comment">    TR14: 14,</span><br><span class="hljs-comment">    // DMHigh14</span><br><span class="hljs-comment">    DMHigh14: 10,</span><br><span class="hljs-comment">    // DMLow14</span><br><span class="hljs-comment">    DMLow14: 10,</span><br><span class="hljs-comment">    // +DI14 </span><br><span class="hljs-comment">    DI14High: 10,</span><br><span class="hljs-comment">    // -DI14</span><br><span class="hljs-comment">    DI14Low: 10,</span><br><span class="hljs-comment">    // +DI14和-DI14的差值  </span><br><span class="hljs-comment">    DIDiff: 10,</span><br><span class="hljs-comment">    // +DI14和-DI14的和</span><br><span class="hljs-comment">    DISum: 10,</span><br><span class="hljs-comment">    // 上面两个值的比值 动向指标</span><br><span class="hljs-comment">    DX: 10,</span><br><span class="hljs-comment">    // 14日DX的平均值</span><br><span class="hljs-comment">    ADX: 30,</span><br><span class="hljs-comment">    // 平均动向指标比率</span><br><span class="hljs-comment">    ADXR: 30,</span><br><span class="hljs-comment">    // 平均14天真实价格范围</span><br><span class="hljs-comment">    ATR14: 20,</span><br><span class="hljs-comment">    // 期货品种选择指标</span><br><span class="hljs-comment">    CSI: 20,</span><br><span class="hljs-comment">    // 手续费</span><br><span class="hljs-comment">    charge: 20 </span><br><span class="hljs-comment">  &#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">const</span> DATA_SOURCE = []<br><span class="hljs-comment">// 当前的交易信息</span><br><span class="hljs-keyword">const</span> TRADE_INFO = &#123;<br>  <span class="hljs-comment">// -1 初始化 0 空头 1 多头</span><br>  <span class="hljs-attr">status</span>: -<span class="hljs-number">1</span>,<br>  <span class="hljs-comment">// DI14和-DI14交叉时的极端价位，用于消除价格波动噪声  </span><br>  <span class="hljs-attr">limit</span>: -<span class="hljs-number">1</span>,<br>&#125;<br><br><span class="hljs-comment">// 时间跨度 14 天</span><br><span class="hljs-keyword">const</span> RANGE_DAY_COUNT = <span class="hljs-number">14</span> <br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-comment">// mock </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span>,<br>    charge,<br>  &#125;]<br>&#125;<br><br><span class="hljs-comment">// 获取DM值 </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDMData</span>(<span class="hljs-params">currentData, yestodayData</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> &#123;  <br>    <span class="hljs-attr">high</span>: currHigh,<br>    <span class="hljs-attr">low</span>: currLow<br>  &#125; = currentData <br>  <span class="hljs-keyword">const</span> &#123;  <br>    high,<br>    low<br>  &#125; = yestodayData <br>  <span class="hljs-keyword">let</span> DMHigh = <span class="hljs-number">0</span> <br>  <span class="hljs-keyword">let</span> DMLow = <span class="hljs-number">0</span> <br><br>  <span class="hljs-keyword">const</span> condition1 = currHigh - high <br><br>  <span class="hljs-keyword">const</span> condition2 = low - currLow <br><br>  <span class="hljs-comment">// 如果是包含关系就都为0 </span><br>  <span class="hljs-keyword">if</span>(condition1 &gt; <span class="hljs-number">0</span> || condition2 &gt; <span class="hljs-number">0</span>) &#123;<br>    <span class="hljs-comment">// 向上运动更多</span><br>    <span class="hljs-keyword">if</span>(condition1 &gt; condition2) &#123;<br>      DMHigh = condition1<br>    &#125;<br>    <span class="hljs-comment">// 向下运动更多</span><br>    <span class="hljs-keyword">else</span> &#123;<br>      DMLow = condition2<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> &#123;<br>    DMHigh,<br>    DMLow<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// 获取真实价格范围</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTR</span>(<span class="hljs-params">currentData, yestodayData</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> abs = <span class="hljs-built_in">Math</span>.abs<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(abs(currentData.high - currentData.low), abs(currentData.high - yestodayData.close), abs(currentData.low - yestodayData.close))<br>&#125;<br><br><span class="hljs-comment">// 定时任务执行</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> currentData = getHistoryData() <br>  <span class="hljs-keyword">const</span> &#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    date,<br>    charge<br>  &#125; = currentData <br>  <span class="hljs-keyword">const</span> newData = &#123;<br>    date,<br>    high,<br>    open,<br>    close,<br>    low,<br>    charge<br>  &#125; <br><br>  <span class="hljs-comment">// 不是第一天，如果是第一天只需要简单记录数据就可以了</span><br>  <span class="hljs-keyword">if</span>(!DATA_SOURCE.length) &#123;<br>    <span class="hljs-keyword">const</span> yestoday = DATA_SOURCE[DATA_SOURCE.length - <span class="hljs-number">1</span>]<br><br>    <span class="hljs-comment">// DM</span><br>    <span class="hljs-keyword">const</span> &#123; DMHigh, DMLow &#125; = getDMData(newData, yestoday)<br>    newData.DMHigh = DMHigh<br>    newData.DMLow = DMLow<br><br>    <span class="hljs-comment">// TR  </span><br>    <span class="hljs-keyword">const</span> tr = getTR(newData, yestoday)<br>    newData.TR = tr <br><br>    <span class="hljs-comment">// 大于最短时间周期（14天），满足所有数据的计算条件</span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= (RANGE_DAY_COUNT - <span class="hljs-number">1</span>)) &#123;<br>      <br>      <span class="hljs-comment">// 如果是刚好满足条件，需要做累计计算</span><br>      <span class="hljs-keyword">if</span>(DATA_SOURCE.length == (RANGE_DAY_COUNT - <span class="hljs-number">1</span>)) &#123;<br>        <span class="hljs-keyword">const</span> previousData = DATA_SOURCE.slice(DATA_SOURCE.length - RANGE_DAY_COUNT - <span class="hljs-number">1</span>)<br><br>        <span class="hljs-comment">// tr14 </span><br>        newData.TR14 = tr + previousData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>          acc += cur.TR<br>          <span class="hljs-keyword">return</span> acc <br>        &#125;, <span class="hljs-number">0</span>)<br><br>        <span class="hljs-comment">// dmhigh14 </span><br>        newData.DMHigh14 = DMHigh + previousData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>          acc += (cur.DMHigh || <span class="hljs-number">0</span>)<br>          <span class="hljs-keyword">return</span> acc <br>        &#125;, <span class="hljs-number">0</span>)<br>        <span class="hljs-comment">// dmlow14</span><br>        newData.DMLow14 = DMLow + previousData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>          acc += (cur.DMLow || <span class="hljs-number">0</span>)<br>          <span class="hljs-keyword">return</span> acc <br>        &#125;, <span class="hljs-number">0</span>)<br><br>      &#125;<br>      <span class="hljs-comment">// 超过条件只要简单使用昨日数据进行计算即可</span><br>      <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">const</span> &#123; TR14, DMHigh14, DMLow14 &#125; = yestoday<br><br>        <span class="hljs-comment">// tr14</span><br>        newData.TR14 = TR14 - TR14 / RANGE_DAY_COUNT + tr <br>        <span class="hljs-comment">// dmhigh14 </span><br>        newData.DMHigh14 = DMHigh14 - DMHigh14 / RANGE_DAY_COUNT + DMHigh <br>        <span class="hljs-comment">// dmlow14 </span><br>        newData.DMLow14 = DMLow14 - DMLow14 / RANGE_DAY_COUNT + DMLow <br><br>      &#125;<br><br>      <span class="hljs-comment">// ATR14</span><br>      newData.ATR14 = newData.TR14 / <span class="hljs-number">14</span> <br>      <span class="hljs-comment">// +DI14</span><br>      newData.DI14High = newData.DMHigh14 / newData.TR14 * <span class="hljs-number">100</span> <br>      <span class="hljs-comment">// -DI14</span><br>      newData.DI14Low = newData.DMLow14 / newData.TR14 * <span class="hljs-number">100</span><br>      <span class="hljs-comment">// DIDiff </span><br>      newData.DIDiff = <span class="hljs-built_in">Math</span>.abs(newData.DI14High - newData.DI14Low)<br>      <span class="hljs-comment">// DISum</span><br>      newData.DISum = newData.DI14High + newData.DI14Low<br>      <span class="hljs-comment">// DX  </span><br>      newData.DX = newData.DIDiff / newData.DISum * <span class="hljs-number">100</span><br><br>      <span class="hljs-comment">// 超过28天可以开始计算ADX</span><br>      <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= (RANGE_DAY_COUNT * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>)) &#123;<br>        <span class="hljs-comment">// 如果是刚好满足条件，需要做累计计算</span><br>        <span class="hljs-keyword">if</span>(DATA_SOURCE.length == (RANGE_DAY_COUNT * <span class="hljs-number">2</span> - <span class="hljs-number">1</span>)) &#123;<br>          <span class="hljs-keyword">const</span> previousData = DATA_SOURCE.slice(DATA_SOURCE.length - RANGE_DAY_COUNT - <span class="hljs-number">1</span>)<br><br>          <span class="hljs-comment">// adx </span><br>          newData.ADX = (newData.DX + previousData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>            acc += cur.DX<br>            <span class="hljs-keyword">return</span> acc <br>          &#125;, <span class="hljs-number">0</span>)) / RANGE_DAY_COUNT<br><br>        &#125;<br>        <span class="hljs-comment">// 超过条件只要简单使用昨日数据进行计算即可</span><br>        <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-keyword">const</span> &#123; ADX &#125; = yestoday<br><br>          <span class="hljs-comment">// adx</span><br>          newData.ADX = (ADX * (RANGE_DAY_COUNT - <span class="hljs-number">1</span>) + newData.DX) / RANGE_DAY_COUNT<br><br>        &#125;<br>      &#125;<br><br>      <span class="hljs-comment">// 超过14 * 3 天开始计算ADXR</span><br>      <span class="hljs-comment">// 因为28天后才能计算ADX</span><br>      <span class="hljs-comment">// ADXR计算需要14天前的ADX</span><br>      <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= RANGE_DAY_COUNT * <span class="hljs-number">3</span>) &#123;<br>        newData.ADXR = (newData.ADX + newData[newData.length - RANGE_DAY_COUNT]) / <span class="hljs-number">2</span><br>        newData.CSI = newData.ADXR * newData.ATR14 * ( <span class="hljs-number">100</span> / <span class="hljs-number">1</span> * (<span class="hljs-number">1</span> / <span class="hljs-number">150</span> + newData.charge) ) * <span class="hljs-number">100</span> <br>      &#125;<br><br>    &#125;<br><br>  &#125;<br><br>  <span class="hljs-comment">// ---具体的交易操作---</span><br>  <span class="hljs-comment">// 计算出ADXR才算能开始真正的交易</span><br>  <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= RANGE_DAY_COUNT * <span class="hljs-number">3</span>) &#123;<br><br>    <span class="hljs-comment">// ADXR超过25表示有利可图</span><br>    <span class="hljs-comment">// CSI越高越好</span><br>    <span class="hljs-comment">// 关于CSI的大小标准还有待考证</span><br>    <span class="hljs-keyword">if</span>(newData.ADXR &gt; <span class="hljs-number">25</span> &amp;&amp; newData.CSI &gt; <span class="hljs-number">400</span>) &#123;<br><br>      <span class="hljs-comment">// DI14 &lt; -DI14 时多头</span><br>      <span class="hljs-comment">// DI14 &gt; -DI14 时空头</span><br>      <span class="hljs-comment">// ADX &lt; (DI14&amp;-DI14) 时空头</span><br>      <span class="hljs-comment">// DI14 == -DI14</span><br><br><br>      <span class="hljs-comment">// 空头 ADX &lt; (DI14&amp;-DI14)</span><br>      <span class="hljs-keyword">if</span>(newData.ADX &lt; newData.DI14High &amp;&amp; newData.ADX &lt; newData.DI14Low) &#123;<br>        <span class="hljs-keyword">if</span>(TRADE_INFO.status === <span class="hljs-number">1</span>) &#123;<br>          TRADE_INFO.status = <span class="hljs-number">0</span><br>          TRADE_INFO.limit = newData.high <br>        &#125;<br>      &#125;<br>      <span class="hljs-comment">// 空头</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(newData.DI14High &gt; newData.DI14Low) &#123;<br>        <span class="hljs-comment">// 初始化或者当日最低价 低于 交叉时的最低价</span><br>        <span class="hljs-comment">// 改动为空头</span><br>        <span class="hljs-keyword">if</span>(TRADE_INFO.status === -<span class="hljs-number">1</span> || newData.low &lt; TRADE_INFO.limit) &#123;<br>          <span class="hljs-comment">// 赋值当前的买卖信息，为下次做准备</span><br>          TRADE_INFO.status = <span class="hljs-number">1</span> <br>          TRADE_INFO.limit = newData.high<br>        &#125;<br>      &#125;<br>      <span class="hljs-comment">// 多头</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(newData.DI14High &lt; newData.DI14Low) &#123;<br>        <span class="hljs-comment">// 初始化或者当日最高价 高于 交叉时的最高价</span><br>        <span class="hljs-comment">// 改动为多头</span><br>        <span class="hljs-keyword">if</span>(TRADE_INFO.status === -<span class="hljs-number">1</span> || newData.high &gt; TRADE_INFO.limit) &#123;<br>          TRADE_INFO.status = <span class="hljs-number">0</span> <br>          TRADE_INFO.limit = newData.low <br>        &#125;<br>      &#125;<br><br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// ---具体的交易操作---</span><br><br>  DATA_SOURCE.push(newData)<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<blockquote>
<p>存在问题</p>
</blockquote>
<ol>
<li>上面<code>ADXR</code>超过25才是有利可图，但是如果在产品的<code>ADXR</code>超过25时买入，但是之后降低到了25以下，此时，入市的资金该如何处理。</li>
<li>大趋势下，如持续上涨，是否需要对持续<strong>DI交叉</strong>做更多的资金买入。</li>
<li>具体的交易操作还可以根据<strong>ADX</strong>来进行更细致的判断，更多细节有待接着研究（55页）。</li>
<li>上述代码需要一个特殊的指标<code>CSI</code>，可能在第九章有讲到，待阅读😁 （经过阅读，九章中对于<code>CSI</code>的定义是越高越好，但是做的是一个相对比较，并没有明确说明高于某一个值表示有利可图，待考证）。</li>
</ol>
<h3 id="期货品种选择指标CSI">期货品种选择指标CSI</h3>
<p>为什么先写这一章，因为他跟前面第四章有关（但是也没有那么有关）。</p>
<blockquote>
<p>ps<br>
因为本人并没有想去做期货等相关的交易，所以可能对于本章，作用不大，简单带过。</p>
</blockquote>
<h4 id="公式">公式</h4>
  <img src="/images/技术交易系统新概念笔记/期货品种选择指标CSI-CSI公式.jpg" srcset="/img/loading.gif" lazyload />  
<ol>
<li>ADXR<br>
第四章中提到的动向指标。</li>
<li>ATR14<br>
14天的平均真实价格范围。<br>
根据前面基本概念中提到的<code>TR</code>计算而来。</li>
<li>V<br>
每运动1分（货币单位）、实际代表的价值（即以货币单位计量的ATR14的基本增幅）<br>
笔者理解的意思应该就是市场每运动一个货币单位时，每份合约所发生的价格变动（那在股票中是不是就是<strong>一手</strong>的意思）。</li>
<li>M<br>
保证金数量</li>
<li>C<br>
手续费</li>
</ol>
<h4 id="总结">总结</h4>
<pre><code>根据上面的公式以及书中的介绍，`CSI`越高，说明交易越有利，并且可能风险也更小。  
（本人因为可能交易的是股票，所以上面的保证金并不存在）。  
</code></pre>
<h3 id="动量概念-趋势平衡点交易系统">动量概念-趋势平衡点交易系统</h3>
<h4 id="几个概念">几个概念</h4>
<h5 id="MF">MF</h5>
<p>动量因子，描述价格变化的加速度，比如昨天比前天增加了1块，今天比昨天多增加1块的话，动量因子为0，因为加速度没有发生变化。<br>
<img src="/images/技术交易系统新概念笔记/动量概念-趋势平衡点交易系统-动量因子.jpg" srcset="/img/loading.gif" lazyload /></p>
<ul>
<li>计算<br>
当日收盘价 - 前天的收盘价</li>
</ul>
<h5 id="TBP">TBP</h5>
<p>趋势平衡点</p>
<h5 id="AverageX">AverageX</h5>
<p>最高价、最低价、收盘价的平均值</p>
<h5 id="ProtectStop">ProtectStop</h5>
<p>防御停损点<br>
指定当价格达到点时<strong>停止头寸</strong>。</p>
<ul>
<li>空头：<code>ProtectStop = AverageX + TR</code></li>
<li>多头：<code>ProtectStop = AverageX - TR</code></li>
</ul>
<h5 id="TargetPoint">TargetPoint</h5>
<p>目标价位<br>
指定当价格到达指定获利位置时<strong>停止头寸</strong></p>
<ul>
<li>空头：<code>2 * AverageX - H</code></li>
<li>多头：<code>2 * AverageX - L</code><br>
<code>L &amp; H</code>表示最低和最高价</li>
</ul>
<h4 id="交易过程">交易过程</h4>
<ol>
<li>当日MF &gt; 昨日MF &amp;&amp; 当日MF &gt; 前天MF<br>
<strong>多头</strong></li>
<li>当日MF &lt; 昨日MF &amp;&amp; 当日MF &lt; 前天MF<br>
<strong>空头</strong></li>
<li><strong>目标价位</strong>了结，不做<strong>反向</strong>交易</li>
<li><strong>停止点</strong>结束交易，不做<strong>反向</strong>交易</li>
<li>了结后再次进入遵循<code>1、2</code>规则</li>
</ol>
<h4 id="js实现-2">js实现</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/*</span><br><span class="hljs-comment">&#123;</span><br><span class="hljs-comment">  // 日期</span><br><span class="hljs-comment">  date: &#x27;2022-02-25&#x27;,</span><br><span class="hljs-comment">  // 开盘价</span><br><span class="hljs-comment">  open: 100,</span><br><span class="hljs-comment">  // 最高价</span><br><span class="hljs-comment">  high: 100,</span><br><span class="hljs-comment">  // 最低价</span><br><span class="hljs-comment">  low: 100,</span><br><span class="hljs-comment">  // 收盘价</span><br><span class="hljs-comment">  close: 100,</span><br><span class="hljs-comment">  // 动量因子</span><br><span class="hljs-comment">  MF: 20,</span><br><span class="hljs-comment">  // 趋势平衡点</span><br><span class="hljs-comment">  TBP: 20,</span><br><span class="hljs-comment">  // TR </span><br><span class="hljs-comment">  TR: 20,</span><br><span class="hljs-comment">  // 最高 最低 收盘价的平均值</span><br><span class="hljs-comment">  AverageX: 20,</span><br><span class="hljs-comment">  // 防御停损点</span><br><span class="hljs-comment">  ProtectStop: 20,</span><br><span class="hljs-comment">  // 目标价位</span><br><span class="hljs-comment">  TargetPoint: 20 </span><br><span class="hljs-comment">&#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">const</span> DATA_SOURCE = []<br><span class="hljs-comment">// 当前的交易信息</span><br><span class="hljs-keyword">const</span> TRADE_INFO = &#123;<br>  <span class="hljs-comment">// -1 初始化 0 空头 1 多头</span><br>  <span class="hljs-attr">status</span>: -<span class="hljs-number">1</span>,<br>&#125;<br><br><span class="hljs-comment">// 获取真实价格范围</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTR</span>(<span class="hljs-params">currentData, yestodayData</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> abs = <span class="hljs-built_in">Math</span>.abs<br>  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(abs(currentData.high - currentData.low), abs(currentData.high - yestodayData.close), abs(currentData.low - yestodayData.close))<br>&#125;<br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-comment">// mock </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span><br>  &#125;]<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> currentData = getHistoryData() <br>  <span class="hljs-keyword">const</span> &#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    date,<br>    charge<br>  &#125; = currentData <br>  <span class="hljs-keyword">const</span> newData = &#123;<br>    date,<br>    high,<br>    open,<br>    close,<br>    low,<br>    charge,<br>    <span class="hljs-attr">AverageX</span>: (high + low + close) / <span class="hljs-number">3</span><br>  &#125; <br><br>  <span class="hljs-comment">// 超过1天可以计算TR </span><br>  <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">1</span>) &#123;<br>    newData.TR = getTR(newData, DATA_SOURCE[DATA_SOURCE.length - <span class="hljs-number">1</span>])<br>  &#125;<br><br>  <span class="hljs-comment">// 超过2天才能计算动量因子</span><br>  <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-keyword">const</span> [beforeYestoday, yestoday] = DATA_SOURCE.slice(-<span class="hljs-number">2</span>)<br>    newData.MF = newData.close - beforeYestoday.close<br><br><br>    <span class="hljs-comment">// 超过4天才能进行交易判断</span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">4</span>) &#123;<br>      <br>      <span class="hljs-comment">// 退出市场判断</span><br>      <span class="hljs-keyword">if</span>(<br>        <span class="hljs-comment">// 在市且达到防御停损点 就退出市场</span><br>        (TRADE_INFO == <span class="hljs-number">1</span> &amp;&amp; newData.close &lt; yestoday.ProtectStop) <br>        || <br>        (TRADE_INFO == -<span class="hljs-number">1</span> &amp;&amp; newData.close &gt; yestoday.ProtectStop)<br>        ||<br>        <span class="hljs-comment">// 在市且达到目标价位</span><br>        (TRADE_INFO == <span class="hljs-number">1</span> &amp;&amp; newData.close &gt; yestoday.TargetPoint) <br>        || <br>        (TRADE_INFO == -<span class="hljs-number">1</span> &amp;&amp; newData.close &lt; yestoday.TargetPoint)<br>      ) &#123;<br>        <span class="hljs-comment">// 退出市场</span><br>        TRADE_INFO.status = -<span class="hljs-number">1</span> <br>      &#125;<br>      <span class="hljs-comment">// 今日MF 大于 前两天MF 多头</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(newData.MF &gt; beforeYestoday.MF &amp;&amp; newData.MF &gt; yestoday.MF) &#123;<br>        <span class="hljs-keyword">if</span>(TRADE_INFO.status !== <span class="hljs-number">1</span>) &#123;<br>          TRADE_INFO.status = <span class="hljs-number">1</span><br>        &#125;<br>      &#125;<br>      <span class="hljs-comment">// 今日MF 小于 前两天MF 空头</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(newData.MF &lt; beforeYestoday.MF &amp;&amp; newData.MF &lt; yestoday.MF) &#123;<br>        <span class="hljs-keyword">if</span>(TRADE_INFO.status !== <span class="hljs-number">0</span>) &#123;<br>          TRADE_INFO.status = <span class="hljs-number">0</span><br>        &#125;<br>      &#125;<br>      <br>      <span class="hljs-keyword">if</span>(TRADE_INFO.status === <span class="hljs-number">1</span>) &#123;<br>        newData.ProtectStop = newData.AverageX - newData.TR<br>        newData.TargetPoint = <span class="hljs-number">2</span> * newData.AverageX - newData.low<br>      &#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(TRADE_INFO.status === <span class="hljs-number">0</span>) &#123;<br>        newData.ProtectStop = newData.AverageX + newData.TR<br>        newData.TargetPoint = <span class="hljs-number">2</span> * newData.AverageX - newData.high<br>      &#125;<br><br>    &#125;<br>  &#125;<br><br>  DATA_SOURCE.push(newData)<br><br>&#125;<br><br></code></pre></td></tr></table></figure>
<blockquote>
<p>存在问题</p>
</blockquote>
<ol>
<li>关于上面的了结头寸的说法，对于空头和多头来说，不太能理解，空头和退出市场的区别在哪里。</li>
</ol>
<h3 id="相对强弱指数">相对强弱指数</h3>
<p>通过一个相对指标概念来描述所有产品的价格震荡情况。<br>
通过描述该指标可以看到哪个产品的价格变动是有利可图</p>
<h4 id="几个概念-2">几个概念</h4>
<h5 id="RSI">RSI</h5>
<p>相对强弱指数<br>
<img src="/images/技术交易系统新概念笔记/相对强弱指数-RSI.jpg" srcset="/img/loading.gif" lazyload /><br>
70以上或者30以下表示市场的顶部或底部，即将<strong>反转</strong>的信号。</p>
<h4 id="js实现-3">js实现</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  &#123;</span><br><span class="hljs-comment">    // 日期</span><br><span class="hljs-comment">    date: &#x27;2022-02-25&#x27;,</span><br><span class="hljs-comment">    // 开盘价</span><br><span class="hljs-comment">    open: 100,</span><br><span class="hljs-comment">    // 最高价</span><br><span class="hljs-comment">    high: 100,</span><br><span class="hljs-comment">    // 最低价</span><br><span class="hljs-comment">    low: 100,</span><br><span class="hljs-comment">    // 收盘价</span><br><span class="hljs-comment">    close: 100,</span><br><span class="hljs-comment">    // 上涨交易日平均增幅</span><br><span class="hljs-comment">    riseAverage: 20,</span><br><span class="hljs-comment">    // 下跌交易日平均减负</span><br><span class="hljs-comment">    fallAverage: 20,</span><br><span class="hljs-comment">    // 上涨交易日增幅</span><br><span class="hljs-comment">    rise: 20,</span><br><span class="hljs-comment">    // 下跌交易日增幅</span><br><span class="hljs-comment">    fall: 20,</span><br><span class="hljs-comment">    // 上涨交易日增幅 / 下跌交易日减幅</span><br><span class="hljs-comment">    RS: 20,</span><br><span class="hljs-comment">    // 相对强弱指数</span><br><span class="hljs-comment">    RSI: 20,</span><br><span class="hljs-comment">    // 手续费</span><br><span class="hljs-comment">    charge: 20 </span><br><span class="hljs-comment">  &#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">const</span> DATA_SOURCE = []<br><span class="hljs-comment">// 当前的交易信息</span><br><span class="hljs-keyword">const</span> TRADE_INFO = &#123;<br>  <span class="hljs-comment">// -1 初始化 0 空头 1 多头</span><br>  <span class="hljs-attr">status</span>: -<span class="hljs-number">1</span>,<br>&#125;<br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-comment">// mock </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span>,<br>    charge,<br>  &#125;]<br>&#125;<br><br>  <span class="hljs-comment">// 定时任务执行</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> currentData = getHistoryData() <br>  <span class="hljs-keyword">const</span> &#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    date,<br>    charge<br>  &#125; = currentData <br>  <span class="hljs-keyword">const</span> newData = &#123;<br>    date,<br>    high,<br>    open,<br>    close,<br>    low,<br>    charge<br>  &#125; <br><br>  <span class="hljs-keyword">if</span>(!!DATA_SOURCE.length) &#123;<br>    <span class="hljs-keyword">const</span> [ yestodayData ] = DATA_SOURCE.slice(-<span class="hljs-number">1</span>)<br>    <span class="hljs-comment">// 上涨</span><br>    <span class="hljs-keyword">if</span>(newData.close &gt; yestodayData.close) &#123;<br>      newData.rise = newData.close - yestodayData.close<br>    &#125;<br>    <span class="hljs-comment">// 下跌</span><br>    <span class="hljs-keyword">else</span> &#123;<br>      newData.fall = yestodayData.close - newData.close<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">// 超过14天才能计算RS和RSI </span><br>  <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">14</span>) &#123;<br>    <span class="hljs-comment">// 第一天计算需要结合前14天的数据</span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length === <span class="hljs-number">14</span>) &#123;<br>      <span class="hljs-keyword">const</span> &#123; rise, fall &#125; = DATA_SOURCE.reduce(<span class="hljs-function">(<span class="hljs-params">acc, cur</span>) =&gt;</span> &#123;<br>        acc.rise += (cur.rise || <span class="hljs-number">0</span>)<br>        acc.fall += (cur.fall || <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">return</span> acc <br>      &#125;, &#123;<br>        <span class="hljs-attr">rise</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-attr">fall</span>: <span class="hljs-number">0</span><br>      &#125;)<br>      newData.riseAverage = rise / <span class="hljs-number">14</span> <br>      newData.fallAverage = fall / <span class="hljs-number">14</span> <br>      newData.RS = newData.riseAverage / newData.fallAverage<br>      newData.RSI = <span class="hljs-number">100</span> - (<span class="hljs-number">100</span> / (<span class="hljs-number">1</span> + newData.RS))<br>    &#125;<br>    <span class="hljs-comment">// 后面只需要前一天的数据即可</span><br>    <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">const</span> [ yestodayData ] = DATA_SOURCE.slice(-<span class="hljs-number">1</span>)<br>      <span class="hljs-comment">// 上涨</span><br>      <span class="hljs-keyword">if</span>(newData.close &gt; yestodayData.close) &#123;<br>        newData.rise = newData.close - yestodayData.close<br>      &#125;<br>      <span class="hljs-comment">// 下跌</span><br>      <span class="hljs-keyword">else</span> &#123;<br>        newData.fall = yestodayData.close - newData.close<br>      &#125;<br>      newData.riseAverage = (yestodayData.riseAverage * <span class="hljs-number">13</span> + (yestodayData.rise || <span class="hljs-number">0</span>)) / <span class="hljs-number">14</span> <br>      newData.fallAverage = (yestodayData.fallAverage * <span class="hljs-number">13</span> + (yestodayData.fall || <span class="hljs-number">0</span>)) / <span class="hljs-number">14</span> <br>      newData.RSI = <span class="hljs-number">100</span> - (<span class="hljs-number">100</span> / (<span class="hljs-number">1</span> + newData.RS))<br>    &#125;<br><br>    <span class="hljs-comment">// TODO </span><br>    <span class="hljs-comment">// 具体的判断交易逻辑</span><br><br>  &#125;<br><br>  DATA_SOURCE.push(newData)<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>存在问题</p>
</blockquote>
<ol>
<li>文中所说的各种图表形态，如<strong>头肩顶|底</strong>，<strong>旗形</strong>，只是简单的使用<strong>图例标识</strong>何时买入卖出，并没有真正解释计算的方法，暂时还无法完善整个交易流程。</li>
</ol>
  <img src="/images/技术交易系统新概念笔记/相对强弱指数-RSI顶部.jpg" srcset="/img/loading.gif" lazyload />  
  <img src="/images/技术交易系统新概念笔记/相对强弱指数-RSI底部.png" srcset="/img/loading.gif" lazyload />  
<h3 id="摆动指数-短线交易系统">摆动指数-短线交易系统</h3>
<p>顾名思义是做短期交易或高频交易的，个人认为对于短线交易来说，需要关注到更多的细节，毕竟在短时间内做多次交易，需要付出更多的手续费。</p>
<h4 id="几个概念-3">几个概念</h4>
<ul>
<li>
<p>Cn、Ln、Hn、On<br>
第n天的收盘价、最低价、最高价、开盘价</p>
</li>
<li>
<p>SI<br>
摆动因子<br>
<img src="/images/技术交易系统新概念笔记/摆动指数-短线交易系统-SI.jpg" srcset="/img/loading.gif" lazyload /><br>
<strong>L</strong>表示极限运动值常量（比如3）</p>
<p><strong>K</strong>表示下列两数值的最大值（<strong>绝对值最大</strong>）</p>
<ul>
<li><code>H2 - C1</code></li>
<li><code>L2 - C1</code></li>
</ul>
<p><strong>R</strong>为以下条件之一</p>
<ol>
<li>求出下列三个条件中的最大值（<strong>绝对值最大</strong>）<br>
1. <code>H2 - C1</code><br>
2. <code>L2 - C1</code><br>
3. <code>H2 - L2</code></li>
<li>根据上面的最大值来定义<strong>R</strong><br>
1. <code>R = (H2 - C1) - 0.5 * (L2 - C1) + 0.25 * (C1 - O1)</code><br>
2. <code>R = (L2 - C1) - 0.5 * (H2 - C1) + 0.25 * (C1 - O1)</code><br>
3. <code>R = (H2 - L2) + 0.25 * (C1 - O1)</code></li>
</ol>
</li>
<li>
<p>ASI<br>
累计摆动指标<br>
<code>ASI = 今日SI + 前一日ASI</code><br>
它可以是正数也可以是负数<br>
长期上升可能是正数，下降可能是负数，摆动可能是正负交替</p>
</li>
<li>
<p>HSP<br>
高位摆动点<br>
是由ASI定义的交易日，该交易日的ASI值<strong>高于</strong>相邻的前后两个交易日的ASI值。</p>
</li>
<li>
<p>LSP<br>
低位摆动点<br>
是由ASI定义的交易日，该交易日的ASI值<strong>低于</strong>相邻的前后两个交易日的ASI值。</p>
</li>
</ul>
<h4 id="规则-2">规则</h4>
<ul>
<li>初入市<br>
ASI超过前一个高位摆动点的ASI，次日建立多头<br>
ASI跌破前一个低位摆动点的ASI，次日建立空头</li>
<li>指标停损反转点
<ul>
<li>多头
<ol>
<li>SAR = 前一个LSP</li>
<li>新的HSP形成后，SAR = 下一个LSP</li>
</ol>
</li>
<li>空头
<ol>
<li>SAR = 前一个HSP</li>
<li>新的LSP形成后，SAR = 下一个HSP</li>
</ol>
</li>
</ul>
</li>
<li>指标尾随停损点
<ul>
<li>多头<br>
最高HSP与(ASI - 60)之间的交易日的收盘价中的最低价</li>
<li>空头<br>
最低LSP与(ASI + 60)之间的交易日的收盘价中的最高价</li>
</ul>
</li>
</ul>
<h4 id="js实现-4">js实现</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  &#123;</span><br><span class="hljs-comment">    // 日期</span><br><span class="hljs-comment">    date: &#x27;2022-02-25&#x27;,</span><br><span class="hljs-comment">    // 开盘价</span><br><span class="hljs-comment">    open: 100,</span><br><span class="hljs-comment">    // 最高价</span><br><span class="hljs-comment">    high: 100,</span><br><span class="hljs-comment">    // 最低价</span><br><span class="hljs-comment">    low: 100,</span><br><span class="hljs-comment">    // 收盘价</span><br><span class="hljs-comment">    close: 100,</span><br><span class="hljs-comment">    // 手续费</span><br><span class="hljs-comment">    charge: 20,</span><br><span class="hljs-comment">    // 摆动因子</span><br><span class="hljs-comment">    SI: 20,</span><br><span class="hljs-comment">    // 累计摆动指标</span><br><span class="hljs-comment">    ASI: 20,</span><br><span class="hljs-comment">  &#125;</span><br><span class="hljs-comment">*/</span><br><span class="hljs-keyword">const</span> DATA_SOURCE = []<br><span class="hljs-comment">// 当前的交易信息</span><br><span class="hljs-keyword">const</span> TRADE_INFO = &#123;<br>  <span class="hljs-comment">// -1 初始化 0 空头 1 多头</span><br>  <span class="hljs-attr">status</span>: -<span class="hljs-number">1</span>,<br>&#125;<br><span class="hljs-comment">// 极限运动值常量</span><br><span class="hljs-keyword">const</span> L = <span class="hljs-number">3</span> <br><span class="hljs-comment">// 最近一次的HSP  </span><br><span class="hljs-keyword">let</span> CURRENT_HSP = <span class="hljs-number">0</span> <br><span class="hljs-comment">// 最近一次的LSP  </span><br><span class="hljs-keyword">let</span> CURRENT_LSP = <span class="hljs-number">0</span> <br><span class="hljs-comment">// 最近一次的HIP </span><br><span class="hljs-keyword">let</span> CURRENT_HIP = <span class="hljs-number">0</span> <br><span class="hljs-comment">// 最近一次的LOP  </span><br><span class="hljs-keyword">let</span> CURRENT_LOP = <span class="hljs-number">0</span> <br><span class="hljs-comment">// 需要进入的状态</span><br><span class="hljs-comment">// 因为在检测到需要转变状态时，需要等待价格到达目标价位才能进入或退出市场，所以在这里记录一下状态</span><br><span class="hljs-comment">// -1 等待 0 空头 1 多头</span><br><span class="hljs-keyword">let</span> NEXT_NEED_STEP = -<span class="hljs-number">1</span> <br><span class="hljs-comment">// 停损点</span><br><span class="hljs-keyword">let</span> SAR = <span class="hljs-number">0</span> <br><br><span class="hljs-comment">// 获取指定时间间隔的历史数据</span><br><span class="hljs-comment">// mock </span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getHistoryData</span>(<span class="hljs-params">start, end</span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()<br>  <span class="hljs-keyword">return</span> [&#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    <span class="hljs-attr">date</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;date.getFullYear()&#125;</span>-<span class="hljs-subst">$&#123;date.getMonth() + <span class="hljs-number">1</span>&#125;</span>-<span class="hljs-subst">$&#123;date.getDate()&#125;</span>`</span>,<br>    charge,<br>    <span class="hljs-comment">// 当前价格</span><br>    current,<br>  &#125;]<br>&#125;<br><br><span class="hljs-comment">// 实时监听当前的市场价格</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestDailyInfoLoop</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> currentData = getHistoryData() <br>    <span class="hljs-keyword">const</span> &#123; current &#125; = currentData<br>    <span class="hljs-comment">// 需要进行操作</span><br>    <span class="hljs-keyword">if</span>(!!~NEXT_NEED_STEP) &#123;<br>      <span class="hljs-comment">// 需要进入空头</span><br>      <span class="hljs-keyword">if</span>(NEXT_NEED_STEP === <span class="hljs-number">0</span> &amp;&amp; current &lt; CURRENT_LOP) &#123;<br>        <span class="hljs-comment">// 操作进入空头</span><br>        TRADE_INFO.status = <span class="hljs-number">0</span><br>        SAR = CURRENT_HIP<br>      &#125;<br>      <span class="hljs-comment">// 需要进入多头</span><br>      <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(NEXT_NEED_STEP === <span class="hljs-number">1</span> &amp;&amp; current &gt; CURRENT_HIP) &#123;<br>        TRADE_INFO.status = <span class="hljs-number">1</span><br>        SAR = CURRENT_LOP<br>      &#125;<br>      NEXT_NEED_STEP = -<span class="hljs-number">1</span> <br>    &#125;<br><br>    requestDailyInfoLoop()<br>  &#125;, <span class="hljs-number">1000</span>)<br>&#125;<br><br>  <span class="hljs-comment">// 定时任务执行</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dailyFunction</span>(<span class="hljs-params"></span>) </span>&#123;<br><br>  <span class="hljs-keyword">const</span> currentData = getHistoryData() <br>  <span class="hljs-keyword">const</span> &#123;<br>    high,<br>    open,<br>    low,<br>    close,<br>    date,<br>    charge<br>  &#125; = currentData <br>  <span class="hljs-keyword">const</span> newData = &#123;<br>    date,<br>    high,<br>    open,<br>    close,<br>    low,<br>    charge<br>  &#125; <br><br>  <span class="hljs-comment">// 超过一天才能计算SI</span><br>  <span class="hljs-keyword">if</span>(!!DATA_SOURCE.length) &#123;<br>    <span class="hljs-keyword">const</span> [yestoday] = DATA_SOURCE.slice(-<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">close</span>: yesClose, <span class="hljs-attr">open</span>: yesOpen, <span class="hljs-attr">low</span>: yesLow, <span class="hljs-attr">high</span>: yesHigh, <span class="hljs-attr">SI</span>: yesSI, <span class="hljs-attr">ASI</span>: yesASI &#125; = yestoday<br>    <span class="hljs-comment">// 分子</span><br>    <span class="hljs-keyword">const</span> N = close - yesClose + <span class="hljs-number">0.5</span> * (close - open) + <span class="hljs-number">0.25</span> * (yesClose - yesOpen)<br>    <span class="hljs-comment">// K </span><br>    <span class="hljs-keyword">const</span> K = <span class="hljs-built_in">Math</span>.max(<span class="hljs-built_in">Math</span>.abs(high - yesClose), <span class="hljs-built_in">Math</span>.abs(low - yesClose))<br>    <span class="hljs-comment">// R </span><br>    <span class="hljs-keyword">const</span> RCondition = [<span class="hljs-built_in">Math</span>.abs(high, yesClose), <span class="hljs-built_in">Math</span>.abs(low - yesClose), <span class="hljs-built_in">Math</span>.abs(high - low)]<br>    <span class="hljs-keyword">const</span> maxRCondition = <span class="hljs-built_in">Math</span>.max(...RCondition)<br>    <span class="hljs-keyword">const</span> maxRConditionIndex = RCondition.indexOf(maxRCondition)<br>    <span class="hljs-keyword">const</span> RMap = [<br>      (high - yesClose) - <span class="hljs-number">0.5</span> * (low - yesClose) + <span class="hljs-number">0.25</span> * (yesClose - yesOpen),<br>      (low - yesClose) - <span class="hljs-number">0.5</span> * (high - yesClose) + <span class="hljs-number">0.25</span> * (yesClose - yesOpen),<br>      (high - low) + <span class="hljs-number">0.25</span> * (yesClose - yesOpen)<br>    ]<br>    <span class="hljs-keyword">const</span> R = RMap[maxRConditionIndex]<br>    <span class="hljs-comment">// SI </span><br>    <span class="hljs-keyword">const</span> SI = <span class="hljs-number">50</span> * (N / R) * (K / L)<br>    newData.SI = SI <br>    newData.ASI = SI + (yesASI || <span class="hljs-number">0</span>)<br><br>    <span class="hljs-comment">// 超过两天才能计算HIP和LOP</span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">2</span>) &#123;<br>      <span class="hljs-comment">// HIP  </span><br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Math</span>.max(theDayBeforeYestoday.high, yestoday.high, newData.high) === yestoday.high) &#123;<br>        CURRENT_HIP = yestoday.high <br>      &#125;<br><br>      <span class="hljs-comment">// LOP </span><br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Math</span>.min(theDayBeforeYestoday.low, yestoday.low, newData.low) === yestoday.low) &#123;<br>        CURRENT_LOP = yestoday.low <br>      &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// 超过三天才能计算HSP和LSP  </span><br>    <span class="hljs-keyword">if</span>(DATA_SOURCE.length &gt;= <span class="hljs-number">3</span>) &#123;<br>      <span class="hljs-keyword">const</span> [ theDayBeforeYestoday, yestoday ] = DATA_SOURCE.slice(-<span class="hljs-number">2</span>)<br>      <span class="hljs-comment">// HSP</span><br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Math</span>.max(theDayBeforeYestoday.ASI, yestoday.ASI, newData.ASI) === yestoday.ASI) &#123;<br>        CURRENT_HSP = yestoday.ASI <br>        <span class="hljs-comment">// 多头</span><br>        NEXT_NEED_STEP = <span class="hljs-number">1</span><br>      &#125;<br>      <span class="hljs-comment">// LSP </span><br>      <span class="hljs-keyword">if</span>(<span class="hljs-built_in">Math</span>.min(theDayBeforeYestoday.ASI, yestoday.ASI, newData.ASI) === yestoday.ASI) &#123;<br>        CURRENT_LSP = yestoday.ASI <br>        <span class="hljs-comment">// 空头</span><br>        NEXT_NEED_STEP = <span class="hljs-number">0</span><br>      &#125;<br>    &#125;<br><br>  &#125;<br><br>  DATA_SOURCE.push(newData)<br><br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>存在问题</p>
</blockquote>
<ol>
<li>能力有限，这一章节的内容的代码实现未能全部完成😓。</li>
<li>总得来说，这是一个短线操作系统。</li>
</ol>
<h3 id="资金管理">资金管理</h3>
<p>相信在接受到交易的相关概念的洗礼后，对这一章节的重要性都应该有一定的理解了。<br>
这里就直接定义书中的结论。</p>
<blockquote>
<ol>
<li>任何一种期货，其保证金不要超过总资金数量的<strong>15%</strong></li>
<li>任何时候，保证金不要超过总资金数量的<strong>60%</strong>()</li>
</ol>
</blockquote>
<p>上述的保证金也可以说是投入的资金量</p>
<h2 id="结束">结束</h2>
<p>以上就是书中的所有内容，当然还有挺多可以完善的地方，上面的代码只是一个简单的<code>demo</code>，后续可以继续完善💪🏻。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E4%BA%A4%E6%98%93/">交易</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/trade-finance/">trade finance</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/12/12/2022%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2022年终总结</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/11/25/%E6%9C%9F%E8%B4%A7%E5%B8%82%E5%9C%BA%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90%E7%AC%94%E8%AE%B0/">
                        <span class="hidden-mobile">期货市场技术分析笔记</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> <script src="/js/code-viewer.js"></script> </div> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  











<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<!-- hexo injector body_end start -->
  <script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiantiao.js"></script>
  <script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxingxing.js"></script>
  <script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/dianjichuzi.js"></script>
<!-- hexo injector body_end end --><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":300,"mobile":{"show":true}},"log":false});</script></body>
</html>
